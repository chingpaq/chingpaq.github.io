"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[3389],{93389:(e,t,a)=>{a.d(t,{Ac:()=>k,HP:()=>I,QK:()=>Z,QN:()=>f,T5:()=>P,gQ:()=>w,hI:()=>R,vo:()=>_,yx:()=>E,zJ:()=>x});var s=a(1413),n=a(56031),d=a(88502),o=a.n(d),l=a(62169),i=a(98032),r=a(95256),c=a(11577),u=a(88374),p=a(88827),v=a(30994),h=a(96332),g=(a(50981),a(1542)),m=a(49465),y=a(75105),S=a(34665),b=a(71982);const f=(e,t,a)=>{const{sessionSettings:{last_access_token:n}}=p.h.getState().authReducer,d=new FormData;d.append("name",e),(null===t||void 0===t?void 0:t.length)>0&&d.append("description",t),d.append("type",a);const o=(0,s.Z)({},v.ns.processes.createNewProcess(n)),c=(0,s.Z)((0,s.Z)({},o),{},{data:d,handlerEnabled:!0,forwardAllErrors:!0}),{companyProcesses:g}=p.h.getState().flowReducer;return new r.y(e=>(0,h.b)(c).then(t=>{var a;if(null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.data){var n;const a=g.length>0?l.Z(i.Z("name"),[...g,t.data.data]):[];p.h.dispatch((0,u.an)(a,1)),p.h.dispatch((0,u.Xu)((0,s.Z)((0,s.Z)({},null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.data),{},{registered:!0}))),p.h.dispatch((0,u.Xc)({show:!0,message:"You have successfully created new process"})),e.next(t.data.data),e.complete()}}).catch(t=>{e.error(t)}))},w=(e,t,a,n)=>{const{sessionSettings:{last_access_token:d}}=p.h.getState().authReducer;let l=o().stringify({name:t,description:a,type:n});const i=(0,s.Z)({},v.ns.processes.updateProcessById(d,e)),c=(0,s.Z)((0,s.Z)({},i),{},{headers:(0,s.Z)({},i.headers),data:l,handlerEnabled:!0}),{companyProcesses:g}=p.h.getState().flowReducer;return new r.y(a=>(0,h.b)(c).then(n=>{var d,o,l;200==(null===n||void 0===n?void 0:n.status)&&null!==n&&void 0!==n&&n.data&&null!==n&&void 0!==n&&null!==(d=n.data)&&void 0!==d&&d.data&&(p.h.dispatch((0,u.an)([...g.filter(t=>t.id!==e),null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.data],1)),p.h.dispatch((0,u.Xu)((0,s.Z)((0,s.Z)({},null===n||void 0===n||null===(l=n.data)||void 0===l?void 0:l.data),{},{registered:!0}))),p.h.dispatch((0,u.Xc)({show:!0,message:"You have successfully updated ".concat(t)})),a.next(n.data.data),a.complete())}).catch(e=>{a.error(e)}))},_=e=>{const{sessionSettings:{last_access_token:t}}=p.h.getState().authReducer,a=(0,s.Z)({},v.ns.processes.deleteProcessById(t,e)),n=(0,s.Z)((0,s.Z)({},a),{},{headers:(0,s.Z)({},a.headers)}),{companyProcesses:d}=p.h.getState().flowReducer;return new r.y(t=>(0,h.b)(n).then(a=>{200==(null===a||void 0===a?void 0:a.status)&&null!==a&&void 0!==a&&a.data&&(t.next(a.data),t.complete(),p.h.dispatch((0,u.an)(d.filter(t=>t.id!==e),1)),p.h.dispatch((0,u.Xc)({show:!0,message:"You have successfully deleted process",color:"red"})))}).catch(e=>{t.error(e)}))},Z=(e,t)=>{const{sessionSettings:{last_access_token:a}}=p.h.getState().authReducer;var n=JSON.stringify({positions:t});const d=(0,s.Z)((0,s.Z)({},v.ns.processes.shareProcessToSeveralPositions(a,e)),{},{data:n,handlerEnabled:!0,forwardAllErrors:!0});return new r.y(e=>(0,h.b)(d).then(t=>{200==(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data&&(e.next(t.data),e.complete())}).catch(t=>e.error(t)))},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{sessionSettings:{last_access_token:a}}=p.h.getState().authReducer,n=(0,s.Z)((0,s.Z)({},v.ns.processes.getProcessById(a,e,t)),{},{handlerEnabled:!0});return new r.y(e=>(0,h.b)(n).then(t=>{var a,s;200==(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.data&&(p.h.dispatch((0,u.dW)(null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.data)),e.next(t.data.data),e.complete())}).catch(t=>{e.error(t)}))},k=e=>{const{sessionSettings:{last_access_token:t}}=p.h.getState().authReducer;let a=JSON.stringify(e);const n=(0,s.Z)((0,s.Z)({},v.ns.processSteps.createNewProcStepUsingRawJson(t)),{},{handlerEnabled:!0,data:a});return new r.y(e=>(0,h.b)(n).then(t=>{var a,s;(null===(a=[200,201])||void 0===a?void 0:a.indexOf(null===t||void 0===t?void 0:t.status))>-1&&null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.data&&(e.next(t.data.data),e.complete())}).catch(t=>{e.error(t)}))},P=(e,t,a)=>{const{sessionSettings:{last_access_token:n}}=p.h.getState().authReducer,d=JSON.stringify(e),o=(0,s.Z)((0,s.Z)({},v.ns.processSteps.updateProcessStepByIdUsingJson(n,t.concat(a?"?all=1":""))),{},{handlerEnabled:!0,data:d});return new r.y(e=>(0,h.b)(o).then(t=>{var a,s;(null===(a=[200,201])||void 0===a?void 0:a.indexOf(null===t||void 0===t?void 0:t.status))>-1&&null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.data&&(e.next(t.data.data),e.complete(),p.h.dispatch((0,u.Xc)({show:!0,message:"You have successfully updated a step"})))}).catch(t=>{e.error(t)}))},R=e=>{const{sessionSettings:{last_access_token:t}}=p.h.getState().authReducer,{processId:a,forStepId:d,pathways:o,parentsOnly:l,details:i}=e,c=n.stringify({pathways:o,forStepId:d,parentsOnly:l,details:i},{skipNull:!0}),u=(0,s.Z)((0,s.Z)({},v.ns.processSteps.getStepsByProcessId(t,a+((null===c||void 0===c?void 0:c.length)>0?"?"+c:""))),{},{handlerEnabled:!0});return new r.y(e=>(0,h.b)(u).then(t=>{var a;200==(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data&&(null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.data?(e.next(t.data.data),e.complete()):(e.next(t.data),e.complete()))}).catch(t=>{e.error(t)}))},I=e=>{const{sessionSettings:{last_access_token:t}}=p.h.getState().authReducer,a=(0,s.Z)((0,s.Z)({},v.ns.processSteps.deleteStepById(t,e)),{},{handlerEnabled:!0}),{companyProcesses:n}=p.h.getState().flowReducer;return new r.y(e=>(0,h.b)(a).then(t=>{var a;200==(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.message&&(e.next(t.data.message),e.complete())}).catch(t=>{e.error(t)}))},E=e=>{const{companyProcesses:t}=p.h.getState().flowReducer,{onBoardingModalsVisibility:a,onBoardingCompleted:n}=p.h.getState().modalsReducer,{templatesSecond:d}=a;return new r.y(a=>f("".concat(e.name,"*"),e.description,null===e||void 0===e?void 0:e.type).pipe((0,c.P)()).subscribe({next:n=>{let o=[];e.steps.map((l,i)=>{var f,w,_;k({name:null===l||void 0===l?void 0:l.name,procedure_id:n.id,guidance:null===l||void 0===l?void 0:l.guidance,rank:null===l||void 0===l?void 0:l.rank,options:null===l||void 0===l?void 0:l.options,is_start:null!==(f=null===l||void 0===l?void 0:l.is_start)&&void 0!==f&&f,is_end:null!==(w=null===l||void 0===l?void 0:l.is_end)&&void 0!==w&&w,component_blueprints:null===l||void 0===l||null===(_=l.component_blueprints)||void 0===_?void 0:_.map(e=>{var t;return(0,s.Z)((0,s.Z)({},e),{},{selected_fields:null===e||void 0===e||null===(t=e.selected_fields)||void 0===t?void 0:t.map(e=>({id:e.id,mandatory:e.mandatory,visible:e.visible,index:e.index}))})})}).pipe((0,c.P)()).subscribe({next:l=>{o.push(l),e.steps.length==i+1&&(0,g.nB)("".concat(e.name,"*"),n.id,{outputTo:"component"}).subscribe({next:l=>{e.steps.map((l,i)=>{var g,f;(null===l||void 0===l||null===(g=l.parent_steps)||void 0===g?void 0:g.length)>0||(null===l||void 0===l||null===(f=l.pathway_steps)||void 0===f?void 0:f.length)>0?((e,t)=>{const{sessionSettings:{last_access_token:a}}=p.h.getState().authReducer;let n=JSON.stringify(e);const d=(0,s.Z)((0,s.Z)({},v.ns.processSteps.updateProcessStepByIdUsingJson(a,t)),{},{handlerEnabled:!0,data:n});return new r.y(e=>(0,h.b)(d).then(t=>{var a,s;(null===(a=[200,201])||void 0===a?void 0:a.indexOf(null===t||void 0===t?void 0:t.status))>-1&&null!==t&&void 0!==t&&t.data&&null!==t&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.data&&(e.next(t.data.data),e.complete(),p.h.dispatch((0,u.Xc)({show:!0,message:"You have successfully updated a step"})))}).catch(t=>{e.error(t)}))})({parent_steps:null===l||void 0===l?void 0:l.parent_steps.map(e=>o.find(t=>t.name===e.name&&t.rank===e.rank).id),pathway_steps:null===l||void 0===l?void 0:l.pathway_steps.map(e=>o.find(t=>t.name===e.name&&t.rank===e.rank).id)},o.find(e=>e.name===l.name&&e.rank===l.rank).id).pipe((0,c.P)()).subscribe({next:()=>{e.steps.length==i+1&&(p.h.dispatch((0,u.an)(t.filter(e=>e.id!==n.id),m.KI)),(0,y.IC)().pipe((0,c.P)()).subscribe({next:e=>{d&&p.h.dispatch((0,b.$6)({templatesLastVisible:!0})),S.Fc.saveUser((0,s.Z)({},e)),a.next(n)}}))}}):e.steps.length==i+1&&a.next(n)})},error:e=>{e&&a.error(e)}})},error:e=>a.error(e)})})},error:e=>a.error(e)}))}}}]);
//# sourceMappingURL=3389.c4707d35.chunk.js.map