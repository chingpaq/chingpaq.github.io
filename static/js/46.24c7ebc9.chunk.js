"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[46],{52046:function(e,n,t){t.r(n),t.d(n,{default:function(){return T}});var o=t(87462),i=t(1413),l=t(70885),r=t(67861),s="BeginModule_headerContainer__6l-gP",d="BeginModule_modalLabelHeader__EVne0",u="BeginModule_modalLabel__WZVSY",a="BeginModule_modalButtons__bAjdy",c="BeginModule_importArea__2hmJ7",p="BeginModule_importText__YhRY+",v=t(39518),f=t(10103),m=t(11577),h=t(65019),g=t(88550),y=t(93389);var E=function(e,n){void 0===e&&(e=!0);var t=(0,r.useCallback)((function(t){if("function"!==typeof e||e())return t.preventDefault(),n&&(t.returnValue=n),n}),[e,n]);(0,r.useEffect)((function(){if(e)return function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e&&e.addEventListener&&e.addEventListener.apply(e,n)}(window,"beforeunload",t),function(){return function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e&&e.removeEventListener&&e.removeEventListener.apply(e,n)}(window,"beforeunload",t)}}),[e,t])},b=t(88827),w=t(88374),_=t(64509),x=t(20086),M=t(73500),S=t(1542),C=t(6073),k=t(43984),Z=t(75105),U=t(34665),I=t(23280),P=t(92957),O="SET_SELECTED_COMPONENT",A=(0,P.Z)((function(e,n){var t=n.action,o=n.value;return t===O?(0,i.Z)((0,i.Z)({},e),{},{selectedComponent:o}):(0,i.Z)({},e)}),{selectedComponent:[]}),N=(0,l.Z)(A,2),q=(N[0],N[1]),L=t(29118),D=t(41771),T=(0,v.$j)((function(e){var n=e.flowReducer,t=n.begunModule,o=n.companyProcesses,i=n.cart;return{begunModule:t,user:e.sessionReducer.user,companyProcesses:o,cart:i}}),(function(e){return{onSetAuthenticatedUser:function(n){return e((0,k.IF)(n))}}}))((function(e){var n,t,v,k,P,O,A,N,T,z,B,R,F,V,Y,j,J,W,Q,H=e.begunModule,X=e.user,$=e.companyProcesses,G=e.cart,K=(0,r.useState)(""),ee=(0,l.Z)(K,2),ne=ee[0],te=ee[1],oe=(0,r.useState)(!1),ie=(0,l.Z)(oe,2),le=ie[0],re=ie[1],se=(0,r.useState)(!1),de=(0,l.Z)(se,2),ue=de[0],ae=de[1],ce=(0,g.pQ)(),pe=(0,l.Z)(ce,2),ve=pe[0],fe=pe[1],me=(0,r.useState)(!1),he=(0,l.Z)(me,2),ge=he[0],ye=he[1],Ee=(0,r.useState)(!1),be=(0,l.Z)(Ee,2),we=be[0],_e=be[1],xe=(0,I.UO)().moduleID,Me=(0,r.useCallback)((function(e){e.forEach((function(e){var n;if(-1!==["xls","xlsx","csv"].indexOf(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.toString().split(".")[1])){var t=new FileReader;t.onabort=function(){},t.onerror=function(){},t.onload=function(e){},t.readAsBinaryString(e),t.onloadend=function(n){var t,o;_e(!0),(0,S._)(e,null===H||void 0===H||null===(t=H.processModule)||void 0===t||null===(o=t.module)||void 0===o?void 0:o.id).subscribe({next:function(){_e(!1),(0,C.OQ)(!1,!0).pipe((0,f.q)(1)).subscribe({})},complete:function(){_e(!1)},error:function(e){_e(!1)}})}}}))}),[null===H||void 0===H||null===(n=H.processModule)||void 0===n?void 0:n.module]),Se=(0,L.uI)({onDrop:Me}),Ce=Se.getRootProps,ke=Se.getInputProps,Ze=Se.isDragActive,Ue=(0,I.s0)();(0,r.useEffect)((function(){var e,n,t;if(void 0===(null===H||void 0===H||null===(e=H.processModule)||void 0===e?void 0:e.isUpdating)){var o=$.find((function(e){return e.id===H.processModule.id}));if(o&&o.steps.length>0){var l,r=(0,i.Z)((0,i.Z)((0,i.Z)({},H.processModule),o),{},{steps:o.steps.filter((function(e){var n,t,o,i,l;return void 0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.showStepAll)||1==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.showStepAll)||0==(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.showStepAll)&&(null===e||void 0===e||null===(i=e.options)||void 0===i||null===(l=i.showOnly)||void 0===l?void 0:l.filter((function(e){return X.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0})).map((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},{rank:n+1})}))});b.h.dispatch((0,w.q4)(r)),fe({action:g._U.setCurrentStep,value:r.steps[null!==(l=H.processModule.stepIndex)&&void 0!==l?l:0]})}else(0,y.zJ)(H.processModule.id).pipe((0,m.P)()).subscribe({next:function(e){var n,t=(0,i.Z)((0,i.Z)((0,i.Z)({},H.processModule),e),{},{steps:e.steps.filter((function(e){var n,t,o,i,l;return void 0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.showStepAll)||1==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.showStepAll)||0==(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.showStepAll)&&(null===e||void 0===e||null===(i=e.options)||void 0===i||null===(l=i.showOnly)||void 0===l?void 0:l.filter((function(e){return X.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0}))});b.h.dispatch((0,w.q4)(t)),fe({action:g._U.setCurrentStep,value:t.steps[null!==(n=H.processModule.stepIndex)&&void 0!==n?n:0]})},error:function(e){}})}else if(!0===(null===H||void 0===H||null===(n=H.processModule)||void 0===n?void 0:n.isUpdating)){var s;fe({action:g._U.setCurrentStep,value:H.processModule.steps[null!==(s=H.processModule.stepIndex)&&void 0!==s?s:0]})}if(b.h.dispatch((0,w.Xc)({show:!0,message:"Fetching all shared ".concat(null===(t=H.processModule.module)||void 0===t?void 0:t.name," data..."),color:"var(--app-color-gray-light)",spinner:!0,bottom:!0})),(0,C.OQ)(!0,!0).pipe((0,f.q)(1)).subscribe({complete:function(){return b.h.dispatch((0,w.Xc)({show:!1,message:""}))}}),xe){var d,u=new URLSearchParams(null===(d=location)||void 0===d?void 0:d.search);te({key:u.get("key"),value:u.get("value")})}}),[]);return E(!0,"Are you sure want to leave this "),r.createElement(h.LN,null,r.createElement(q,null,r.createElement("div",{className:s},r.createElement("div",null),!M.tq&&(null===ve||void 0===ve||null===(t=ve.currentStep)||void 0===t?void 0:t.rank)>1&&(null===(v=H.processModule.steps)||void 0===v?void 0:v.length)>0&&r.createElement("p",{className:d,style:{padding:"15px 10px 10px 10px"}},"Step ".concat(null!==(k=(null===ve||void 0===ve||null===(P=ve.currentStep)||void 0===P?void 0:P.rank)-1)&&void 0!==k?k:0," of ").concat(null!==(O=(null===(A=H.processModule.steps)||void 0===A||null===(N=A.find((function(e){return 1==e.is_end})))||void 0===N?void 0:N.rank)-1)&&void 0!==O?O:H.processModule.steps.length-1)),r.createElement("div",{style:{display:"flex",minWidth:"80px"}},r.createElement(x.j3,{permissions:[x.po.blueprints.process.create]},!0===(null===H||void 0===H||null===(T=H.processModule)||void 0===T||null===(z=T.module)||void 0===z||null===(B=z.options)||void 0===B?void 0:B.allowImport)&&1==(null===ve||void 0===ve||null===(R=ve.currentStep)||void 0===R?void 0:R.rank)&&r.createElement(x.zx,{title:ge?"Hide":"Import",style:{marginLeft:"0px",width:"80px"},clicked:function(){return ye(!ge)}})),r.createElement(x.zx,{title:(null===X||void 0===X||null===(F=X.pinned_modules)||void 0===F?void 0:F.filter((function(e){return e.id===H.processModule.module_id})).length)>0?"Unpin":"Pin",loading:ue,style:{marginLeft:"0px",width:"80px",display:(null===ve||void 0===ve||null===(V=ve.currentStep)||void 0===V?void 0:V.rank)>1?"none":""},clicked:function(){var e;ae(!0),(null===X||void 0===X||null===(e=X.pinned_modules)||void 0===e?void 0:e.filter((function(e){return e.id===H.processModule.module_id})).length)>0?(0,S.Ev)(H.processModule.module_id).pipe((0,m.P)()).subscribe({next:function(){(0,Z.IC)().pipe((0,m.P)()).subscribe({next:function(e){U.Fc.saveUser((0,i.Z)({},e)),ae(!1)}})}}):(0,S.tq)(H.processModule.module_id).pipe((0,m.P)()).subscribe({next:function(){(0,Z.IC)().pipe((0,m.P)()).subscribe({next:function(e){U.Fc.saveUser((0,i.Z)({},e)),ae(!1),b.h.dispatch((0,w.IW)(!0)),Ue("/dashboard")}})}})}}),r.createElement(x.zx,{title:"Close",style:{marginLeft:"5px",width:"80px",display:(null===ve||void 0===ve||null===(Y=ve.currentStep)||void 0===Y?void 0:Y.rank)>1?"none":""},clicked:function(){var e,n,t;(setTimeout((function(){b.h.dispatch((0,w.IW)(!0))}),10),(null===ve||void 0===ve||null===(e=ve.items)||void 0===e?void 0:e.length)>0)?!0!==(null===(n=H.processModule.module)||void 0===n||null===(t=n.options)||void 0===t?void 0:t.saveCart)||!1!==H.processModule.isUpdating&&void 0!==H.processModule.isUpdating?(Ue("/dashboard"),b.h.dispatch((0,w.q4)(""))):re(!0):(Ue("/dashboard"),b.h.dispatch((0,w.q4)("")))}}))),ge&&r.createElement("div",{className:c},r.createElement("div",Ce(),r.createElement("input",(0,o.Z)({},ke(),{style:{display:"none",alignContent:"center",outline:"none"}})),Ze?r.createElement("div",{className:p},r.createElement("img",{alt:"",src:D.P8c}),r.createElement("p",null,"Drop the files here ...")):r.createElement("div",{className:p},!we&&r.createElement("img",{alt:"",src:D.P8c}),r.createElement("p",null,we?r.createElement(x.$j,{size:80,type:"ThreeDots"}):"Click or drag your file here to begin import. (ex .csv)")))),r.createElement(_.Z,{navigateTo:ne,isEditing:!1}),r.createElement(x.U7,{id:"pending-component-modal",blured:!0,scrollable:!1,isOpen:le,shadowedContainerStyle:{width:M.tq?"100%":"30%"}},r.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.createElement("p",{className:d},"Are you working on a transaction?"),r.createElement("div",{className:u},"You can press ".concat((null===G||void 0===G||null===(j=G.items)||void 0===j?void 0:j.length)>0?"'Update Cart'":"'Add to Cart'"," to save any transaction you are working on without submitting it. You can resume it by clicking the cart icon on the menu bar. ").concat((null===G||void 0===G||null===(J=G.items)||void 0===J?void 0:J.length)>0?"Pressing 'Empty Cart' will clear previous contents of your cart, and exit":"")),r.createElement("div",{className:a},r.createElement(x.zx,{title:"Close only",style:{width:"120px"},clicked:function(){fe({action:g._U.clearOngoingTransaction}),window.history.back(),b.h.dispatch((0,w.q4)(""))}}),r.createElement(x.zx,{title:(null===G||void 0===G||null===(W=G.items)||void 0===W?void 0:W.length)>0?"Update Cart":"Add to Cart",light:!0,style:{width:"130px"},clicked:function(){var e,n,t,o;ve.components.filter((function(e){return e.selected_fields.filter((function(e){return"ID"===e.data_type_name})).forEach((function(e){return e.value=void 0}))})),ve.newStepComponents.filter((function(e){return e.selected_fields.filter((function(e){return"ID"===e.data_type_name})).forEach((function(e){return e.value=void 0}))})),(null===H||void 0===H||null===(e=H.processModule)||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.length)>0&&(null===H||void 0===H||null===(t=H.processModule)||void 0===t||null===(o=t.steps)||void 0===o||o.filter((function(e){var n;return null===e||void 0===e||null===(n=e.component_blueprints)||void 0===n?void 0:n.filter((function(e){return e.selected_fields.filter((function(e){return"ID"===e.data_type_name})).filter((function(e){return e.value=void 0}))}))})));var l=JSON.parse(JSON.stringify({components:ve.components,newStepComponents:ve.newStepComponents,items:ve.items,begunModule:(0,i.Z)((0,i.Z)({},H.processModule),{},{stepIndex:1})}));b.h.dispatch((0,w.RV)(l)),fe({action:g._U.clearOngoingTransaction}),window.history.back(),b.h.dispatch((0,w.q4)(""))}}),r.createElement(x.zx,{title:"Empty Cart",light:!0,style:{width:"120px",display:(null===G||void 0===G||null===(Q=G.items)||void 0===Q?void 0:Q.length)>0?"":"none"},clicked:function(){b.h.dispatch((0,w.RV)({})),fe({action:g._U.clearOngoingTransaction}),window.history.back(),b.h.dispatch((0,w.q4)(""))}}))))))}))}}]);
//# sourceMappingURL=46.24c7ebc9.chunk.js.map