"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[8179],{60761:function(e,t,n){n.d(t,{Z:function(){return B}});var l=n(1413),o=n(93433),a=n(4942),i=n(29439),s=n(67861),r=n(39518),d=n(11577),u=n(93389),c=n(88374),p="ProcessStepsChart_host__Ubvna",v="ProcessStepsChart_target__lLbWe",f="ProcessStepsChart_startContainer__1AZuF",m="ProcessStepsChart_placeholderContainer__HI-Ue",h="ProcessStepsChart_paragraph__D9Hr2",g="ProcessStepsChart_tree__uqAbd",Z="ProcessStepsChart_step__1kNXi",E=n(89293),_=n(29937),b=n(71265),w=n(10904),y=n(94099),S=n(9204),k=n(80121),A=n(28550),C=n(88846),N=n(62169),x=n(84634),P=n(30401),F=n(62498),O=n(19194),R=n(49893),D=(n(67122),function(e){var t,n;return s.createElement("aside",null,s.createElement("div",{className:"title"},null!==(t=null===e||void 0===e?void 0:e.title)&&void 0!==t?t:"Workflow"),s.createElement("div",{className:"subtitle"},null!==(n=null===e||void 0===e?void 0:e.subtitle)&&void 0!==n?n:"Hello world"),s.createElement("div",{className:"description"},"Drag box to the right pane to add a new step."),s.createElement("br",null),s.createElement("div",{className:"dndnode input",onDragStart:function(e){return function(e,t){e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.effectAllowed="move"}(e,"input")},draggable:!0},"New Step"),s.createElement("br",null),s.createElement("br",null),s.createElement("br",null),s.createElement("div",{className:"description"},"You can connect a step to another step by dragging the handles of the box bottom on top of the handle of the target step. A plus sign should appear. A saved step message will appear if the connection is allowed."),s.createElement("br",null),s.createElement("div",{className:"description"},"To rearrange the positions of the step in the layout, make sure to unlock the lower left lock button. Drag the step to your desired location."),s.createElement("br",null),s.createElement("div",{className:"description"},"To delete a connection, click the line(or its label), then press delete (or backspace for some keyboards) The line should disappear and a saved step message should appear."))}),T=n(12075),j=n(52902),W=n(67861),$=[],z=0,B=(0,r.$j)((function(e){var t=e.flowReducer;return{selectedProcess:t.selectedProcess,companyProcesses:t.companyProcesses,workflowTemplates:t.workflowTemplates}}),(function(e){return{onSetSelectedProStep:function(t){return e((0,c.Sc)(t))}}}))((function(e){var t=(0,b.Z)(),n=e.selectedProcess,r=e.onEditStep,c=e.companyProcesses,B=e.workflowTemplates,H=e.updateParent,I=void 0===H?function(){}:H,U=e.edit,X=void 0!==U&&U,q=e.updateStep,G=void 0===q?function(){}:q,L=(0,_._M)(),M=(0,i.Z)(L,2),V=M[0],Y=M[1],J=(0,s.useState)(!1),K=(0,i.Z)(J,2),Q=K[0],ee=K[1],te=(0,s.useState)(X),ne=(0,i.Z)(te,2),le=ne[0],oe=ne[1],ae=(0,s.useState)(!1),ie=(0,i.Z)(ae,1)[0],se=(0,s.useState)(!0),re=(0,i.Z)(se,1)[0],de=(0,s.useRef)(null),ue=(0,s.useState)(null),ce=(0,i.Z)(ue,2),pe=ce[0],ve=ce[1],fe=(0,s.useState)($),me=(0,i.Z)(fe,2),he=me[0],ge=me[1];(0,s.useEffect)((function(){var e,t,n,l=y.Z(null===V||void 0===V?void 0:V.steps.concat(0==(null===V||void 0===V||null===(e=V.steps)||void 0===e?void 0:e.length)||(null===V||void 0===V||null===(t=V.steps)||void 0===t?void 0:t.filter((function(e){return!0===e.is_end})).length)>0?[]:[{name:"",id:"New",new:!0,rank:0,parent_steps:[0==(null===V||void 0===V?void 0:V.steps.length)?[]:null===V||void 0===V?void 0:V.steps[(null===V||void 0===V||null===(n=V.steps)||void 0===n?void 0:n.length)-1]]}]).map((function(e){var t,n;return(0,a.Z)({},null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:"New",{label:""===e.name?"New Step":W.createElement("div",null,W.createElement("div",null,"".concat(e.is_start?"(Start)":""," ")),W.createElement("div",{style:{fontSize:"16px"}},"".concat(e.name)),W.createElement("div",null,"".concat(e.is_end?"(End)":""," "))),childrenOf:e.parent_steps.length>0?e.parent_steps[0].id:null,childOf:null!==(n=null===e||void 0===e?void 0:e.parent_steps)&&void 0!==n?n:[],step:e})})));ge([].concat((0,o.Z)(function(e){var t=[],n=Object.keys(e).length,l=window.innerHeight/(n+1),o=window.innerWidth/3,a=1;for(var i in e)if(Object.hasOwnProperty.call(e,i)){var s,r,d,u,c,p,v,f,m,h,g,Z,E,_,b=e[i],w={y:null!==(s=b.step)&&void 0!==s&&null!==(r=s.options)&&void 0!==r&&null!==(d=r.layout)&&void 0!==d&&d.y?null===(u=b.step)||void 0===u||null===(c=u.options)||void 0===c||null===(p=c.layout)||void 0===p?void 0:p.y:1==a?0:l*a-1,x:null!==(v=b.step)&&void 0!==v&&null!==(f=v.options)&&void 0!==f&&null!==(m=f.layout)&&void 0!==m&&m.x?null===(h=b.step)||void 0===h||null===(g=h.options)||void 0===g||null===(Z=g.layout)||void 0===Z?void 0:Z.x:(null===(E=b.step)||void 0===E||null===(_=E.parent_steps)||void 0===_?void 0:_.length)>1?o+400:o};a++,t.push({id:i,type:1==b.step.is_start?"output":1==b.step.is_end?"input":b.childOf?"default":"input",data:{label:b.label,step:b.step},position:w,sourcePosition:"top",targetPosition:"bottom"})}return t}(l)),(0,o.Z)(function(e){var t=[],n=function(n){if(Object.hasOwnProperty.call(e,n)){var l=e[n];l.childOf&&l.childOf.filter((function(e){t.push({id:"edge-".concat(n,"-").concat(e.id),source:n,target:e.id,type:"smoothstep",label:"".concat(e.name," \u2b95 ").concat(l.step.name)})}))}};for(var l in e)n(l);return t}(l))))}),[null===V||void 0===V?void 0:V.steps]);(0,s.useEffect)((function(){if(""!==n.name&&""!==n.id){var e,l=c.find((function(e){return e.id===n.id}));if(l||(l=B.find((function(e){return e.id===n.id}))),l&&(null===(e=l)||void 0===e?void 0:e.steps.length)>0){var o=C.Z(N.Z(x.Z("rank")),S.Z(P.Z(F.Z("component_blueprints"),S.Z((function(e){return A.Z("_uuid",(0,E.mR)(),e)})))))(l.steps);Y({type:_.Cb.setAllSteps,value:o})}else ee(!0),(0,u.zJ)(n.id).pipe((0,d.P)()).subscribe({next:function(e){var n;if((null===e||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.length)>0){var l=C.Z(N.Z(x.Z("rank")),S.Z(P.Z(F.Z("component_blueprints"),S.Z((function(e){return A.Z("_uuid",(0,E.mR)(),e)})))))(e.steps);Y({type:_.Cb.setAllSteps,value:l}),t()&&ee(!1)}else ee(!1)},error:function(e){t()&&ee(!1)}})}}),[n]);var Ze=function e(n){var o,a,i,s=n.step;return W.createElement(O.O,{label:W.createElement("div",{className:v,style:{display:""},onClick:function(){var e;Y({type:_.Cb.setSelectedStep,value:(0,l.Z)((0,l.Z)({},s),{},{parent_steps:S.Z(k.Z(["id","name","rank"]))(null!==(e=null===s||void 0===s?void 0:s.parent_steps)&&void 0!==e?e:[])})}),r()}},W.createElement("div",{className:f},W.createElement("div",{className:Z,"app-card-type":"start"},W.createElement("p",{className:h},null===s||void 0===s?void 0:s.name))))},(null===s||void 0===s?void 0:s.next_steps)&&(null===s||void 0===s||null===(o=s.next_steps)||void 0===o?void 0:o.map((function(t,n){return W.createElement(e,{key:n,step:null===V||void 0===V?void 0:V.steps.find((function(e){return e.id===t.id}))})}))),(null===s||void 0===s?void 0:s.pathway_steps)&&(null===s||void 0===s||null===(a=s.pathway_steps)||void 0===a?void 0:a.map((function(e,t){return W.createElement(O.O,{key:t,label:W.createElement("div",{className:g},e.name)})}))),(null===s||void 0===s?void 0:s.pathway_processes)&&(null===s||void 0===s||null===(i=s.pathway_processes)||void 0===i?void 0:i.map((function(e,n){return W.createElement(O.O,{key:n,label:W.createElement("div",{className:g,onClick:function(){ee(!0),(0,u.hI)({processId:e.id}).pipe((0,d.P)()).subscribe({next:function(e){var n=C.Z(N.Z(x.Z("rank")),S.Z(P.Z(F.Z("component_blueprints"),S.Z((function(e){return A.Z("_uuid",(0,E.mR)(),e)})))))(e);Y({type:_.Cb.setAllSteps,value:n}),t()&&ee(!1)},error:function(e){t()&&ee(!1)}})}},"Process: ".concat(e.name))})}))),!0===(null===s||void 0===s?void 0:s.is_end)&&0==(null===V||void 0===V?void 0:V.steps.filter((function(e){var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)})).length)&&W.createElement(O.O,{label:W.createElement("div",{className:g},"End Step")}))};return W.createElement("div",null,Q&&""!==n.name&&""!==n.id&&W.createElement("div",{className:m,style:{display:""}},W.createElement(w.$j,{size:80,type:"ThreeDots"})),le&&W.createElement("div",{className:"dndflow"},W.createElement(R.tV,null,W.createElement("div",{className:"reactflow-wrapper",ref:de},W.createElement(R.ZP,{elements:he,nodesDraggable:!1,onConnectStart:function(e,t){},onConnect:function(e){if(new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e.source)||new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e.target)){var t=V.steps.find((function(t){return t.id===e.target}));if(t&&1==t.is_end)return;I(e.source,e.target,!0),ge((function(t){return(0,R.Z_)(e,t)}))}},onElementsRemove:function(e){var t;if((null===e||void 0===e?void 0:e.length)>0)if(null!==(t=e[0])&&void 0!==t&&t.id.includes("edge"))new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e[0].source)&&new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e[0].target)&&I(e[0].source,e[0].target,!1);else{var n,o=e.find((function(e){return!e.id.includes("edge")}));if(o)Y({type:_.Cb.setSelectedStep,value:(0,l.Z)((0,l.Z)({},o.data.step),{},{parent_steps:S.Z(k.Z(["id","name","rank"]))(null!==(n=null===o||void 0===o?void 0:o.data.step.parent_steps)&&void 0!==n?n:[])})}),r()}ge((function(t){return(0,R.d0)(e,t)}))},onLoad:function(e){ve(e),setTimeout(e.fitView)},onDrop:function(e){e.preventDefault();var t=de.current.getBoundingClientRect(),l=e.dataTransfer.getData("application/reactflow"),o=pe.project({x:e.clientX-t.left,y:e.clientY-t.top}),a={id:"dndnode_".concat(z++),type:l,position:o,sourcePosition:"top",targetPosition:"bottom",data:{label:"New Step ".concat(l),step:{name:"",new:!0}}};Y({type:_.Cb.addNewStep,value:n.id}),ge((function(e){return e.concat(a)})),r()},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},paneMoveable:ie,panOnScroll:re,snapToGrid:!0,onNodeDragStop:function(e,t){var n,o,a;Y({type:_.Cb.setSelectedStep,value:(0,l.Z)((0,l.Z)({},t.step),{},{layout:null===t||void 0===t?void 0:t.position})}),G((0,l.Z)((0,l.Z)({},null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.step),{},{options:(0,l.Z)((0,l.Z)({},null===t||void 0===t||null===(o=t.data)||void 0===o||null===(a=o.step)||void 0===a?void 0:a.options),{},{layout:t.position})}))},onNodeDoubleClick:function(e,t){var o,a,i,s,d;1==(null===t||void 0===t||null===(o=t.data)||void 0===o||null===(a=o.step)||void 0===a?void 0:a.new)?Y({type:_.Cb.addNewStep,value:n.id}):Y({type:_.Cb.setSelectedStep,value:(0,l.Z)((0,l.Z)({},t.data.step),{},{parent_steps:S.Z(k.Z(["id","name","rank"]))(null!==(i=null===t||void 0===t||null===(s=t.data)||void 0===s||null===(d=s.step)||void 0===d?void 0:d.parent_steps)&&void 0!==i?i:[]),layout:null===t||void 0===t?void 0:t.position})});r()}},W.createElement(R.ZX,null),W.createElement(R.Aq,{variant:"lines"}))),W.createElement(D,{title:n.name,subtitle:n.description}))),W.createElement("div",{className:p,"app-is-preview":"false",style:{display:(null===V||void 0===V?void 0:V.steps.length)>0&&!le?"":"none"}},!Q&&(null===V||void 0===V?void 0:V.steps.length)>0&&W.createElement("div",null,W.createElement(O.m,{lineWidth:"2px",lineColor:"green",lineBorderRadius:"10px",label:W.createElement("div",{className:g,style:{fontSize:"26px",padding:"30px 10px",display:(null===V||void 0===V?void 0:V.steps.length)>0?"":"none",maxWidth:"50%"}},n.name,W.createElement("p",null,n.description))},(null===V||void 0===V?void 0:V.steps.length)>0&&W.createElement(Ze,{step:null===V||void 0===V?void 0:V.steps.find((function(e){return 1===e.rank}))})),W.createElement(O.m,{lineWidth:"0px",lineColor:"transparent"},(null===V||void 0===V?void 0:V.steps.length)>0&&(null===V||void 0===V?void 0:V.steps.filter((function(e){var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)})).length)>0&&W.createElement(Ze,{step:null===V||void 0===V?void 0:V.steps.find((function(e){var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)}))})))),(null===V||void 0===V?void 0:V.steps.length)>0>0&&r&&W.createElement("div",{style:{float:"right"}},W.createElement(w.zx,{icon:W.createElement(T.G,{style:{width:"20px",height:"20px"},icon:le?j.IE:j.Bkj}),light:!0,title:le?"Chart":"Builder",clicked:function(){oe(!le)}})))}))},66284:function(e,t,n){n.d(t,{Xp:function(){return v},ry:function(){return p}});var l=n(1413),o=n(88827),a=n(30994),i=n(96332),s=n(95256),r=(n(88502),n(88374)),d=n(50981),u=n.n(d),c=n(66918),p=function(e,t){var n=o.h.getState().authReducer.sessionSettings.last_access_token,r=new FormData;r.append("name",e),r.append("product_code",t);var d=(0,l.Z)((0,l.Z)({},a.ns.products.createNewProduct(n)),{},{data:r});return new s.y((function(e){return(0,i.b)(d).then((function(t){201===(null===t||void 0===t?void 0:t.status)&&null!==t&&void 0!==t&&t.data&&(e.next(null===t||void 0===t?void 0:t.data),e.complete())})).catch((function(t){e.error(t)}))}))},v=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o.h.getState().authReducer.sessionSettings.last_access_token,n=o.h.getState().flowReducer,p=n.lastUpdates,v=n.axiosAbort,f=(0,l.Z)((0,l.Z)({},a.ns.products.getAllProducts(t)),{},{handlerEnabled:!0,signal:v.signal});return new s.y((function(t){e||u()((0,d.now)()).diff(u()(p.products),"minutes")>10?(0,i.b)(f).then((function(e){var n,a;200==(null===e||void 0===e?void 0:e.status)&&null!==e&&void 0!==e&&e.data&&null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.data&&(o.h.dispatch((0,r.C2)((0,l.Z)((0,l.Z)({},p),{},{products:(0,d.now)()}))),o.h.dispatch((0,r.RU)(e.data.data.length>0?c.sortBy(c.prop("name"),e.data.data):[])),t.next(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.data),t.complete())})).catch((function(e){t.error(e)})):t.complete()}))}}}]);
//# sourceMappingURL=8179.4629ad05.chunk.js.map