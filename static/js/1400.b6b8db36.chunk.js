"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[1400],{32422:function(e,n,o){o.d(n,{rr:function(){return Qe},ZP:function(){return Ke}});var l=o(4942),t=o(1413),i=o(93433),d=o(29439),a=o(67861),u={processStepHost:"ModuleStep_processStepHost__fdU12",listContainer:"ModuleStep_listContainer__+T0XF",listContainerMob:"ModuleStep_listContainerMob__7T+-i",detailContainer:"ModuleStep_detailContainer__EFIwE",centeredCardMargin:"ModuleStep_centeredCardMargin__eYosE",centeredSpinner:"ModuleStep_centeredSpinner__sOFdo",emptyElementsSection:"ModuleStep_emptyElementsSection__ehjx-",stepCounter:"ModuleStep_stepCounter__mD22I",clockIcon:"ModuleStep_clockIcon__TY0er",stepTitle:"ModuleStep_stepTitle__f9SxJ",stepTitleSmaller:"ModuleStep_stepTitleSmaller__Ng9ym",stepGuidance:"ModuleStep_stepGuidance__aWqq0",stepGuidanceSmaller:"ModuleStep_stepGuidanceSmaller__IKIF+",inputContainer:"ModuleStep_inputContainer__s9qZ2",selectInput:"ModuleStep_selectInput__LcokN",multiselectWithSearch:"ModuleStep_multiselectWithSearch__qMOzq",smoMultiselectParent:"ModuleStep_smoMultiselectParent__Pweb-",selectMenuItem:"ModuleStep_selectMenuItem__i73KN",inputClassName:"ModuleStep_inputClassName__VI3pY",toggleMenuInputButton:"ModuleStep_toggleMenuInputButton__gcFHY",goToNextStep:"ModuleStep_goToNextStep__ePl+k",nextStepsContainer:"ModuleStep_nextStepsContainer__zcpA0",nextStepImageContainer:"ModuleStep_nextStepImageContainer__55MGd",nextStepWrapper:"ModuleStep_nextStepWrapper__ZtiNA",headerContainer:"ModuleStep_headerContainer__4kozo",content:"ModuleStep_content__ClnRX","react-grid-layout":"ModuleStep_react-grid-layout__21OCf",layoutJSON:"ModuleStep_layoutJSON__tFPI9",columns:"ModuleStep_columns__dPw3m","react-grid-item":"ModuleStep_react-grid-item__tFcr7","react-grid-placeholder":"ModuleStep_react-grid-placeholder__canbf",resizing:"ModuleStep_resizing__xUUDG",static:"ModuleStep_static__IPrAy",text:"ModuleStep_text__MzRSh",minMax:"ModuleStep_minMax__SkZxD",add:"ModuleStep_add__aOZYV","react-grid-dragHandleExample":"ModuleStep_react-grid-dragHandleExample__iEu5W",cssTransforms:"ModuleStep_cssTransforms__aN9IT","react-draggable-dragging":"ModuleStep_react-draggable-dragging__epzS0","react-resizable-handle":"ModuleStep_react-resizable-handle__XaFka",singleButton:"ModuleStep_singleButton__+BXaC",menuRightButtons:"ModuleStep_menuRightButtons__r-OPw",menuButtons:"ModuleStep_menuButtons__TsY6r",menuAccordionButtons:"ModuleStep_menuAccordionButtons__4QNWj",detailLabel:"ModuleStep_detailLabel__hVTU1",subLabel:"ModuleStep_subLabel__6PFJJ",modalHeaderTitle:"ModuleStep_modalHeaderTitle__hDlRr",p:"ModuleStep_p__njhI7",accordionContainer:"ModuleStep_accordionContainer__oW7nH",itemsTable:"ModuleStep_itemsTable__ttZKV",sharesTable:"ModuleStep_sharesTable__Gy1CG",peoplePositionsSelect:"ModuleStep_peoplePositionsSelect__jXRrK",peoplePositionsSelectInput:"ModuleStep_peoplePositionsSelectInput__NSg8e",peoplePositionsSelectMenuOverlay:"ModuleStep_peoplePositionsSelectMenuOverlay__S0xqm",peoplePositionsSelectMenuOverlayItem:"ModuleStep_peoplePositionsSelectMenuOverlayItem__Vuo-D",deleteText:"ModuleStep_deleteText__XIVyR",deleteButton:"ModuleStep_deleteButton__PhwaV",searchContainer:"ModuleStep_searchContainer__s1Y37",searchInput:"ModuleStep_searchInput__XukKm",emailInput:"ModuleStep_emailInput__sTwU9",actionsContainer:"ModuleStep_actionsContainer__jWMeW",detailButton:"ModuleStep_detailButton__w7F3v",detailButtonTitleContainer:"ModuleStep_detailButtonTitleContainer__8ffTu",fetchingLatestP:"ModuleStep_fetchingLatestP__gnf89",modalTitle:"ModuleStep_modalTitle__T4SaB",modalSubTitle:"ModuleStep_modalSubTitle__SIFKS",dropdownSelectComponent:"ModuleStep_dropdownSelectComponent__L66Sz",dropdownSelectComponentL:"ModuleStep_dropdownSelectComponentL__wOEsz",dropdownSelectOperation:"ModuleStep_dropdownSelectOperation__DEwuW",dropdownSelectReport:"ModuleStep_dropdownSelectReport__g2+2D",cardTitle:"ModuleStep_cardTitle__h24lD",customButton:"ModuleStep_customButton__sVkp5",fieldTypeInput:"ModuleStep_fieldTypeInput__q1+bw",fieldRowContainer:"ModuleStep_fieldRowContainer__5hIbd",templateInformation:"ModuleStep_templateInformation__UjdWL",emulatedFlexGap:"ModuleStep_emulatedFlexGap__yE15Q","mobile-navbar":"ModuleStep_mobile-navbar__P0z8E","mobile-navbar-close":"ModuleStep_mobile-navbar-close__5fZ-y","hamb-icon":"ModuleStep_hamb-icon__lSxYR","open-nav":"ModuleStep_open-nav__39a-n",description:"ModuleStep_description__GUBFo",tableHostSimple:"ModuleStep_tableHostSimple__VmM5x",imageCard:"ModuleStep_imageCard__HGrB9",imageLogoPrint:"ModuleStep_imageLogoPrint__I5-r0",title:"ModuleStep_title__whugX",statusBox:"ModuleStep_statusBox__qcpUN",checkboxLabelClass:"ModuleStep_checkboxLabelClass__h93jt"},r=o(85692),s=o(39518),c=o(14170),v=o(6073),p=o(93389),m=o(34710),f=o(88827),_=o(88374),y=o(11577),h=o(10103),g=o(88550),b=o(49119),M=o(79633),E=o(73500),C=o(47144),w=o.n(C),S=o(27436),Z=(o(68140),o(12308)),x=o(35606),k=o(13397),I=o(98032),D=o(79544),N=o(97606),P=o(8284),O=o(4292),T=o(25403),q=o(74369),A=o(50981),U=o.n(A),Y=o(27426),R=o(32562),L=o(12075),B=o(52902),j=o(89293),F=o(60534),z=o(41756),V=o.n(z),W=(o(16207),"StaticAccordionModule_section__E+rSn"),G="StaticAccordionModule_accordionContainer__6xeqD",J="StaticAccordionModule_active__39RQh",X="StaticAccordionModule_iconsContainer__YbQ+l",H="StaticAccordionModule_content__-a1q1",Q="StaticAccordionModule_fieldTypeInput__78Qbk",K="StaticAccordionModule_fieldTypeTextarea__RF3xI",$="StaticAccordionModule_emulatedFlexGap__F5FQC",ee="StaticAccordionModule_cardTitle__lJnSQ",ne="StaticAccordionModule_filtersContainer__oSB5G",oe="StaticAccordionModule_actionsContainer__WXbu6",le="StaticAccordionModule_avatarContentContainer__Kd+Dg",te="StaticAccordionModule_avatarUrlImg__6oG4I",ie="StaticAccordionModule_itemsContainerMob__+BERB",de=o(48963),ae=o(23280),ue=(0,a.memo)((function(e){var n,o,i=e.component,u=e.components,r=e.companyData,m=e.allComponents,h=e.companyUsersArray,b=e.selectedComponent,C=e.setIsOpen,w=(0,s.v9)((function(e){return e.flowReducer})),S=w.allModules,q=w.allTasks,z=w.companyPositionsArray,W=w.map,J=w.begunModule,H=(0,g.pQ)(),ee=(0,d.Z)(H,2),le=ee[0],te=ee[1],ue=(0,a.useState)(!1),re=(0,d.Z)(ue,2),se=re[0],ce=re[1],ve=(0,ae.s0)(),pe=(null===i||void 0===i||null===(n=i.selected_fields)||void 0===n?void 0:n.length)>0&&x.Z([k.Z(I.Z("index"))])(null===i||void 0===i||null===(o=i.selected_fields)||void 0===o?void 0:o.filter((function(e){return!0!==e.value||void 0!==(null===e||void 0===e?void 0:e.value)||"Transaction List"===(null===e||void 0===e?void 0:e.data_type_name)}))).map((function(e,n){var o,d,s,w,k,H,$=null===(o=b.component_fields.find((function(n){return n.field_name===(null===e||void 0===e?void 0:e.field_name)&&n.data_type_name===(null===e||void 0===e?void 0:e.data_type_name)})))||void 0===o?void 0:o.value;if((null===e||void 0===e||null===(d=e.options)||void 0===d||null===(s=d.list)||void 0===s?void 0:s.length)>0&&(null===e||void 0===e||null===(w=e.options)||void 0===w||null===(k=w.component_id)||void 0===k?void 0:k.length)>0&&("Step List"===(null===e||void 0===e?void 0:e.data_type_name)||"Component List"===(null===e||void 0===e?void 0:e.data_type_name)))return a.createElement("div",{key:n,style:{width:"100%"}},a.createElement(Z.default,{columns:e.options.list,list:(Je=e.options,u.filter((function(e){return e.id===Je.component_id})).map((function(e){return null===Je||void 0===Je?void 0:Je.list.reduce((function(n,o){return(0,t.Z)((0,t.Z)({},n),{},(0,l.Z)({},o,e.selected_fields.find((function(e){return e.field_name===o})).value))}),{})})))}));if("output"===e.data_type&&"Formula"!==e.data_type_name&&"Item Formula"!==e.data_type_name&&"Record"!==e.data_type_name&&"Filters"!==e.data_type_name)return null;if("Info"===e.data_type_name)return null;if("Transaction List"===e.data_type_name)return null;if("URL"===e.data_type_name)return null;if("Ratings"===e.data_type_name)return null;if("Rewards"===e.data_type_name)return null;if("Map"===e.data_type_name){var ee,ae,ue,re=JSON.parse($||(null!==(ee=null===e||void 0===e?void 0:e.value)&&void 0!==ee?ee:"{}"));if(null!==re&&void 0!==re&&null!==(ae=re.routes)&&void 0!==ae&&ae.DRIVE)W.routes={DRIVE:re.routes.DRIVE},W.pins=null!==(ue=null===re||void 0===re?void 0:re.pins)&&void 0!==ue?ue:[];else null!==re&&void 0!==re&&re.pins&&(W.pins=null===re||void 0===re?void 0:re.pins,W.routes={DRIVE:[]});return a.createElement("div",{key:n})}if("Lookup"===e.data_type_name)return null;if("Calendar"===e.data_type_name)return null;if("Summary"===e.data_type_name)return null;if("ID"===e.data_type_name)return a.createElement(M.D,{key:n,width:E.tq?"100%":"48%",fieldLabel:e.field_name,style:{border:"0"},fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},a.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},type:e.data_type,onChange:function(){},autoComplete:"none",value:null!==(H=$)&&void 0!==H?H:null===e||void 0===e?void 0:e.value,className:Q,name:e.field_name}));var pe,me,fe,_e,ye,he,ge,be,Me,Ee,Ce,we,Se,Ze,xe,ke,Ie,De,Ne,Pe,Oe,Te,qe,Ae,Ue,Ye,Re,Le,Be,je,Fe,ze,Ve,We,Ge,Je,Xe=null===i||void 0===i||null===(pe=i.selected_fields)||void 0===pe?void 0:pe.find((function(e){return"Info"===e.data_type_name&&!0===e.visible}));if(Xe){var He,Qe,Ke=m.find((function(e){return(null===e||void 0===e?void 0:e.component_fields.filter((function(e){return e.component_blueprint_id===Xe.options.component_id&&e.value===$})).length)>0}));if(Ke)return null===Xe||void 0===Xe||null===(He=Xe.options)||void 0===He||null===(Qe=He.list)||void 0===Qe?void 0:Qe.map((function(n,o){var l,t,i=null!==(l=null===(t=Ke.component_fields.find((function(e){return e.field_name===n})))||void 0===t?void 0:t.value)&&void 0!==l?l:"";return null!==i&&void 0!==i&&i.includes("jpg")||null!==i&&void 0!==i&&i.includes("jpeg")||null!==i&&void 0!==i&&i.includes("png")?a.createElement(M.D,{width:E.tq?"100%":"48%",style:{border:"0"},key:100+o,isProcess:!0,visible:e.visible&&(null===b||void 0===b?void 0:b.show),mandatory:!1,error:e.errors,fieldLabel:"Additional Information",customIconBgColor:"white"},a.createElement("div",{className:G,onClick:function(){return window.open($,"_blank")},style:{backgroundColor:"transparent",border:"none"}},a.createElement("img",{alt:"lg",onError:function(e){return e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg"},src:i,style:{width:"100%",height:"100%",cursor:"pointer"}}))):a.createElement(M.D,{enabled:!1,width:E.tq?"100%":"48%",key:100+o,style:{border:"0"},fieldLabel:n,fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors},i.length>55?a.createElement("textarea",{className:K,type:e.data_type,value:i,onFocus:function(){},autoComplete:"none",onChange:function(e){},readOnly:!0,style:{backgroundColor:"rgba(234, 231, 231, 0.91)",height:"auto",padding:"10px"}}):a.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},autoComplete:"none",value:i,className:Q,name:e.field_name}))}))}if("Pin"===e.data_type_name&&$){var $e,en,nn,on,ln,tn,dn,an,un,rn=JSON.parse($);return a.createElement(M.D,{enabled:!1,width:E.tq?"100%":"92%",key:n,style:{border:"0"},fieldLabel:e.field_name,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors},a.createElement("div",{style:{width:"inherit",pointerEvents:"none"}},a.createElement(Y.Z,{zoom:null===e||void 0===e||null===($e=e.options)||void 0===$e?void 0:$e.zoom,mapkey:null===(en=r.misc_info)||void 0===en?void 0:en.map,pins:null!==rn&&void 0!==rn&&rn.realtime?null!==rn&&void 0!==rn&&null!==(nn=rn.destination)&&void 0!==nn&&nn.address?[(0,t.Z)((0,t.Z)({},rn.destination),{},{type:"destination"}),(0,t.Z)((0,t.Z)({},rn.source),{},{type:"source"}),(0,t.Z)((0,t.Z)({},rn.realtime),{},{type:"realtime"})]:[(0,t.Z)((0,t.Z)({},rn.source),{},{type:"source"}),(0,t.Z)((0,t.Z)({},rn.realtime),{},{type:"realtime"})]:null!==rn&&void 0!==rn&&null!==(on=rn.destination)&&void 0!==on&&on.address?[(0,t.Z)((0,t.Z)({},rn.destination),{},{type:"destination"}),(0,t.Z)((0,t.Z)({},rn.source),{},{type:"source"})]:[(0,t.Z)((0,t.Z)({},rn.source),{},{type:"source"})]}),a.createElement("div",{className:ne,style:{color:"var(--app-color-gray-dark)",height:"inherit",width:"100%",display:null!==e&&void 0!==e&&e.visible?"":"none"}},a.createElement("div",{className:oe,style:{fontSize:"12px"}},(null===rn||void 0===rn||null===(ln=rn.destination)||void 0===ln?void 0:ln.address)&&a.createElement("div",{style:{width:"100px",fontWeight:"bold",fontSize:"14px"}},"From",":"),a.createElement("div",{style:{fontWeight:"bold"}},rn.source.address),!(null!==rn&&void 0!==rn&&null!==(tn=rn.destination)&&void 0!==tn&&tn.address)&&a.createElement(L.G,{icon:B.opg,style:{color:"green",height:"20px",width:"20px"}})),(null===rn||void 0===rn||null===(dn=rn.destination)||void 0===dn?void 0:dn.address)&&a.createElement("hr",{style:{borderTop:"0.5px solid #D2D2D2"}}),(null===rn||void 0===rn||null===(an=rn.destination)||void 0===an?void 0:an.address)&&a.createElement("div",{className:oe,style:{fontSize:"12px"}},a.createElement("div",{style:{width:"100px",fontWeight:"bold"}},"To",":"),a.createElement("div",{style:{fontWeight:"bold"}},null===rn||void 0===rn||null===(un=rn.destination)||void 0===un?void 0:un.address)))))}if("Action Button"===(null===e||void 0===e?void 0:e.data_type_name)&&(null===e||void 0===e||null===(me=e.options)||void 0===me||null===(fe=me.action)||void 0===fe?void 0:fe.length)>0){var sn,cn,vn,pn=null===h||void 0===h?void 0:h.find((function(e){return e.id===$}));return a.createElement(M.D,{width:E.tq?"100%":"48%",key:n,style:{border:"0"},isProcess:!0,fieldLabel:null!==(sn=e.options)&&void 0!==sn&&sn.notes?null===(cn=e.options)||void 0===cn?void 0:cn.notes:e.field_name,enabled:!1,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors},"user"===e.options.action&&a.createElement("input",{style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:pn?"".concat(null===pn||void 0===pn?void 0:pn.first_name," ").concat(null===pn||void 0===pn?void 0:pn.last_name):null!==(vn=null===e||void 0===e?void 0:e.value)&&void 0!==vn?vn:"",className:Q,name:e.field_name}))}if("Link"===e.data_type_name)return a.createElement(M.D,{width:E.tq?"100%":"48%",style:{border:"0"},key:n,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors,customIconBgColor:"white"},null!==(ke=$)&&void 0!==ke&&ke.includes("jpg")||null!==(Ie=$)&&void 0!==Ie&&Ie.includes("jpeg")||null!==(De=$)&&void 0!==De&&De.includes("png")||null!==e&&void 0!==e&&null!==(Ne=e.options)&&void 0!==Ne&&Ne.image?a.createElement("img",{alt:"lg",onError:function(e){return e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg"},src:null!==(Pe=$)&&void 0!==Pe?Pe:"https://i.quotev.com/b2gtjqawaaaa.jpg",style:{width:"100%",height:"100%",cursor:"pointer"}}):null!==(Oe=$)&&void 0!==Oe&&Oe.includes("pdf")?a.createElement("div",{className:G,onClick:function(){return window.open($,"_blank")}},a.createElement("embed",{onClick:function(){return window.open($,"_blank")},src:"".concat($,"#toolbar=0&navpanes=0&scrollbar=0"),width:"400px",height:"500px"})):$?a.createElement("div",{style:{width:"inherit",textDecoration:"underline",textAlign:"center",cursor:"pointer"},onClick:function(){return window.open($,"_blank")}},"Link"):a.createElement("div",null));if("Freehand"===e.data_type_name)return a.createElement(M.D,{width:E.tq?"100%":"48%",style:{border:"0"},key:n,fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white"},a.createElement("div",{className:G,onClick:function(){return window.open($,"_blank")}},a.createElement("img",{alt:"lg",onError:function(e){return e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg"},src:null!==(Te=$)&&void 0!==Te?Te:"https://i.quotev.com/b2gtjqawaaaa.jpg",style:{width:"100%",height:"100%",cursor:"pointer"}})));if("Checkbox"===e.data_type_name)return a.createElement(M.D,{width:E.tq?"100%":"48%",key:n,style:{border:"0"},fieldLabel:null!==(qe=e.options.value)&&void 0!==qe?qe:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},a.createElement("input",{style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:void 0===$?"":1==$?"Yes":"No",className:Q,name:e.field_name}));if("YesNo"===e.data_type_name)return a.createElement(M.D,{width:E.tq?"100%":"48%",key:n,style:{border:"0.5px dashed gray",padding:"10px"},fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},a.createElement("div",{style:{display:"flex",justifyContent:"space-between",margin:"20px 0px"}},a.createElement("input",{id:"check-23",type:"checkbox",readOnly:!0,checked:!!$}),a.createElement("label",null,e.field_name)));if("Upload"===e.data_type_name)return a.createElement(M.D,{key:n,fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:void 0!==$||(null===(Ae=$)||void 0===Ae?void 0:Ae.length)>0,mandatory:!1,error:e.errors,customIconBgColor:"white",style:{border:"0",marginRight:"10px"}},a.createElement("a",{key:n,href:$,download:"Example-PDF-document",target:"_blank",rel:"noreferrer"},a.createElement(c.zx,{clear:!0,title:"Download File"})));if("Status"===e.data_type_name)return a.createElement(M.D,{width:E.tq?"100%":"48%",key:n,style:{border:"0"},fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},a.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:null!==(Ue=null===b||void 0===b?void 0:b.status)&&void 0!==Ue?Ue:null!==(Ye=null!==(Re=null===e||void 0===e?void 0:e.value)&&void 0!==Re?Re:$)&&void 0!==Ye?Ye:"",className:Q,name:e.field_name}));if("Dropdown"===e.data_type_name&&"modules"===e.options&&($=null===(Le=S.find((function(e){return e.id===$})))||void 0===Le?void 0:Le.name),"Positions"===e.data_type_name&&($=null===z||void 0===z||null===(Be=z.find((function(e){return e.value===$})))||void 0===Be?void 0:Be.label),"People"===e.data_type_name)if(e.options.calendar){var mn,fn={};try{var _n,yn;fn=JSON.parse(null!==(_n=$)&&void 0!==_n?_n:null!==(yn=null===e||void 0===e?void 0:e.value)&&void 0!==yn?yn:JSON.stringify({}))}catch(An){}var hn=h.find((function(e){var n;return e.id===(null===(n=fn)||void 0===n?void 0:n.user)}));if($=hn?"".concat(hn.first_name," ").concat(hn.last_name):"",null!==(mn=fn)&&void 0!==mn&&mn.task){var gn,bn=q.find((function(e){return e.id===fn.task}));return a.createElement(M.D,{enabled:!1,width:E.tq?"100%":"48%",key:n,style:{border:"0"},fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors},a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"inherit"}},a.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:$,readOnly:!0,className:Q,name:e.field_name}),bn&&a.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:null===bn||void 0===bn?void 0:bn.name,readOnly:!0,className:Q,name:e.field_name}),bn&&a.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:U()(new Date(null===bn||void 0===bn||null===(gn=bn.add_info)||void 0===gn?void 0:gn.start)).format("DD MMM YYYY h:mm a"),readOnly:!0,className:Q,name:e.field_name}),(null===bn||void 0===bn?void 0:bn.status)&&a.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:null===bn||void 0===bn?void 0:bn.status,readOnly:!0,className:Q,name:e.field_name})))}}else if(!$){var Mn=h.find((function(n){return n.id===e.value}));$=Mn?"".concat(Mn.first_name," ").concat(Mn.last_name):""}if("Video"===e.data_type_name&&(null===b||void 0===b?void 0:b.status)===(null!==(_e=null===e||void 0===e||null===(ye=e.options)||void 0===ye?void 0:ye.status)&&void 0!==_e?_e:"New")&&(null!==e&&void 0!==e&&e.value||$)&&U()(null!==(je=null===e||void 0===e?void 0:e.value)&&void 0!==je?je:$)<=(0,A.now)()&&(0,A.now)()<U()(null!==(Fe=null===e||void 0===e?void 0:e.value)&&void 0!==Fe?Fe:$).add("minutes",+(null!==(ze=null===e||void 0===e||null===(Ve=e.options)||void 0===Ve?void 0:Ve.expiry)&&void 0!==ze?ze:30)))return a.createElement(M.D,{width:"100%",key:n,style:{border:"1px dashed gray"},fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors},a.createElement("div",{className:oe,style:{display:"flex",justifyContent:"center",fontSize:"12px"}},a.createElement(R.Z,{payload:{name:b.id}})));if("Module"===e.data_type_name&&null!==e&&void 0!==e&&null!==(he=e.options)&&void 0!==he&&he.detail){var En,Cn,wn,Sn,Zn,xn,kn,In,Dn,Nn=S.find((function(n){return n.id===e.options.module_id})),Pn=x.Z([D.Z(I.Z("created_date"))])(m.filter((function(e){return e.module_id===Nn.id}))).filter((function(n){var o,l=null===(o=b.component_fields.find((function(n){var o;return n.field_name===(null===(o=e.options)||void 0===o?void 0:o.key)})))||void 0===o?void 0:o.value;return n.component_fields.find((function(n){var o;return n.value===l&&n.field_name===(null===(o=e.options)||void 0===o?void 0:o.key)}))})).map((function(e){var n;return n={id:e.id,Transaction:e.title},(0,l.Z)(n,"Date Created","".concat(U()(new Date(e.created_date)).format("DD MMM YYYY h:mm a"))),(0,l.Z)(n,"Status",e.status),n}));return a.createElement("div",{className:X,style:{display:"flex",flexDirection:"column",alignItems:"center",alignContent:"space-between",justifyContent:"center",width:"100%",margin:"40px 0"}},(null===e||void 0===e||null===(En=e.options)||void 0===En?void 0:En.showL)&&(null===Pn||void 0===Pn?void 0:Pn.length)>0&&a.createElement(M.D,{fieldLabel:e.field_name,width:"100%",key:n,fieldIcon:e.icon,isProcess:!0,visible:e.visible,mandatory:!1,error:e.errors},a.createElement("br",null),a.createElement(F.Z,{style:{width:"100%",marginBottom:"20px"},tableHostSimple:E.tq?ie:de.Z.itemsContainer_ii,withColumns:!1,columns:["Transaction","Date Created","Status"],list:Pn})),!((null===b||void 0===b?void 0:b.status)===(null!==(Cn=null===J||void 0===J||null===(wn=J.processModule)||void 0===wn||null===(Sn=wn.module)||void 0===Sn||null===(Zn=Sn.options)||void 0===Zn?void 0:Zn.lock)&&void 0!==Cn?Cn:null===r||void 0===r||null===(xn=r.misc_info)||void 0===xn?void 0:xn.lock)||(null===b||void 0===b?void 0:b.status)===(null!==(kn=null===Nn||void 0===Nn||null===(In=Nn.options)||void 0===In?void 0:In.lock)&&void 0!==kn?kn:null===r||void 0===r||null===(Dn=r.misc_info)||void 0===Dn?void 0:Dn.lock))&&a.createElement(c.zx,{style:{backgroundColor:"var(--app-color-blue)",width:"30%"},title:null===e||void 0===e?void 0:e.field_name,message:"Preparing ".concat(Nn.name," entry..."),loading:se,clicked:function(){ce(!0),(0,p.zJ)(Nn.procedure.id).pipe((0,y.P)()).subscribe({next:function(n){var o;if(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.cmp){var i,d,a,u,r=null===n||void 0===n||null===(i=n.steps)||void 0===i?void 0:i.find((function(e){return e.component_blueprints.filter((function(e){var n,o;return(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find((function(e){return"Transaction List"===e.data_type_name})))})).length>0})),s=null===r||void 0===r||null===(d=r.component_blueprints)||void 0===d?void 0:d.find((function(e){var n;return(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Transaction List"===e.data_type_name&&!0===e.visible})).length)>0})),c=null===s||void 0===s||null===(a=s.selected_fields)||void 0===a?void 0:a.filter((function(e){var n;return null===(n=e.options)||void 0===n?void 0:n.mapToItem})).reduce((function(e,n){var o,i=N.Z(P.Z("field_name",n.field_name),O.Z(T.Z("selected_fields",le.components.concat(le.newStepComponents))));return i&&(null===i||void 0===i?void 0:i.data_type_name)===n.data_type_name?(0,t.Z)((0,t.Z)({},e),{},(0,l.Z)({},null===(o=n.options)||void 0===o?void 0:o.mapToItem,i.value)):e}),{});if(Object.values(c).length>0)(0,v.r6)(null===e||void 0===e||null===(u=e.options)||void 0===u?void 0:u.cmp).pipe((0,y.P)()).subscribe({next:function(n){var o,l;(0,v.np)((0,t.Z)((0,t.Z)({},c),{},{index:null===(o=n.component_items)||void 0===o?void 0:o.length,id:(0,j.mR)()}),null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.cmp).pipe((0,y.P)()).subscribe({next:function(e){ce(!1),f.h.dispatch((0,_.Xc)({show:!0,message:"Success, an item was added."})),C(!1)},error:function(){}})},error:function(){}});else ce(!1)}else ce(!1),le.components=[],le.newStepsComponent=[],e.options.fields.filter((function(e){var o,l,t=null===(o=b.component_fields.find((function(n){return n.field_name===e})))||void 0===o?void 0:o.value;null===(l=n.steps)||void 0===l||l.forEach((function(n){var o;null===n||void 0===n||null===(o=n.component_blueprints)||void 0===o||o.filter((function(e){var n;return!(null!==(n=e.options)&&void 0!==n&&n.asModuleList)})).forEach((function(n){var o=n.selected_fields.find((function(n){return n.field_name===e&&1==n.visible}));o&&(o.value=t)})),n.component_blueprints.find((function(n){return n.selected_fields.filter((function(n){return n.field_name===e})).length>0}))&&te({action:g._U.addNewComponent,value:n.component_blueprints.filter((function(n){return n.selected_fields.filter((function(n){return n.field_name===e})).length>0}))})}))})),f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},n),{},{completeSteps:n.steps,steps:n.steps,stepIndex:1,module_id:e.options.module_id,module:S.find((function(n){return n.id===e.options.module_id}))}))),te({action:g._U.setCurrentStep,value:n.steps[1]}),te({action:g._U.setModuleItems,value:[]}),C(!1),f.h.dispatch((0,_.IW)(!1)),ve("/begin-module")}})}}))}if("Module"===e.data_type_name)return null;if("Details"===e.data_type_name&&null!==e&&void 0!==e&&null!==(ge=e.options)&&void 0!==ge&&ge.key&&(null===(be=e.options)||void 0===be||null===(Me=be.fields)||void 0===Me?void 0:Me.length)>0){var On,Tn,qn=m.find((function(n){return n.module_id===e.options.module_id&&n.component_fields.find((function(n){var o,l;return n.field_name===e.options.key&&n.value===(null===b||void 0===b||null===(o=b.component_fields)||void 0===o||null===(l=o.find((function(n){return n.field_name===e.options.key&&n.value})))||void 0===l?void 0:l.value)}))}));$=null===qn||void 0===qn||null===(On=qn.component_fields)||void 0===On||null===(Tn=On.find((function(n){var o;return n.field_name===(null===(o=e.options)||void 0===o?void 0:o.fields[0])})))||void 0===Tn?void 0:Tn.value}return"Clock"===e.data_type_name&&($=U()(new Date(+$)).format("DD MMM YYYY h:mm a")),"Long Text"===e.data_type_name&&null!==(Ee=e.options)&&void 0!==Ee&&Ee.rich?a.createElement(M.D,{enabled:!1,width:E.tq?"100%":"".concat(+(null!==(We=null===e||void 0===e||null===(Ge=e.options)||void 0===Ge?void 0:Ge.width)&&void 0!==We?We:"50")>51?"97":"48","%"),key:n,style:{border:"0"},fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors},a.createElement(V(),{modules:{toolbar:!1},style:{fontFamily:"var(--app-text-main-font)"},readOnly:!0,defaultValue:$,theme:"snow"})):a.createElement(M.D,{enabled:!1,width:E.tq?"100%":"48%",key:n,style:{border:"0"},fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||$),mandatory:!1,error:e.errors},(null===(Ce=$)||void 0===Ce?void 0:Ce.length)>50&&!E.tq||(null===(we=$)||void 0===we?void 0:we.length)>20&&E.tq&&"Date"!==e.data_type_name?a.createElement("textarea",{readOnly:!0,className:K,style:{padding:"10px",pointerEvents:"none"},onFocus:function(){},required:!0,value:null===$||void 0===$?"Date"===e.data_type_name||"Video"===e.data_type_name?U()(new Date(null===e||void 0===e?void 0:e.value)).format("DD MMM YYYY"):null===e||void 0===e?void 0:e.value:"Date"===e.data_type_name||"Video"===e.data_type_name?U()(new Date($)).format("DD MMM YYYY"):$,onChange:function(e){}}):a.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:null===$||void 0===$?null===e||void 0===e?void 0:e.value:"Dropdown"===e.data_type_name&&"modules"===(null===(Se=e.options)||void 0===Se?void 0:Se.type)?null===(Ze=S.find((function(n){return n.id===e.value})))||void 0===Ze?void 0:Ze.name:"Date"===e.data_type_name||"Video"===e.data_type_name?"Invalid date"===U()(new Date($)).format("DD MMM YYYY")?"":U()(new Date($)).format(null!==e&&void 0!==e&&null!==(xe=e.options)&&void 0!==xe&&xe.time?"DD MMM YYYY h:mm a":"MMMM DD, YYYY"):$,className:Q,name:e.field_name}))}));return a.createElement("div",{className:$,style:{width:E.tq?"100%":""}},pe)})),re=function(e){var n,o,l,t,i,u=e.component,r=e.blueprintIndex,c=e.companyData,v=e.components,p=e.allComponents,m=e.companyUsersArray,f=e.selectedComponent,_=e.setIsOpen,y=(0,g.pQ)(),h=(0,d.Z)(y,2),b=h[0],M=(h[1],(0,s.v9)((function(e){return e.authReducer})).authenticatedUser),C=(0,a.useState)(J),Z=(0,d.Z)(C,1)[0],x=(0,a.useState)(""),k=(0,d.Z)(x,1)[0],I=(0,a.useRef)(null),D=null===(n=b.currentStep)||void 0===n?void 0:n.component_blueprints.findIndex((function(e){return e.id===u.id})),N=u.selected_fields.filter((function(e){return"Pin"===e.data_type_name||"Map"===e.data_type_name})).length>0;return a.createElement("div",{id:"accordion",className:W,key:r,style:{display:void 0===(null===(o=u.options)||void 0===o?void 0:o.showOnly)||0==(null===(l=u.options)||void 0===l?void 0:l.showOnly.length)||M.positions.filter((function(e){var n,o;return null===(n=u.options)||void 0===n||null===(o=n.showOnly)||void 0===o?void 0:o.includes(e.id)})).length>0||(null===(t=u.options)||void 0===t?void 0:t.statusOnly)===(null===f||void 0===f?void 0:f.status)?"":"none"}},a.createElement("div",{className:w()(G,Z),"app-variant-has-error":k?"error":""},!(N&&E.tq)&&a.createElement("p",{className:ee},null===u||void 0===u?void 0:u.name),a.createElement("div",{ref:I,style:{maxHeight:Z===J?"":"0px",display:"flex"},className:H},a.createElement(ue,{components:v,allComponents:p,component:u,handleInputChange:function(){},handlePrefixChange:function(){},handleCurrencyChange:function(){},checkIfAreMandatoryErrored:!1,handleCheckbox:function(){},isInherited:!1,indexInContextArray:D,handleLocationChange:function(){},processTaskContext:b,companyData:c,companyUsersArray:m,selectedComponent:f,setIsOpen:_}))),k&&(null===k||void 0===k||null===(i=k.errors)||void 0===i?void 0:i.title)&&a.createElement(S.Z,{message:k.errors.title}),k&&(null===k||void 0===k?void 0:k.message)&&a.createElement(S.Z,{message:k.message}))},se=function(e){var n,o,l,t,i=(0,a.useState)(!1),u=(0,d.Z)(i,2),r=u[0],s=u[1],c=e.component,v=e.show,p=void 0!==v&&v,m=e.process;return a.createElement("div",{className:G},a.createElement("div",{className:$,style:{width:(E.tq,"100%")}},a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Created By",style:{border:"0"},isProcess:!0,visible:!0},a.createElement("input",{onClick:function(){return s(!r)},readOnly:!0,onChange:function(){},autoComplete:"none",value:p?null===(n=c.created_by)||void 0===n?void 0:n.id.replace(/\D/g,"").slice(-5):"".concat(null===(o=c.created_by)||void 0===o?void 0:o.first_name," ").concat(null===(l=c.created_by)||void 0===l?void 0:l.last_name),className:Q})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Created Date",style:{border:"0"},isProcess:!0,visible:!0},a.createElement("input",{style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:U()(new Date(c.created_date)).format("DD MMM YYYY h:mm a"),className:Q,name:"Created Date"})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Transaction ID",style:{border:"0"},isProcess:!0,visible:r},a.createElement("input",{onChange:function(){},autoComplete:"none",value:c.id,className:Q,name:"CID"})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Transaction Title",style:{border:"0"},isProcess:!0,visible:r},a.createElement("input",{onChange:function(){},autoComplete:"none",value:c.title,className:Q,name:"CID"})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Module",style:{border:"0"},isProcess:!0,visible:r},a.createElement("input",{onChange:function(){},autoComplete:"none",value:null===m||void 0===m||null===(t=m.module)||void 0===t?void 0:t.name,className:Q,name:"CID"})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Process",style:{border:"0"},isProcess:!0,visible:r},a.createElement("input",{onChange:function(){},autoComplete:"none",value:null===m||void 0===m?void 0:m.name,className:Q,name:"CID"}))))},ce=function(e){var n,o,l,t=e.component;return a.createElement("div",{className:G,style:{display:t.payments?"":"none"}},a.createElement("div",{className:$,style:{width:(E.tq,"100%")}},a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Payments",style:{border:"0"},isProcess:!0,visible:!0},a.createElement("input",{style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:"".concat(null===(n=t.payments)||void 0===n?void 0:n.stripe_product,", ID: ").concat(null===(o=t.payments)||void 0===o?void 0:o.stripe_id.substring(0,13)),className:Q})),a.createElement(M.D,{width:E.tq?"100%":"48%",fieldLabel:"Amount Paid",style:{border:"0"},isProcess:!0,visible:!0},a.createElement("input",{style:{pointerEvents:"none"},onChange:function(){},autoComplete:"none",value:"".concat(null===(l=t.payments)||void 0===l?void 0:l.stripe_price),className:Q}))))},ve=function(e){var n,o,l,i,u,r,s,c=e.field,v=e.selectedComponent,p=e.companyUsersArray,m=e.component,f=function(e){var n,o,l,t,i,d,u,r,s,c,v,f,_,y,h,g,b,M=e.field,E=(e.index,e.item);if("People"===(null===M||void 0===M?void 0:M.data_type_name)&&(null===M||void 0===M||null===(n=M.options)||void 0===n||null===(o=n.position_id)||void 0===o?void 0:o.length)>0){var C=p.find((function(e){return(null===M||void 0===M?void 0:M.value)==="".concat(e.first_name," ").concat(e.last_name)}));return a.createElement("div",{style:{display:"flex",justifyContent:"center"}},C&&a.createElement("div",{className:le},a.createElement("img",{alt:"lg",src:null===C||void 0===C?void 0:C.photo,className:te})))}if("Link"===(null===M||void 0===M?void 0:M.data_type_name)||"URL"===(null===M||void 0===M?void 0:M.data_type_name))return null!==M&&void 0!==M&&null!==(s=M.value)&&void 0!==s&&s.includes("jpg")||null!==M&&void 0!==M&&null!==(c=M.value)&&void 0!==c&&c.includes("jpeg")||null!==M&&void 0!==M&&null!==(v=M.value)&&void 0!==v&&v.includes("png")?a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement("div",{className:le},a.createElement("img",{alt:"lg",src:null===M||void 0===M?void 0:M.value,className:te}))):a.createElement("div",null,null===M||void 0===M?void 0:M.value);if("date"===M.data_type||null!==M&&void 0!==M&&null!==(l=M.options)&&void 0!==l&&l.country_code||null!==M&&void 0!==M&&null!==(t=M.options)&&void 0!==t&&t.currency_type||"Number"===M.data_type_name||"Clock"===M.data_type_name)return"bar"===(null===M||void 0===M||null===(f=M.options)||void 0===f?void 0:f.display)?a.createElement("div",{className:Q,style:{paddingLeft:"0px",border:"none",height:"auto"}},a.createElement("div",{style:{height:"10px",width:"100%",backgroundColor:null===M||void 0===M||null===(_=M.options)||void 0===_?void 0:_.maxC,display:"flex",flexDirection:"row",border:"none"}},a.createElement("input",{defaultValue:"",className:Q,name:M.field_name,style:{color:"transparent",border:"none",height:"10px",width:"".concat(+(null===M||void 0===M?void 0:M.value)/+M.options.max*100,"%"),backgroundColor:null!==M&&void 0!==M&&M.value?"0"===(null===M||void 0===M?void 0:M.value)?"transparent":null===M||void 0===M||null===(y=M.options)||void 0===y?void 0:y.barC:"transparent"}}))):a.createElement("div",{style:{backgroundColor:null!==M&&void 0!==M&&null!==(h=M.options)&&void 0!==h&&h.valueC?null===M||void 0===M||null===(g=M.options)||void 0===g?void 0:g.valueC:""}},"date"===(null===M||void 0===M?void 0:M.data_type)||"Clock"===(null===M||void 0===M?void 0:M.data_type_name)?U()(M.value).format(null!==M&&void 0!==M&&null!==(b=M.options)&&void 0!==b&&b.time?"DD MMMM YYYY HH:mm":"DD MMMM YYYY"):null===M||void 0===M?void 0:M.value);if("Item Formula"===(null===M||void 0===M?void 0:M.data_type_name)&&(null===M||void 0===M||null===(i=M.options)||void 0===i||null===(d=i.operator)||void 0===d?void 0:d.length)>0){var w,S,Z=(0,j.LV)(null===M||void 0===M?void 0:M.options,m.selected_fields.filter((function(e){return M.options.list.includes(e.field_name)&&e.options.mapToItem})),[],[],E,!0);return a.createElement("div",{style:{backgroundColor:null!==M&&void 0!==M&&null!==(w=M.options)&&void 0!==w&&w.valueC?null===M||void 0===M||null===(S=M.options)||void 0===S?void 0:S.valueC:""}},Z)}return a.createElement("div",{style:{backgroundColor:null!==M&&void 0!==M&&null!==(u=M.options)&&void 0!==u&&u.valueC?null===M||void 0===M||null===(r=M.options)||void 0===r?void 0:r.valueC:""}},null===M||void 0===M?void 0:M.value)},_={item_code:null,quantity:null,value:null,alt_value:null,total:null},y=Object.entries(Object.assign(_,null===c||void 0===c?void 0:c.options.map)).reduce((function(e,n){var o=(0,d.Z)(n,2),l=o[0],t=o[1];return null===t||(e[l]=t),e}),{}),h=Object.entries(Object.assign(_,null===c||void 0===c?void 0:c.options.map)).reduce((function(e,n){var o=(0,d.Z)(n,2),l=o[0],t=o[1];return null===t||(e[l]=t),e}),{});Object.keys(y).map((function(e){var n;"item_code"===e?h.item_code="Totals:":"quantity"===e?h[e]="".concat(q.Z((function(n,o){var l;return null!==(l=+n+ +o[e])&&void 0!==l?l:0}),0,null!==(n=null===v||void 0===v?void 0:v.component_items)&&void 0!==n?n:[])):("alt_value"===e||"value"===e||"total"===e)&&(h[e]="")}));var g=null!==c&&void 0!==c&&null!==(n=c.options)&&void 0!==n&&n.group?null!==(o=null===m||void 0===m||null===(l=m.selected_fields)||void 0===l||null===(i=l.find((function(e){var n,o;return(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.mapToItem)===(null===c||void 0===c||null===(o=c.options)||void 0===o?void 0:o.groupL)&&"Dropdown"===e.data_type_name})))||void 0===i||null===(u=i.options)||void 0===u?void 0:u.list)&&void 0!==o?o:[]:null!==c&&void 0!==c&&null!==(r=c.options)&&void 0!==r&&r.type?[null===c||void 0===c||null===(s=c.options)||void 0===s?void 0:s.type]:[void 0];return a.createElement("div",{style:{width:"100%",border:"1px dashed gray",borderRadius:"10px",padding:"16px",fontFamily:"var(--app-text-main-font)",margin:"20px 0",display:v.component_items.length>0?"":"none"}},a.createElement("p",{style:{fontSize:"20px",fontFamily:"var(--app-text-main-font)",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},c.field_name),null===g||void 0===g?void 0:g.map((function(e,n){var o,l,i,d,u,r,s,p=null===(o=x.Z([k.Z(I.Z("index"))])(null!==(l=null===v||void 0===v||null===(i=v.component_items)||void 0===i?void 0:i.filter((function(n){var o;return n[null===c||void 0===c||null===(o=c.options)||void 0===o?void 0:o.groupL]===e||n.type===e})))&&void 0!==l?l:[]))||void 0===o?void 0:o.map((function(e,n){var o;e.index=n;var l={index:n};return null===m||void 0===m||null===(o=m.selected_fields)||void 0===o||o.filter((function(e){var n;return null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.mapToItem})).map((function(o){var i,d=(0,j.sO)(e[o.options.mapToItem])?JSON.parse(null!==(i=e[o.options.mapToItem])&&void 0!==i?i:"{}")[o.field_name]:e[o.options.mapToItem];l[o.field_name]=a.createElement(f,{index:n,item:e,field:(0,t.Z)((0,t.Z)({},o),{},{visible:!0,value:null!==d&&void 0!==d?d:""})})})),l}));return a.createElement(a.Fragment,null,p.length>0&&a.createElement(F.Z,{key:n,withColumns:0!==p.length,style:{width:"100%",marginBottom:"20px"},tableHostSimple:E.tq?ie:de.Z.itemsContainer_ii,layeredColumns:null===(d=x.Z([k.Z(I.Z("index"))])(null===m||void 0===m?void 0:m.selected_fields))||void 0===d?void 0:d.filter((function(e){var n;return null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.mapToItem})).map((function(e){var n,o;return null!==(n=e.options)&&void 0!==n&&n.group?{label:null===(o=e.options)||void 0===o?void 0:o.group,subColumns:[{label:e.field_name}]}:{label:e.field_name}})).slice(0,E.tq?3:8),list:p,footer:p.length>0&&null!==(u=c.options)&&void 0!==u&&u.footer?null===m||void 0===m||null===(r=m.selected_fields)||void 0===r?void 0:r.filter((function(e){var n;return null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.mapToItem})).map((function(e,n){var o,l;return null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.footer?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return 0==(null===e||void 0===e?void 0:e.length)?0:e.reduce((function(e,l){var t,i,d,a,u,r,s,c,v;if(null===l[null===n||void 0===n||null===(t=n.options)||void 0===t?void 0:t.mapToItem]||""===l[null===n||void 0===n||null===(i=n.options)||void 0===i?void 0:i.mapToItem])return e;var p=null!==(d=null!==o&&void 0!==o&&null!==(a=o.options)&&void 0!==a&&a.simple?JSON.parse(null!==(u=l[null===n||void 0===n||null===(r=n.options)||void 0===r?void 0:r.mapToItem])&&void 0!==u?u:"{}")[null===n||void 0===n?void 0:n.field_name]:l[null===n||void 0===n||null===(s=n.options)||void 0===s?void 0:s.mapToItem])&&void 0!==d?d:0;return"itemsum"===(null===n||void 0===n||null===(c=n.options)||void 0===c?void 0:c.footer)?e+ +(""===p?0:"".concat(p)):"itemdiff"===(null===n||void 0===n||null===(v=n.options)||void 0===v?void 0:v.footer)?e-+(""===p?0:"".concat(p)):0}),0)}(null!==c&&void 0!==c&&null!==(l=c.options)&&void 0!==l&&l.type?null===v||void 0===v?void 0:v.component_items.filter((function(e){var n;return e.type===(null===c||void 0===c||null===(n=c.options)||void 0===n?void 0:n.type)})):null===v||void 0===v?void 0:v.component_items,e,c):0===n?"Totals:":""})):[]},(null===c||void 0===c||null===(s=c.options)||void 0===s?void 0:s.group)&&a.createElement("p",{style:{fontSize:"16px",fontFamily:"var(--app-text-main-font)",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},e)))})))},pe=o(51330),me=function(e){var n,o=e.component,l=e.isMandatoryError,t=e.nextButtonClicked,i=e.setIsMandatoryError,u=(0,g.pQ)(),s=(0,d.Z)(u,1)[0],c=(0,a.useState)(""),v=(0,d.Z)(c,1)[0],p=(0,a.useRef)(null);(0,a.useEffect)((function(){m()}),[t]);var m=function(){var e;null!==o&&void 0!==o&&null!==(e=o.selected_fields)&&void 0!==e&&e.some((function(e){var n;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.length)<1)}))?i(!0):i(!1)},f=function(e,n){var o,l;0==n?s.newProduct={name:e,product_code:null===s||void 0===s||null===(o=s.newProduct)||void 0===o?void 0:o.product_code}:s.newProduct={product_code:e,name:null===s||void 0===s||null===(l=s.newProduct)||void 0===l?void 0:l.name}};return a.createElement("div",{id:"accordion",className:de.Z.section},a.createElement("div",{className:w()(de.Z.accordionContainer,!0),"app-variant-has-error":v?"error":""},a.createElement("div",{style:{display:"flex"}},a.createElement("p",{className:de.Z.title,style:{color:l&&t?"var(--app-color-error)":""}},"New Product Details")),a.createElement("div",{ref:p,style:{maxHeight:"",display:"flex",padding:"0px 0px 20px 0px"},className:de.Z.content},a.createElement(M.Z,{fieldIcon:r.MQ,fieldLabel:"Product Name",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},a.createElement("div",{className:de.Z.fieldRowContainer},a.createElement("input",{type:"text",onChange:function(e){f(e.target.value,0)},autoComplete:"none",className:de.Z.fieldTypeInput,name:"field.field_name"}))),a.createElement("div",{style:{width:"10px"}}),a.createElement(M.Z,{fieldIcon:r.MQ,fieldLabel:"Product Code",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},a.createElement("div",{className:de.Z.fieldRowContainer},a.createElement("input",{type:"text",onChange:function(e){f(e.target.value,1)},autoComplete:"none",className:de.Z.fieldTypeInput,name:"field.field_name"}))))),v&&(null===v||void 0===v||null===(n=v.errors)||void 0===n?void 0:n.title)&&a.createElement(S.Z,{message:v.errors.title}),v&&(null===v||void 0===v?void 0:v.message)&&a.createElement(S.Z,{message:v.message}))},fe=o(41131),_e=o(40694),ye=o(81330),he=o.n(ye),ge=o(63864),be="GeneralCard_userCard__0SOp0",Me="GeneralCard_userCardContainer__wJA5U",Ee="GeneralCard_userCardBottomContainer__0WoR6",Ce="GeneralCard_fullName__QizQf",we="GeneralCard_position__3X6Ea",Se="GeneralCard_email__U8cda",Ze=function(e){var n=e.cardClicked,o=e.title,l=e.subtitle,t=e.children,i=e.description,d=e.customClass,u=void 0===d?be:d,r=e.customStyle;return a.createElement("div",{className:u,onClick:n,style:r},a.createElement("div",{className:Me},a.createElement("div",{className:Ee},a.createElement("p",{className:Ce},o),a.createElement("p",{className:Se},i),a.createElement("p",{className:we},l),t)))},xe=o(60761),ke=o(29937),Ie=o(4358),De=o(1542),Ne=o(49523),Pe=o(9204),Oe=o(32086),Te=o(53431),qe=o(68218),Ae=o(84634),Ue=o(62169),Ye=o(88346),Re=(o(67055),o(71901),o(95007)),Le=o(87424),Be=o(27658),je=o(75105),Fe=o(51481),ze=o(41757),Ve=o(44408),We=o(23910),Ge=o(46415);o(60940),o(56120),o(37704),o(72666),o(68623),o(3863),o(95361);e=o.hmd(e);var Je=o(456);var Xe=(0,a.memo)((function(e){var n,o,l,i,r,s,v,m,f,_,h,g,M=e.step,C=e.isMandatoryError,w=e.nextButtonClicked,S=e.setIsMandatoryError,Z=e.begunModule,x=e.companyData,k=e.components,I=e.isEditing,D=e.companyUsersArray,N=e.setUsers,P=e.setPositions,O=void 0===P?function(){}:P,T=e.products,q=e.selectedComponent,Y=e.goToNextStep,R=e.authenticatedUser,L=e.setIsCompleted,B=e.companyPositionsArray,j=(e.cart,e.blueprints),F=e.allModules,z=e.usersArray,V=e.editMode,W=((0,b.WidthProvider)(b.Responsive),(0,a.useState)(null===(n=null===q||void 0===q?void 0:q.is_complete)||void 0===n||n)),G=(0,d.Z)(W,1)[0],J=[],X=a.createElement(Ge.mQ,{style:{width:"100%",marginTop:"50px",minHeight:"30vh"}},a.createElement(Ge.td,null,null===M||void 0===M?void 0:M.component_blueprints.filter((function(e){return e.selected_fields.filter((function(n){var o,l;return 1==n.visible&&"Emails"!==n.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(l=e.options)||void 0===l?void 0:l.showOnly.length)||R.positions.filter((function(n){var o,l;return null===(o=e.options)||void 0===o||null===(l=o.showOnly)||void 0===l?void 0:l.includes(n.id)})).length>0)})).length>0})).map((function(e,n){var o;return a.createElement(Ge.OK,{key:n},a.createElement("div",{style:{padding:"10px 0",fontSize:"16px",fontWeight:"bold",fontFamily:"var(--app-text-main-font)",transform:"scaleY(1.1)",color:"var(--app-color-gray-dark)"}},null===e||void 0===e||null===(o=e.name)||void 0===o?void 0:o.toUpperCase()))}))),(null===M||void 0===M||null===(o=M.component_blueprints)||void 0===o?void 0:o.length)>0?null===M||void 0===M?void 0:M.component_blueprints.filter((function(e){return e.selected_fields.filter((function(n){var o,l;return 1==n.visible&&"Emails"!==n.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(l=e.options)||void 0===l?void 0:l.showOnly.length)||R.positions.filter((function(n){var o,l;return null===(o=e.options)||void 0===o||null===(l=o.showOnly)||void 0===l?void 0:l.includes(n.id)})).length>0)})).length>0})).map((function(e,n){var o=e.selected_fields.find((function(e){return"Template"===e.data_type_name&&1==e.visible})),l=e.selected_fields.find((function(e){return"Video"===e.data_type_name&&1==e.visible}));return o?a.createElement(Ge.x4,{key:n},a.createElement(fe.ZP,{templateName:o.field_name,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,component:e,companyData:x,components:k,products:T,selectedComponent:q,component_blueprint:e,editMode:V,blueprints:j,allModules:F,authenticatedUser:R,companyUsersArray:D,companyPositionsArray:B,begunModule:Z})):e.selected_fields.filter((function(e){return 1==e.visible})).length>0?a.createElement(Ge.x4,{key:n,style:{margin:"30px 0 0 0"}},a.createElement(pe.Z,{editMode:V,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,blueprints:j,component:e,companyData:x,components:k,allModules:F,products:T,authenticatedUser:R,selectedComponent:q,companyUsersArray:D,companyPositionsArray:B,begunModule:Z}),(null===q||void 0===q?void 0:q.id)&&(null===l||void 0===l?void 0:l.value)&&U()(null===l||void 0===l?void 0:l.value)<=(0,A.now)()&&(0,A.now)()<U()(null===l||void 0===l?void 0:l.value).add("minutes",10)&&a.createElement(pe.Z,{editMode:V,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,blueprints:j,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},l),{},{options:(0,t.Z)((0,t.Z)({},l.options),{},{start:!0})})]}),companyData:x,components:k,allModules:F,products:T,authenticatedUser:R,selectedComponent:q,companyUsersArray:D,companyPositionsArray:B,begunModule:Z,shouldDisplay:!0,isEnabled:!0})):a.createElement(Ge.x4,null)})):a.createElement(Ge.x4,null)),H=(null===M||void 0===M||null===(l=M.component_blueprints)||void 0===l?void 0:l.length)>0?null===M||void 0===M?void 0:M.component_blueprints.map((function(e,n){var o=e.selected_fields.find((function(e){return"Template"===e.data_type_name&&1==e.visible})),l=e.selected_fields.find((function(e){return"Video"===e.data_type_name&&1==e.visible}));return o?a.createElement("div",{key:n},a.createElement(fe.ZP,{templateName:o.field_name,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,component:e,companyData:x,components:k,products:T,selectedComponent:q,component_blueprint:e,editMode:V,blueprints:j,allModules:F,authenticatedUser:R,companyUsersArray:D,companyPositionsArray:B,begunModule:Z})):e.selected_fields.filter((function(e){return 1==e.visible})).length>0?a.createElement("div",{key:n,style:{margin:"30px 0 0 0"}},a.createElement(pe.Z,{editMode:V,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,blueprints:j,component:e,companyData:x,components:k,allModules:F,products:T,authenticatedUser:R,selectedComponent:q,companyUsersArray:D,companyPositionsArray:B,begunModule:Z}),(null===q||void 0===q?void 0:q.id)&&(null===l||void 0===l?void 0:l.value)&&U()(null===l||void 0===l?void 0:l.value)<=(0,A.now)()&&(0,A.now)()<U()(null===l||void 0===l?void 0:l.value).add("minutes",10)&&a.createElement(pe.Z,{editMode:V,nextButtonClicked:w,isMandatoryError:C,blueprintIndex:n,setIsMandatoryError:S,blueprints:j,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},l),{},{options:(0,t.Z)((0,t.Z)({},l.options),{},{start:!0})})]}),companyData:x,components:k,allModules:F,products:T,authenticatedUser:R,selectedComponent:q,companyUsersArray:D,companyPositionsArray:B,begunModule:Z,shouldDisplay:!0,isEnabled:!0})):a.createElement(a.Fragment,null)})):a.createElement(a.Fragment,null),Q=(0,a.useState)({currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:{lg:M.options.layout},editing:I}),K=(0,d.Z)(Q,2),$=K[0],ee=K[1];return a.createElement("div",null,a.createElement(c.j3,{permissions:[c.po.processes.create]},a.createElement("button",{onClick:function(){J=$.layouts.lg.map((function(e){return(0,t.Z)((0,t.Z)({},e),{},{static:!1})})),ee((0,t.Z)((0,t.Z)({},$),{},{layouts:{lg:J},editing:!$.editing}))},hidden:!$.editing},"Edit Layout"),a.createElement("button",{onClick:function(){var e=J.map((function(e){return(0,t.Z)((0,t.Z)({},e),{},{static:!0})}));(0,p.T5)({options:(0,t.Z)((0,t.Z)({},M.options),{},{layout:e})},M.id,!0).pipe((0,y.P)()).subscribe({next:function(n){ee((0,t.Z)((0,t.Z)({},$),{},{layouts:{lg:e},editing:!$.editing}))},error:function(e){ee((0,t.Z)((0,t.Z)({},$),{},{layouts:{lg:M.options.layout},editing:!$.editing}))}})},hidden:!$.editing},"Save Layout")),null!==M&&void 0!==M&&null!==(i=M.options)&&void 0!==i&&i.tabbed&&!E.tq||null!==M&&void 0!==M&&null!==(r=M.options)&&void 0!==r&&r.tabbed&&(null===M||void 0===M?void 0:M.component_blueprints.filter((function(e){return e.selected_fields.filter((function(n){var o,l;return 1==n.visible&&"Emails"!==n.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(l=e.options)||void 0===l?void 0:l.showOnly.length)||R.positions.filter((function(n){var o,l;return null===(o=e.options)||void 0===o||null===(l=o.showOnly)||void 0===l?void 0:l.includes(n.id)})).length>0)})).length>0})).length)<3?X:H,"product"===(null===(s=Z.processModule.module)||void 0===s?void 0:s.options.outputTo)&&(null===M||void 0===M?void 0:M.is_end)&&a.createElement(me,{nextButtonClicked:w,isMandatoryError:C,setIsMandatoryError:S,component:{}}),((null===q||void 0===q||null===(v=q.created_by)||void 0===v?void 0:v.id)===R.id||(null===(m=Z.processModule)||void 0===m?void 0:m.user_id)===R.id)&&(null===(f=Z.processModule.module)||void 0===f?void 0:f.options.forSpecificUsers)&&(null===M||void 0===M?void 0:M.is_end)&&a.createElement("div",{style:{border:"1px dashed var(--app-color-gray-lighter)",marginTop:"100px",borderRadius:"8px 8px 0 0"}},a.createElement("p",{className:u.title},"Shares"),function(){var e;return a.createElement(c.jL,{ungrouped:!0,ttitle:"Select users to share this item:",columned:!0,withAckButton:!1},a.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select users to share this item:"),a.createElement(Ie.Cm,{style:{width:"50%"},id:"Users",tagEmplacement:"inlined",searchable:!1,items:z,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_users)||void 0===e?void 0:e.map((function(e){return z.find((function(n){return n.value===e.id}))})),className:u.peoplePositionsSelect,inputClassName:u.peoplePositionsSelectInput,molclassname:u.peoplePositionsSelectMenuOverlay,moliclassname:u.peoplePositionsSelectMenuOverlayItem,onChange:function(e){e.length>0?(N(null===e||void 0===e?void 0:e.map((function(e){return null===e||void 0===e?void 0:e.value}))),null!==q&&void 0!==q&&q.id&&(q.shared_users=null===e||void 0===e?void 0:e.map((function(e){return{id:null===e||void 0===e?void 0:e.value}})))):N([])}}))}(),function(){var e;return a.createElement(c.jL,{ungrouped:!0,columned:!0,withAckButton:!1},a.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select positions to share this item:"),a.createElement(Ie.Cm,{style:{width:"50%"},id:"Positions",tagEmplacement:"inlined",searchable:!1,items:B,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_positions)||void 0===e?void 0:e.map((function(e){return B.find((function(n){return n.value===e.id}))})),className:u.peoplePositionsSelect,inputClassName:u.peoplePositionsSelectInput,molclassname:u.peoplePositionsSelectMenuOverlay,moliclassname:u.peoplePositionsSelectMenuOverlayItem,onChange:function(e){e.length>0?(O(null===e||void 0===e?void 0:e.map((function(e){return null===e||void 0===e?void 0:e.value}))),null!==q&&void 0!==q&&q.id&&(q.shared_positions=null===e||void 0===e?void 0:e.map((function(e){return{id:null===e||void 0===e?void 0:e.value}})))):O([])}}))}()),(null===(_=Z.processModule.module)||void 0===_?void 0:_.options.forSpecificUsers)&&(null===M||void 0===M?void 0:M.is_end)&&a.createElement("div",{style:{height:"200px"}}),(null===M||void 0===M?void 0:M.is_end)&&(void 0===(null===q||void 0===q?void 0:q.is_complete)||0==(null===q||void 0===q?void 0:q.is_complete))&&function(){var e,n,o;return a.createElement("div",{className:u.emptyElementsSection,style:{width:"260px",padding:"0px 0px 0px 20px"}},a.createElement(c.pd,{id:"draft",title:"Save as draft?",ungrouped:!0,withAckButton:!1,style:{margin:"20px 2.5% 10px 5px",width:"auto",display:null!==Z&&void 0!==Z&&null!==(e=Z.processModule)&&void 0!==e&&null!==(n=e.module)&&void 0!==n&&null!==(o=n.options)&&void 0!==o&&o.nosave?"none":""},value:!G,toggleSelected:function(e){L(!e)}}))}(),(null===M||void 0===M||null===(h=M.pathway_steps)||void 0===h?void 0:h.length)>0&&function(){var e=M.pathway_steps.map((function(e){return{label:"".concat(e.name),value:e.id}})),n=D.map((function(e){return{label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}}));return a.createElement("div",{className:u.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(n.length*n.length>4?70:200,"px")}},a.createElement(ge.Z,{visible:!0,mandatory:!1,items:e,onChange:function(e){Y(e)},placeholder:"Continue to this step..."}))}(),(null===M||void 0===M||null===(g=M.pathway_processes)||void 0===g?void 0:g.length)>0&&function(){var e=M.pathway_processes.map((function(e){return{label:"".concat(e.name),value:e.id}})),n=D.map((function(e){return{label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}}));return a.createElement("div",{className:u.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(n.length*n.length>4?70:200,"px")}},a.createElement(ge.Z,{visible:!0,mandatory:!1,items:e,onChange:function(){},placeholder:"Continue to this process..."}))}(),e.children)})),He=function(e){var n,o,t,i,d,r,s=e.selectedComponent,c=e.companyPositionsArray,v=e.companyUsersArray;return a.createElement("div",{style:{width:"100%"}},((null===s||void 0===s||null===(n=s.shared_users)||void 0===n?void 0:n.length)>0||(null===s||void 0===s||null===(o=s.shared_positions)||void 0===o?void 0:o.length)>0)&&a.createElement("div",{className:u.accordionContainer},a.createElement("p",{className:u.cardTitle},"Shares"),a.createElement("div",{style:{display:"flex"}},a.createElement(M.D,{width:E.tq?"100%":"45%",fieldLabel:"Positions",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===s||void 0===s||null===(t=s.shared_positions)||void 0===t?void 0:t.length)>0&&a.createElement(Z.default,{withColumns:!1,className:u.sharesTable,columns:["Position"],list:null===s||void 0===s||null===(i=s.shared_positions)||void 0===i?void 0:i.map((function(e){var n=null===c||void 0===c?void 0:c.find((function(n){return n.value===e.id}));return(0,l.Z)({},"Position",null===n||void 0===n?void 0:n.label)}))})),a.createElement(M.D,{width:E.tq?"100%":"45%",fieldLabel:"Users",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===s||void 0===s||null===(d=s.shared_users)||void 0===d?void 0:d.length)>0&&a.createElement(Z.default,{withColumns:!1,className:u.sharesTable,columns:["User"],list:null===s||void 0===s||null===(r=s.shared_users)||void 0===r?void 0:r.map((function(e){var n=null===v||void 0===v?void 0:v.find((function(n){return n.id===e.id}));return(0,l.Z)({},"User","".concat(null===n||void 0===n?void 0:n.first_name," ").concat(null===n||void 0===n?void 0:n.last_name))}))})))))},Qe=a.forwardRef((function(e,n){var o,l,r,s,c,v,p=e.begunModule,m=e.allModules,f=e.companyData,_=e.selectedComponent,y=e.setSelectedComponent,h=e.companyUsersArray,g=e.companyPositionsArray,b=e.print,M=e.components,C=void 0===M?[]:M,w=e.bypassCustom,S=void 0!==w&&w,Z=e.authenticatedUser,x=e.setIsOpen,k=void 0===x?function(){}:x,I=(0,a.useState)([]),D=(0,d.Z)(I,2),N=D[0],O=D[1],T=null===p||void 0===p||null===(o=p.processModule)||void 0===o||null===(l=o.steps)||void 0===l||null===(r=l.find((function(e){return e.component_blueprints.filter((function(e){var n;return null===(n=e.selected_fields)||void 0===n?void 0:n.find((function(e){return"Template"===e.data_type_name}))})).length>0})))||void 0===r||null===(s=r.component_blueprints)||void 0===s||null===(c=s.find((function(e){var n;return(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Template"===e.data_type_name&&!0===e.visible})).length)>0})))||void 0===c||null===(v=c.selected_fields)||void 0===v?void 0:v.find((function(e){return"Template"===e.data_type_name})),q=function(){var e,n,o,l,i=null===p||void 0===p||null===(e=p.processModule)||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.find((function(e){return e.component_blueprints.filter((function(e){var n,o;return(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find((function(e){return"Transaction List"===e.data_type_name})))})).length>0})),d=null===i||void 0===i||null===(o=i.component_blueprints)||void 0===o?void 0:o.find((function(e){var n;return(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Transaction List"===e.data_type_name&&!0===e.visible})).length)>0}));return a.createElement(fe.ij,{selectedComponent:_,templateName:null===T||void 0===T?void 0:T.field_name,component_blueprint:d,template:T,companyUsersArray:h,begunModule:p,companyData:f,authenticatedUser:Z},d&&a.createElement(ve,{key:0,field:null===(l=d.selected_fields)||void 0===l?void 0:l.find((function(e){return"Transaction List"===e.data_type_name})),selectedComponent:_,companyUsersArray:h,component:(0,t.Z)((0,t.Z)({},d),{},{created_date:_.created_date,values:[]})}))};return(0,a.useEffect)((function(){var o,l,d,r=[];if(qe.Z(Ae.Z("group"))(null!==(o=null===_||void 0===_?void 0:_.component_fields)&&void 0!==o?o:[]).map((function(e){r=[].concat((0,i.Z)(r),[{id:e.component_blueprint_id,selected_fields:Ye.Z(P.Z("group",e.group))(_.component_fields)}])})),(null===p||void 0===p||null===(l=p.processModule)||void 0===l||null===(d=l.completeSteps)||void 0===d?void 0:d.length)>0){var s,c,v,M,w,x,I,D,N,T,A,U,Y,R,L,B,F,z=[a.createElement("div",{key:0,style:{display:null!==e&&void 0!==e&&e.noHeader?"none":"",height:"auto",padding:"20px"}},b&&(null!==f&&void 0!==f&&f.logo?a.createElement("img",{className:u.imageLogoPrint,alt:"lg",onError:function(e){return e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg"},src:null!==(s=null===f||void 0===f?void 0:f.logo)&&void 0!==s?s:"https://i.quotev.com/b2gtjqawaaaa.jpg"}):a.createElement("div",{style:{padding:"20px"}},(0,j.lh)("30px","var(--app-color-gray-dark)","bold"),a.createElement("div",{style:{fontSize:"12px",fontWeight:"normal",fontFamily:"var(--app-text-main-font)"}},null===f||void 0===f||null===(c=f.display_name)||void 0===c?void 0:c.toUpperCase())))),q()];if(p.processModule.completeSteps.map((function(e){e.component_blueprints.filter((function(e){var n,o;return 0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asModuleList)||void 0==(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.asModuleList)})).map((function(n,o){var l,d,u,s,c,v,y=null!==(l=null===_||void 0===_||null===(d=_.component_fields)||void 0===d?void 0:d.filter((function(e){return e.component_blueprint_id===n.id})))&&void 0!==l?l:[];null===y||void 0===y||y.find((function(e){return!(""===e.value||void 0===e.value||null===e.value)}));(null===y||void 0===y?void 0:y.length)>0&&(null===(u=n.selected_fields)||void 0===u?void 0:u.filter((function(e){return 1==e.visible})).length)>0&&(z=null!==n.options?[].concat((0,i.Z)(z),[a.createElement("div",{key:z.length,style:{display:""}},a.createElement(re,{setIsOpen:k,step:e,isInherited:!1,nextButtonClicked:function(){},isMandatoryError:!1,stepId:e.id,blueprintIndex:o,setIsMandatoryError:function(){},component:(0,t.Z)((0,t.Z)({},n),{},{created_date:_.created_date,values:null!==(s=null===(c=r.find((function(e){return e.id===n.id})))||void 0===c?void 0:c.selected_fields)&&void 0!==s?s:[]}),begunModule:p,allModules:m,companyData:f,components:r,allComponents:C,companyUsersArray:h,selectedComponent:_}))]):[].concat((0,i.Z)(z),[a.createElement("div",{key:z.length},a.createElement(re,{setIsOpen:k,step:e,isInherited:!1,nextButtonClicked:function(){},isMandatoryError:!1,stepId:e.id,blueprintIndex:o,setIsMandatoryError:function(){},component:(0,t.Z)((0,t.Z)({},n),{},{created_date:_.created_date,values:null===(v=r.find((function(e){return e.id===n.id})))||void 0===v?void 0:v.selected_fields}),begunModule:p,allModules:m,companyData:f,components:r,allComponents:C,companyUsersArray:h,selectedComponent:_}))]))}))})),null!==p&&void 0!==p&&null!==(v=p.processModule)&&void 0!==v&&null!==(M=v.completeSteps)&&void 0!==M&&M.find((function(e){var n;return(null===(n=e.component_blueprints)||void 0===n?void 0:n.filter((function(e){return e.selected_fields.filter((function(e){return"Template"===e.data_type_name})).length>0})).length)>0&&0==S})))O(a.createElement(fe.C6,{ref:n,print:b,begunModule:p,allModules:m,companyData:f,components:C,selectedComponent:_,setSelectedComponent:y,companyUsersArray:h,companyPositionsArray:g,payments:a.createElement(ce,{component:_}),creator:a.createElement(se,{component:_,show:null===p||void 0===p||null===(w=p.processModule)||void 0===w||null===(x=w.module)||void 0===x||null===(I=x.options)||void 0===I?void 0:I.anonymous,process:null===p||void 0===p?void 0:p.processModule}),shares:(null===p||void 0===p||null===(D=p.processModule)||void 0===D||null===(N=D.module)||void 0===N||null===(T=N.options)||void 0===T?void 0:T.forSpecificUsers)&&a.createElement(He,{key:z.length+3,selectedComponent:_,companyUsersArray:h,companyPositionsArray:g})},z));else O([a.createElement("div",{style:{display:E.tq?"none":"flex",width:"100%",alignContent:"space-between"}},a.createElement("div",{className:u.cardTitle,style:{fontSize:"18px",padding:"10px 0",width:"100%"}},_.status&&"None"!==_.status&&a.createElement(a.Fragment,null,a.createElement("span",{style:{fontWeight:"normal",fontSize:"16px"}},"Status : ")," ",_.status)),",",a.createElement("label",{className:u.checkboxLabelClass},"Show all fields?",a.createElement("input",{type:"checkbox",defaultChecked:null===_||void 0===_?void 0:_.show,onChange:function(e){y((0,t.Z)((0,t.Z)({},_),{},{show:e.target.checked}))}})))].concat((0,i.Z)(z),[a.createElement(ce,{component:_,key:z.length+1}),(null===p||void 0===p||null===(A=p.processModule)||void 0===A||null===(U=A.module)||void 0===U||null===(Y=U.options)||void 0===Y?void 0:Y.forSpecificUsers)&&(null===Z||void 0===Z?void 0:Z.id)===(null===(R=_.created_by)||void 0===R?void 0:R.id)&&a.createElement(He,{key:z.length+2,selectedComponent:_,companyUsersArray:h,companyPositionsArray:g}),a.createElement(se,{component:_,key:z.length+3,show:null===p||void 0===p||null===(L=p.processModule)||void 0===L||null===(B=L.module)||void 0===B||null===(F=B.options)||void 0===F?void 0:F.anonymous,process:null===p||void 0===p?void 0:p.processModule})]))}}),[_,b]),a.createElement("div",{ref:n,style:{padding:b?"50px 0px 50px 0px":"20px",alignSelf:"center",backgroundColor:"white",margin:"auto",width:E.tq?"100%":(0,fe.ev)(null===T||void 0===T?void 0:T.field_name)}},N,e.children)})),Ke=(0,s.$j)((function(e){var n=e.flowReducer,o=n.begunModule,l=n.allModules,t=n.companyData,i=n.components,d=n.rememberPath,a=n.lastUpdates,u=n.companyUsersArray,r=n.products,s=n.transactions,c=n.companyProcesses,v=n.companyPositionsArray,p=n.cart,m=n.blueprints,f=n.allTasks,_=n.axiosAbort;return{begunModule:o,allModules:l,companyData:t,components:i,rememberPath:d,lastUpdates:a,companyUsersArray:u,products:r,transactions:s,companyProcesses:c,authenticatedUser:e.authReducer.authenticatedUser,companyPositionsArray:v,cart:p,blueprints:m,allTasks:f,axiosAbort:_}}),(function(e){return{onSetSelectedProcess:function(n){return e((0,_.Xu)(n))}}}))((function(n){var o,s,b,M,C,w,N,q,Y,R,F,z,V,W,G,J,X,H,Q,K,$,ee,ne,oe,le,te,ie,de,ue,re,se,ce,ve,pe,me,ye,be,Me,Ee,Ce,we,Se,Ge,He,Ke,$e,en,nn,on,ln,tn,dn,an,un,rn,sn,cn,vn,pn,mn,fn,_n,yn,hn,gn,bn,Mn,En,Cn,wn,Sn,Zn,xn,kn,In,Dn,Nn,Pn,On,Tn,qn,An,Un,Yn,Rn,Ln,Bn,jn,Fn,zn,Vn,Wn,Gn,Jn,Xn,Hn,Qn,Kn,$n,eo,no,oo,lo,to,io,ao,uo,ro,so,co,vo,po,mo,fo=n.navigateTo,_o=n.begunModule,yo=n.allModules,ho=n.companyData,go=n.components,bo=n.isEditing,Mo=n.lastUpdates,Eo=n.companyUsersArray,Co=n.products,wo=n.onSetSelectedProcess,So=n.children,Zo=n.authenticatedUser,xo=n.companyPositionsArray,ko=n.cart,Io=n.blueprints,Do=n.paymentID,No=n.companyProcesses,Po=n.allTasks,Oo=(n.axiosAbort,(0,a.useState)(1)),To=(0,d.Z)(Oo,1)[0],qo=(0,a.useState)(!1),Ao=(0,d.Z)(qo,2),Uo=Ao[0],Yo=Ao[1],Ro=(0,a.useState)(!1),Lo=(0,d.Z)(Ro,2),Bo=Lo[0],jo=Lo[1],Fo=(0,a.useState)(""),zo=(0,d.Z)(Fo,2),Vo=zo[0],Wo=zo[1],Go=(0,a.useState)(!1),Jo=(0,d.Z)(Go,2),Xo=Jo[0],Ho=Jo[1],Qo=(0,g.pQ)(),Ko=(0,d.Z)(Qo,2),$o=Ko[0],el=Ko[1],nl=(0,a.useState)(!1),ol=(0,d.Z)(nl,2),ll=ol[0],tl=ol[1],il=(0,a.useState)(1==(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o?void 0:o.isUpdating)),dl=(0,d.Z)(il,2),al=dl[0],ul=dl[1],rl=(0,a.useState)(null!==(s=null===_o||void 0===_o||null===(b=_o.processModule)||void 0===b?void 0:b.selectedComponent)&&void 0!==s?s:{}),sl=(0,d.Z)(rl,2),cl=sl[0],vl=sl[1],pl=(0,a.useState)(null===(M=null===cl||void 0===cl?void 0:cl.is_complete)||void 0===M||M),ml=(0,d.Z)(pl,2),fl=ml[0],_l=ml[1],yl=(0,a.useState)([]),hl=(0,d.Z)(yl,2),gl=hl[0],bl=hl[1],Ml=(0,a.useState)([]),El=(0,d.Z)(Ml,2),Cl=El[0],wl=El[1],Sl=(0,a.useState)(!1),Zl=(0,d.Z)(Sl,2),xl=Zl[0],kl=Zl[1],Il=(0,a.useState)(!1),Dl=(0,d.Z)(Il,2),Nl=Dl[0],Pl=Dl[1],Ol=(0,a.useState)(!1),Tl=(0,d.Z)(Ol,2),ql=Tl[0],Al=Tl[1],Ul=(0,a.useState)(!1),Yl=(0,d.Z)(Ul,2),Rl=Yl[0],Ll=Yl[1],Bl=(0,a.useState)(!1),jl=(0,d.Z)(Bl,2),Fl=jl[0],zl=jl[1],Vl=(0,a.useState)(!1),Wl=(0,d.Z)(Vl,2),Gl=Wl[0],Jl=Wl[1],Xl=(0,a.useState)(!1),Hl=(0,d.Z)(Xl,2),Ql=Hl[0],Kl=Hl[1],$l=(0,a.useState)(!1),et=(0,d.Z)($l,2),nt=et[0],ot=et[1],lt=(0,a.useState)(!1),tt=(0,d.Z)(lt,2),it=tt[0],dt=tt[1],at=(0,a.useState)(!1),ut=(0,d.Z)(at,2),rt=ut[0],st=ut[1],ct=(0,a.useState)([]),vt=(0,d.Z)(ct,2),pt=vt[0],mt=vt[1],ft=(0,a.useState)([]),_t=(0,d.Z)(ft,2),yt=_t[0],ht=_t[1],gt=(0,a.useState)([]),bt=(0,d.Z)(gt,2),Mt=bt[0],Et=bt[1],Ct=(0,a.useState)({list:[],operator:"AND"}),wt=(0,d.Z)(Ct,2),St=wt[0],Zt=wt[1],xt=(0,a.useState)([]),kt=(0,d.Z)(xt,2),It=kt[0],Dt=kt[1],Nt=(0,a.useState)([]),Pt=(0,d.Z)(Nt,2),Ot=Pt[0],Tt=Pt[1],qt=(0,a.useState)(!1),At=(0,d.Z)(qt,2),Ut=At[0],Yt=At[1],Rt=(0,a.useState)(!1),Lt=(0,d.Z)(Rt,2),Bt=Lt[0],jt=Lt[1],Ft=(0,a.useState)(!1),zt=(0,d.Z)(Ft,2),Vt=zt[0],Wt=zt[1],Gt=(0,a.useState)(!1),Jt=(0,d.Z)(Gt,2),Xt=Jt[0],Ht=Jt[1],Qt=(0,a.useState)("false"!==localStorage.getItem("showAds")&&(null!==(C=U()(+localStorage.getItem("showAdsDate")).format("DD MMM YYYY")!==U()((0,A.now)()).format("DD MMM YYYY"))&&void 0!==C&&C)),Kt=(0,d.Z)(Qt,2),$t=Kt[0],ei=Kt[1],ni=(0,a.useState)(1),oi=(0,d.Z)(ni,2),li=(oi[0],oi[1],(0,ae.s0)()),ti=(null===_o||void 0===_o||null===(w=_o.processModule)||void 0===w||null===(N=w.steps)||void 0===N?void 0:N.length)>0?null===_o||void 0===_o||null===(q=_o.processModule)||void 0===q?void 0:q.steps[_o.processModule.stepIndex]:{},ii=(null===_o||void 0===_o||null===(Y=_o.processModule)||void 0===Y||null===(R=Y.steps)||void 0===R?void 0:R.length)>0?null===(F=_o.processModule.steps[_o.processModule.stepIndex])||void 0===F?void 0:F.pathway_steps:[],di=(null===_o||void 0===_o||null===(z=_o.processModule)||void 0===z||null===(V=z.steps)||void 0===V?void 0:V.length)>0?null===(W=_o.processModule.steps[_o.processModule.stepIndex])||void 0===W?void 0:W.pathway_processes:[],ai=(0,a.useRef)();(0,a.useEffect)((function(){var e=Eo.filter((function(e){return 0==e.departments.length})).map((function(e){return{label:"".concat(e.first_name," ").concat(e.last_name),value:e.id,department:"General",user:e}}));Eo.filter((function(e){return e.departments.length>0})).filter((function(n){n.departments.filter((function(o){e=[].concat((0,i.Z)(e),[{label:"".concat(n.first_name," ").concat(n.last_name),value:n.id,department:null===o||void 0===o?void 0:o.name,user:n}])}))})),Dt(e)}),[Eo]),(0,a.useEffect)((function(){var e,n;if((null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.length)>0&&!rt){var o,l;Zt({list:[],operator:"AND"}),void 0!==(null===fo||void 0===fo?void 0:fo.key)?mt(_i(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l?void 0:l.id,go,fo.value,fo.key)):mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})));var t={id:""},i=[],d=[];Pe.Z((function(e){e.component_fields.map((function(n){var o,l;e.procedure_id!==(null===Je||void 0===Je?void 0:Je.id)&&(null!==(o=t=No.find((function(n){return n.id===e.procedure_id})))&&void 0!==o&&o.steps&&(i=Ne.Z(T.Z("component_blueprints"),O.Z)(null===(l=t)||void 0===l?void 0:l.steps),d=Ne.Z(T.Z("selected_fields"),O.Z)(i)));var a,u=d.find((function(e){return e.procedure_step_blueprint_field_id===n.procedure_step_blueprint_field_id}));u&&(n.data_type_name=u.data_type_name,n.data_type=u.data_type,n.field_name=u.field_name,n.options=u.options,n.component_blueprint_id=null===(a=i.find((function(e){return e.selected_fields.filter((function(e){return e.procedure_step_blueprint_field_id===n.procedure_step_blueprint_field_id})).length>0})))||void 0===a?void 0:a.id)}))}),go.filter((function(e){var n;return(null!==(n=null===e||void 0===e?void 0:e.component_fields)&&void 0!==n?n:[]).filter((function(e){return void 0===(null===e||void 0===e?void 0:e.field_name)})).length>0})))}}),[null===_o||void 0===_o||null===(G=_o.processModule)||void 0===G?void 0:G.steps,go]),(0,a.useEffect)((function(){if(Do){var e,n,o=JSON.parse(localStorage.getItem("forPayment")),l=null===(e=o.component_fields)||void 0===e?void 0:e.find((function(e){return"Payments"===e.data_type_name}));if(l)if(2===(null===(n=o.component_fields)||void 0===n?void 0:n.filter((function(e){return e.field_name===l.options.paymentField||e.value===Do})).length)){var t,i,d,a,u,r=null===(t=o.component_fields)||void 0===t?void 0:t.find((function(e){return e.field_name===l.options.paymentField}));Pl(!0),(0,Be.e_)({user_id:Zo.id,id:o.id,total:null!==(i=+(null===r||void 0===r?void 0:r.value))&&void 0!==i?i:0,product:"CR-".concat(null!==(d=null===o||void 0===o?void 0:o.title)&&void 0!==d?d:null===_o||void 0===_o||null===(a=_o.processModule)||void 0===a||null===(u=a.module)||void 0===u?void 0:u.name," ").concat(Do),notes:"E-Payment",quantity:1}).pipe((0,y.P)()).subscribe({next:function(e){Pl(!1),dt(!0),(0,v.tE)(null===o||void 0===o?void 0:o.id,"Paid").pipe((0,y.P)()).subscribe({next:function(e){localStorage.removeItem("forPayment"),_o.processModule.selectedComponent=e,vl(e)}})}})}else Pl(!1),f.h.dispatch((0,_.Xc)({show:!0,message:"Payment #".concat(Do," was received but transaction was not matched, please report this to your administrator"),color:"red",bottom:!0}))}}),[Do]),(0,a.useEffect)((function(){var e,n,o,l;(null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.length)>0&&!rt&&(void 0!==fo.key||""!==fo.key)&&mt(_i(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l?void 0:l.id,go,fo.value))}),[fo]),(0,a.useEffect)((function(){var e,n,o,l,t;null!==_o&&void 0!==_o&&null!==(e=_o.processModule)&&void 0!==e&&null!==(n=e.selectedComponent)&&void 0!==n&&n.id&&cl.id!==(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.selectedComponent)||void 0===l?void 0:l.id)&&vl(null===_o||void 0===_o||null===(t=_o.processModule)||void 0===t?void 0:t.selectedComponent)}),[null===_o||void 0===_o||null===(J=_o.processModule)||void 0===J?void 0:J.selectedComponent]),(0,a.useEffect)((function(){localStorage.getItem("transaction")&&!ll&&localStorage.getItem("transaction")===cl.id&&Wt(!0)}),[cl,ll]);var ui=(0,a.useCallback)((function(){var e=!1;return ti.component_blueprints.filter((function(e){var n,o;return null===e.options||(!1===(null===(n=e.options)||void 0===n?void 0:n.allowMultipleInputs)||void 0===(null===(o=e.options)||void 0===o?void 0:o.allowMultipleInputs))})).some((function(e){var n;return!0===(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Summary"!==e.data_type_name&&"Profile"!==e.data_type_name&&"ID"!==e.data_type_name&&"Info"!==e.data_type_name&&"Notes"!==e.data_type_name&&"URL"!==e.data_type_name&&"Emails"!==e.data_type_name&&"Template"!==e.data_type_name&&"Global"!==e.data_type_name&&"Chart"!==e.data_type_name&&"Value"!==e.data_type_name})).some((function(e){var n;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.length)<1)})))}))&&(console.log("with manadatory errors",ti.component_blueprints),e=!0),!0===e?(jo(!0),!0):(Wo(""),jo(!1),!1)}),[ti]),ri=function(e){Ho(!0),ui()&&!1===al?fi():ci(e)},si=function(e){$o.components=[],$o.items=[],$o.currentStep={},$o.newStepComponents=[],_o.processModule.steps.filter((function(e){return e.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return e.value=void 0}))}))})),_o.processModule.isUpdating=!1,f.h.dispatch((0,_.wM)({routes:{},pins:""})),ul(!1),tl(!1),Ho(!0),ci(e),ho.start=!1,(0,m.aK)().pipe((0,y.P)()).subscribe({next:function(){}})},ci=function(e){Ho(!1),jo(!1),Yo(!1);var n={};if(void 0===e){if(void 0===(n=_o.processModule.steps[_o.processModule.stepIndex+1]))return void f.h.dispatch((0,_.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));el({action:g._U.setCurrentStep,value:n}),f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{stepIndex:_o.processModule.stepIndex+1})))}else{if(void 0==(n=_o.processModule.steps.find((function(n){return n.id===e}))))n=_o.processModule.steps[_o.processModule.stepIndex+1],f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{stepIndex:_o.processModule.stepIndex+1})));else{var o,l,d=_o.processModule.steps[(null===(o=n)||void 0===o?void 0:o.rank)-1];if(void 0===d)return void f.h.dispatch((0,_.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{stepIndex:(null===(l=n)||void 0===l?void 0:l.rank)-1})))}el({action:g._U.setCurrentStep,value:n})}var a=$o.newStepComponents.filter((function(e){return null===e.options||(void 0===e.allowMultipleInputs||!1===e.options.allowMultipleInputs)}));el({action:g._U.setComponents,value:[].concat((0,i.Z)($o.components.filter((function(e){return a.every((function(n){return n.id!==e.id}))}))),(0,i.Z)(Oe.Z((function(e){return e.selected_fields.filter((function(e){return""===e.value})).length>0}),a)))}),el({action:g._U.setModuleNewStepComponents,value:n.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"Status"===e.data_type_name||"ID"===e.data_type_name||"Value"===e.data_type_name})).length>0}))})},vi=function(){el({action:g._U.setModuleItems,value:[]}),el({action:g._U.setComponents,value:[]}),el({action:g._U.addModuleComponents,value:[]}),el({action:g._U.setModuleNewStepComponents,value:[]}),si(_o.processModule.steps[0].id)},pi=function(){var e,n,o,l,d,a,u,r,s,c,p,m,h,g,b,M;if(ui())return Wo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),void Yo(!1);var E,C,w=$o.newStepComponents,S=[].concat((0,i.Z)($o.components.filter((function(e){return w.every((function(n){return n.id!==e.id}))}))),(0,i.Z)(Oe.Z((function(e){var n;return e.selected_fields.filter((function(e){return""===e.value||null===e.value||!(null!==e&&void 0!==e&&e.value)})).length===(null===(n=e.selected_fields)||void 0===n?void 0:n.length)}),w))),Z=[],x=[],k="",I="",D=!1,N=al?null===cl||void 0===cl?void 0:cl.status:"None",P=[],O=null===cl||void 0===cl?void 0:cl.status,q={},A=al?(null!==(e=Te.Z(Math.max,T.Z("group",qe.Z(Ae.Z("group"))(null!==(n=null===cl||void 0===cl?void 0:cl.component_fields)&&void 0!==n?n:[]))))&&void 0!==e?e:-1)+1:0;S.map((function(e,n){var o,l,d=n,a=null===(o=e.selected_fields.filter((function(e){return"Record"===e.data_type_name||"Filters"===e.data_type_name})))||void 0===o?void 0:o.find((function(e){return+(null===e||void 0===e?void 0:e.group)>=0}));a&&al?d=a.group:al&&(d=A,A++),e.selected_fields.filter((function(e){return("Record"===e.data_type_name||"Filters"===e.data_type_name)&&!0===e.visible})).map((function(e,n){var o;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){var l,a;x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,group:d})]),k=e.value,q[e.field_name]=e.value;var u=null===(l=go.find((function(n){return n.component_fields.filter((function(n){var o;return n.component_blueprint_id===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.component_id)&&(null===n||void 0===n?void 0:n.value)===k})).length>0})))||void 0===l||null===(a=l.component_fields.find((function(e){return"Email Recipient"===e.data_type_name})))||void 0===a?void 0:a.value;u&&(E=u)}}));var u=null===(l=e.selected_fields.filter((function(e){return!("Record"===e.data_type_name||"Filters"===e.data_type_name)})))||void 0===l?void 0:l.find((function(e){return+(null===e||void 0===e?void 0:e.group)>=0}));u&&al?d=u.group:al&&(d=A,A++),e.selected_fields.filter((function(e){return!("Record"===e.data_type_name||"Filters"===e.data_type_name||"Module"===e.data_type_name)})).map((function(e,n){var o,l,a,u;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){if(q[e.field_name]=e.value,"ID"===(null===e||void 0===e?void 0:e.data_type_name))null!==_o&&void 0!==_o&&null!==(a=_o.processModule)&&void 0!==a&&a.isUpdating?x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,group:d})]):(x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,group:d,value:"".concat(null===e||void 0===e?void 0:e.options.id).concat(null===(null===ho||void 0===ho?void 0:ho.misc_info)?1:null!==(u=null===ho||void 0===ho?void 0:ho.misc_info[null===e||void 0===e?void 0:e.field_name])&&void 0!==u?u:1)})]),Z=[].concat((0,i.Z)(Z),["".concat(e.field_name)]));else if("Value"===(null===e||void 0===e?void 0:e.data_type_name)){var r;x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:null===e||void 0===e||null===(r=e.options)||void 0===r?void 0:r.value,group:d})])}else if("Email Recipient"===(null===e||void 0===e?void 0:e.data_type_name))x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:e.value.replace(/ /g,""),group:d})]);else if("Product Lookup"===e.data_type_name)x=(0,i.Z)(x);else if("Status"===e.data_type_name&&"Draft"===e.value&&1==fl)D=!0,x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:"New",group:d})]),N="New";else if("Status"===e.data_type_name)x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:null===e||void 0===e?void 0:e.value,group:d})]),N=null===e||void 0===e?void 0:e.value;else if("Positions"===e.data_type_name&&!0===(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.share))x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:null===e||void 0===e?void 0:e.value,group:d})]),P=[null===e||void 0===e?void 0:e.value];else if("Formula"===e.data_type_name){var s,c=null!==_o&&void 0!==_o&&null!==(s=_o.processModule)&&void 0!==s&&s.isUpdating?(0,j.LV)(null===e||void 0===e?void 0:e.options,cl.component_fields.filter((function(n){var o;return null===(o=e.options)||void 0===o?void 0:o.list.includes(n.field_name)})),S,$o.items):e.value;x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:c.toString(),group:d})])}else if("output"!==e.data_type){var v,p,m,f;if("People"===e.data_type_name){var _,y,h,g;if(!0===(null===(_=e.options)||void 0===_?void 0:_.email)){var b,M,w=null===(b=It.find((function(n){return n.label===(null===e||void 0===e?void 0:e.value)})))||void 0===b||null===(M=b.user)||void 0===M?void 0:M.email;I=w?I.concat(I.length>0?",".concat(w):w):I,e.email=void 0}if(!0===(null===(y=e.options)||void 0===y?void 0:y.assign))C=null===(h=It.find((function(n){return n.label===(null===e||void 0===e?void 0:e.value)})))||void 0===h||null===(g=h.user)||void 0===g?void 0:g.id,al&&(cl.assigned_to={id:C})}"email"===(null===e||void 0===e||null===(v=e.options)||void 0===v?void 0:v.actionToPerform2)&&null!==e&&void 0!==e&&null!==(p=e.options)&&void 0!==p&&null!==(m=p.valueToMatch2)&&void 0!==m&&null!==(f=m.split(","))&&void 0!==f&&f.includes(null===e||void 0===e?void 0:e.value)&&E&&(D=!0,I=I.concat(I.length>0?",".concat(E):E)),x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,group:d})])}}else if("Status"===(null===e||void 0===e?void 0:e.data_type_name))1==fl?(x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:"New",group:d})]),N="New"):(x=[].concat((0,i.Z)(x),[(0,t.Z)((0,t.Z)({},e),{},{index:n,value:"Draft",group:d})]),N="Draft"),q[e.field_name]=e.value;else if("Action Button"===(null===e||void 0===e?void 0:e.data_type_name)){var k,O,T;x=(0,i.Z)(x),q[e.field_name]=e.value,"status"===(null===e||void 0===e||null===(k=e.options)||void 0===k?void 0:k.action)?N=e.value:"user"!==(null===(O=e.options)||void 0===O?void 0:O.action)&&"creator"!==(null===(T=e.options)||void 0===T?void 0:T.action)||(cl.assigned_to=null===e||void 0===e?void 0:e.value)}}))}));var Y,R,L,B="";if((null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l||null===(d=l.options)||void 0===d||null===(a=d.title)||void 0===a?void 0:a.length)>0){var F,z,V,W,G,J,X,H,Q,K,$,ee,ne,oe,le;if(null===(F=_o.processModule)||void 0===F||null===(z=F.module)||void 0===z||null===(V=z.options)||void 0===V||null===(W=V.title)||void 0===W||W.map((function(e){if("Info"!==e){var n,o,l,t,i=x.find((function(n){return n.field_name===e}));if("Date"===(null===i||void 0===i?void 0:i.data_type_name)||"Calendar"===(null===i||void 0===i?void 0:i.data_type_name))B=""===B?"".concat(U()(null===i||void 0===i?void 0:i.value).format("DD MMMM YYYY")):"".concat(null!==(n=B)&&void 0!==n?n:"","  ").concat(U()(null===i||void 0===i?void 0:i.value).format("DD MMMM YYYY"));else B=""===B?"".concat(null!==(o=null===i||void 0===i?void 0:i.value)&&void 0!==o?o:""):"".concat(null!==(l=B)&&void 0!==l?l:"","  ").concat(null!==(t=null===i||void 0===i?void 0:i.value)&&void 0!==t?t:"")}else{var d=_o.processModule.steps.find((function(e){var n;return(null===(n=e.component_blueprints.filter((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Info"===e.data_type_name})))||void 0===n?void 0:n.length)>0})))||void 0===n?void 0:n.length)>0}));if(void 0!==d){var a,u,r,s,c,v,p,m,f,_=null===(a=d.component_blueprints)||void 0===a||null===(u=a.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Info"===e.data_type_name})))||void 0===n?void 0:n.length)>0})).selected_fields)||void 0===u?void 0:u.find((function(e){return"Info"===e.data_type_name})),y=go.find((function(e){var n;return(null===(n=e.component_fields.filter((function(e){var n;return e.component_blueprint_id===_.options.component_id&&(e.value===q[_.field_name]||e.value===q[null===(n=_.options)||void 0===n?void 0:n.key])})))||void 0===n?void 0:n.length)>0}));if(y)if((null===_||void 0===_||null===(r=_.options)||void 0===r||null===(s=r.list)||void 0===s?void 0:s.length)>0)B=""===B?"".concat(null!==(c=null===(v=y.component_fields.find((function(e){var n;return e.field_name===(null===_||void 0===_||null===(n=_.options)||void 0===n?void 0:n.list[0])})))||void 0===v?void 0:v.value)&&void 0!==c?c:""):"".concat(null!==(p=B)&&void 0!==p?p:"","  ").concat(null!==(m=null===(f=y.component_fields.find((function(e){var n;return e.field_name===(null===_||void 0===_||null===(n=_.options)||void 0===n?void 0:n.list[0])})))||void 0===f?void 0:f.value)&&void 0!==m?m:"")}}})),null!==(G=_o.processModule)&&void 0!==G&&null!==(J=G.module)&&void 0!==J&&null!==(X=J.options)&&void 0!==X&&X.title.find((function(e){return"UUID"===e})))B="".concat(null===($=_o.processModule)||void 0===$||null===(ee=$.module)||void 0===ee?void 0:ee.name," #").concat(al?cl.id.replace(/\D/g,"").slice(-5):(0,j.mR)().replace(/\D/g,"").slice(-5));if(null!==(H=_o.processModule)&&void 0!==H&&null!==(Q=H.module)&&void 0!==Q&&null!==(K=Q.options)&&void 0!==K&&K.title.find((function(e){return"Module Name"===e})))B=" ".concat(null===(ne=_o.processModule)||void 0===ne||null===(oe=ne.module)||void 0===oe?void 0:oe.name," - ").concat(null!==(le=B)&&void 0!==le?le:"")}else{var te,ie;B="".concat(null===(te=_o.processModule)||void 0===te||null===(ie=te.module)||void 0===ie?void 0:ie.name," #").concat(al?cl.id.replace(/\D/g,"").slice(-5):(0,j.mR)().replace(/\D/g,"").slice(-5))}var de,ae,ue,re,se,ce,ve,pe,me,fe,_e,ye,he,ge,be,Me,Ee,Ce,we,Se,Ze,xe,ke,Ie,De,Ne,Pe,Ue={};if(!0===(null===(u=_o.processModule)||void 0===u||null===(r=u.module)||void 0===r||null===(s=r.options)||void 0===s?void 0:s.emailOutputs)){var Ye,Re,Le,ze,Ve=_o.processModule.steps.find((function(e){var n;return(null===(n=e.component_blueprints.filter((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Info"===e.data_type_name&&1==e.options.email})))||void 0===n?void 0:n.length)>0})))||void 0===n?void 0:n.length)>0}));if(void 0!==Ve){var We,Ge,Je=null===(We=Ve.component_blueprints)||void 0===We||null===(Ge=We.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){var n;return"Info"===e.data_type_name&&1==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.email)})))||void 0===n?void 0:n.length)>0})).selected_fields)||void 0===Ge?void 0:Ge.find((function(e){var n;return"Info"===e.data_type_name&&!0===(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.email)})),Xe=go.find((function(e){var n;return(null===(n=e.component_fields.filter((function(e){return e.component_blueprint_id===Je.options.component_id&&e.value===k})))||void 0===n?void 0:n.length)>0}));Xe&&(R=Je.id,Y=Xe.id)}if(void 0!==(Ve=_o.processModule.steps.find((function(e){var n;return!0===e.is_end&&(null===(n=e.component_blueprints.filter((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Emails"===e.data_type_name})))||void 0===n?void 0:n.length)>0})))||void 0===n?void 0:n.length)>0}))))(null===(Le=Ve.component_blueprints)||void 0===Le?void 0:Le.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Emails"===e.data_type_name})))||void 0===n?void 0:n.length)>0}))).selected_fields.filter((function(e){return"Emails"===e.data_type_name})).filter((function(e){var n;x.find((function(n){return n.value===e.options.valueToMatch&&n.field_name===e.options.fieldToMatch}))&&(E&&(L=e,D=!0,!0===(null===(n=e.options)||void 0===n?void 0:n.copyEmailRecip)&&(I=I.concat(I.length>0?",".concat(E):E))))}));if(I=""===I?[]:null!==(Ye=I.split(","))&&void 0!==Ye?Ye:[],(Ot.length>0||I.length>0)&&(I=al?!0===D?[].concat((0,i.Z)(Ot),(0,i.Z)(I)):(0,i.Z)(Ot):[].concat((0,i.Z)(Ot),(0,i.Z)(I))),I.length>0&&(Ue={emailTo:I}),R&&Y&&(Ue=(0,t.Z)((0,t.Z)({},Ue),{},{info:R,target:Y})),(null===(Re=L)||void 0===Re?void 0:Re.id.length)>0)Ue=(0,t.Z)((0,t.Z)({},Ue),{},{template:null===(ze=L)||void 0===ze?void 0:ze.id})}if(!0===(null===(c=_o.processModule)||void 0===c||null===(p=c.module)||void 0===p||null===(m=p.options)||void 0===m?void 0:m.rewards)&&O!==N){var He,Qe,Ke,$e,en,nn,on=_o.processModule.steps.find((function(e){var n;return(null===(n=e.component_blueprints.filter((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Rewards"===e.data_type_name})))||void 0===n?void 0:n.length)>0})))||void 0===n?void 0:n.length)>0}));if(void 0!==on)if((de=null===(He=on.component_blueprints)||void 0===He||null===(Qe=He.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Rewards"===e.data_type_name})))||void 0===n?void 0:n.length)>0})).selected_fields)||void 0===Qe?void 0:Qe.find((function(e){return"Rewards"===e.data_type_name}))).options.status===N)Zo.options.rewards=+(null!==(Ke=null===Zo||void 0===Zo||null===($e=Zo.options)||void 0===$e?void 0:$e.rewards)&&void 0!==Ke?Ke:0)+ +(null===(en=de)||void 0===en||null===(nn=en.options)||void 0===nn?void 0:nn.points)}null!==(h=_o.processModule)&&void 0!==h&&null!==(g=h.module)&&void 0!==g&&null!==(b=g.options)&&void 0!==b&&b.close&&(N=null!==(ae=null===(ue=_o.processModule)||void 0===ue||null===(re=ue.module)||void 0===re||null===(se=re.options)||void 0===se?void 0:se.lock)&&void 0!==ae?ae:null!==(ce=null===ho||void 0===ho||null===(ve=ho.misc_info)||void 0===ve?void 0:ve.lock)&&void 0!==ce?ce:"Close");(null===(M=x)||void 0===M?void 0:M.length)>0?(Pl(!0),al?(cl.options=Ue,cl.status=N,null!==$o&&void 0!==$o&&$o.assigned_to&&(cl.assigned_to={id:null===$o||void 0===$o?void 0:$o.assigned_to}),(0,v.KL)((0,t.Z)((0,t.Z)({},cl),{},{selected_fields:(0,i.Z)(x),component_items:$o.items}),cl.id,null===cl||void 0===cl||null===(pe=cl.shared_users)||void 0===pe?void 0:pe.map((function(e){return null===e||void 0===e?void 0:e.id})),B,fl,(null===(me=_o.processModule)||void 0===me||null===(fe=me.module)||void 0===fe||null===(_e=fe.options)||void 0===_e||null===(ye=_e.shares)||void 0===ye?void 0:ye.length)>0?[].concat((0,i.Z)(null!==(he=null===(ge=_o.processModule)||void 0===ge||null===(be=ge.module)||void 0===be||null===(Me=be.options)||void 0===Me?void 0:Me.shares)&&void 0!==he?he:[]),(0,i.Z)(P)):[].concat((0,i.Z)(null!==(Ee=null===cl||void 0===cl||null===(Ce=cl.shared_positions)||void 0===Ce?void 0:Ce.map((function(e){return null===e||void 0===e?void 0:e.id})))&&void 0!==Ee?Ee:[]),(0,i.Z)(P))).subscribe({error:function(e){f.h.dispatch((0,_.Xc)({show:!0,message:"Errors found",color:"red"}))},next:function(e){var n,o,l,i,d,a,u;if(_o.processModule.selectedComponent=e,vl(e),$o.id=null===e||void 0===e?void 0:e.id,null!==(n=_o.processModule)&&void 0!==n&&null!==(o=n.module)&&void 0!==o&&null!==(l=o.options)&&void 0!==l&&l.single)return localStorage.setItem(null===(a=_o.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(null===e||void 0===e?void 0:e.data)),void ci(null===(u=_o.processModule.steps[0])||void 0===u?void 0:u.id);var r=x.find((function(e){var n;return"People"===e.data_type_name&&!0===(null===(n=e.options)||void 0===n?void 0:n.calendar)}));if(r){var s,c,v,p=JSON.parse(null!==(s=null===r||void 0===r?void 0:r.value)&&void 0!==s?s:{task:0}),m=Po.find((function(e){return e.id===(null===p||void 0===p?void 0:p.task)}));if(m)(0,Fe.xJ)((0,t.Z)((0,t.Z)({},m),{},{assignee_id:null===e||void 0===e||null===(c=e.data)||void 0===c||null===(v=c.created_by)||void 0===v?void 0:v.id}),null===m||void 0===m?void 0:m.id).pipe((0,y.P)()).subscribe({})}var h,g=x.find((function(e){return"Payments"===e.data_type_name})),b=x.find((function(e){var n;return e.field_name===(null===g||void 0===g||null===(n=g.options)||void 0===n?void 0:n.paymentField)}));if("Closed"!==(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(!g||null!==e&&void 0!==e&&null!==(h=e.data.payments)&&void 0!==h&&h.stripe_id||"Cash"===(null===g||void 0===g?void 0:g.value)||"Wallet"===(null===g||void 0===g?void 0:g.value)||"Points"===(null===g||void 0===g?void 0:g.value))if(g){var M,E,C,w,S,Z;if(b&&"Cash"!==(null===g||void 0===g?void 0:g.value)&&N===(null!==(M=null===(E=_o.processModule)||void 0===E||null===(C=E.module)||void 0===C||null===(w=C.options)||void 0===w?void 0:w.lock)&&void 0!==M?M:null===(S=ho.misc_info)||void 0===S?void 0:S.lock)&&Zo.id===(null===cl||void 0===cl||null===(Z=cl.assigned_to)||void 0===Z?void 0:Z.id)&&O!==N){var k,I,D=+(null===b||void 0===b?void 0:b.value)-+(null===b||void 0===b?void 0:b.value)*+(null!==(k=null===ho||void 0===ho||null===(I=ho.misc_info)||void 0===I?void 0:I.rate)&&void 0!==k?k:.2);(0,Be.e_)({user_id:Zo.id,id:(0,j.mR)(),total:D,product:"CR-".concat(B),notes:"Wallet",quantity:1}).pipe((0,y.P)()).subscribe({next:function(){var e;Zo.wallet=+(+(null!==(e=null===Zo||void 0===Zo?void 0:Zo.wallet)&&void 0!==e?e:0)+D),vi()}})}else de?(0,je.Vy)(Zo,null===Zo||void 0===Zo?void 0:Zo.options).pipe((0,y.P)()).subscribe({next:function(){vi()},error:function(){return f.h.dispatch((0,_.Xc)({show:!0,message:"Errors found",color:"red"}))}}):vi()}else vi();else $o.total=+(null===b||void 0===b?void 0:b.value),$o.plan=+(null===b||void 0===b?void 0:b.value),localStorage.setItem("forPayment",JSON.stringify(e)),jt(!0),Pl(!1);else vi()},complete:function(){Pl(!1)}})):(0,v.LM)({id:S[0].id,selected_fields:(0,i.Z)(x),component_items:$o.items,options:Ue,status:N,assigned_to:null!==(we=null===$o||void 0===$o?void 0:$o.assigned_to)&&void 0!==we?we:C},"",_o.processModule.module_id,gl,B,fl,(null===(Se=_o.processModule)||void 0===Se||null===(Ze=Se.module)||void 0===Ze||null===(xe=Ze.options)||void 0===xe||null===(ke=xe.shares)||void 0===ke?void 0:ke.length)>0?[].concat((0,i.Z)(null!==(Ie=null===(De=_o.processModule)||void 0===De||null===(Ne=De.module)||void 0===Ne||null===(Pe=Ne.options)||void 0===Pe?void 0:Pe.shares)&&void 0!==Ie?Ie:[]),(0,i.Z)(P)):[].concat((0,i.Z)(Cl),(0,i.Z)(P))).subscribe({next:function(e){var n,o,l,i,d,a,u;if(_o.processModule.selectedComponent=e,vl(e),$o.id=null===e||void 0===e?void 0:e.id,null!==(n=_o.processModule)&&void 0!==n&&null!==(o=n.module)&&void 0!==o&&null!==(l=o.options)&&void 0!==l&&l.single)return localStorage.setItem(null===(a=_o.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(e)),void ci(null===(u=_o.processModule.steps[0])||void 0===u?void 0:u.id);Z.length>0&&mi(Z);var r,s,c,v,p=x.find((function(e){var n;return"People"===e.data_type_name&&!0===(null===(n=e.options)||void 0===n?void 0:n.calendar)}));if(p){var m,h,g=JSON.parse(null!==(m=null===p||void 0===p?void 0:p.value)&&void 0!==m?m:{task:0}),b=Po.find((function(e){return e.id===(null===g||void 0===g?void 0:g.task)}));if(b)(0,Fe.xJ)((0,t.Z)((0,t.Z)({},b),{},{assignee_id:null===e||void 0===e||null===(h=e.created_by)||void 0===h?void 0:h.id}),null===b||void 0===b?void 0:b.id).pipe((0,y.P)()).subscribe({})}if("Closed"!==(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(x.filter((function(e){return!("Cash"===(null===e||void 0===e?void 0:e.value)||"Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name})).length>0)localStorage.setItem("forPayment",JSON.stringify(e)),Pl(!1),jt(!0);else if(x.filter((function(e){return("Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name})).length>0){var M,E=x.find((function(e){return"Payments"===e.data_type_name}));(0,Be.e_)({user_id:Zo.id,id:(0,j.mR)(),total:-$o.total,product:"DB-".concat(B),notes:null!==(M=null===E||void 0===E?void 0:E.value)&&void 0!==M?M:"Wallet",quantity:1}).pipe((0,y.P)()).subscribe({next:function(){var n,o;(0,je.Vy)(Zo,(0,t.Z)((0,t.Z)({},null===Zo||void 0===Zo?void 0:Zo.options),{},{points:+(+(null!==(n=null===Zo||void 0===Zo||null===(o=Zo.options)||void 0===o?void 0:o.points)&&void 0!==n?n:0)-("Points"===(null===E||void 0===E?void 0:E.value)?+$o.total:0))})).pipe((0,y.P)()).subscribe({next:function(n){var o,l,t,i;Zo.options=n.options,dt((null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l||null===(t=l.options)||void 0===t||null===(i=t.message)||void 0===i?void 0:i.length)>0&&1==e.is_complete),f.h.dispatch((0,_.RV)({})),vi()}})}})}else{var C,w,S,k;Pl(!1),dt((null===_o||void 0===_o||null===(C=_o.processModule)||void 0===C||null===(w=C.module)||void 0===w||null===(S=w.options)||void 0===S||null===(k=S.message)||void 0===k?void 0:k.length)>0&&1==e.is_complete),f.h.dispatch((0,_.RV)({})),vi()}else Pl(!1),dt((null===_o||void 0===_o||null===(r=_o.processModule)||void 0===r||null===(s=r.module)||void 0===s||null===(c=s.options)||void 0===c||null===(v=c.message)||void 0===v?void 0:v.length)>0&&1==e.is_complete),f.h.dispatch((0,_.RV)({})),vi()},error:function(e){var n,o,l,t;null!==e&&void 0!==e&&e.data&&(f.h.dispatch((0,_.Xc)({show:!0,message:"Errors found",color:"red"})),null!==Z&&mi(Z),dt((null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o||null===(l=o.options)||void 0===l||null===(t=l.message)||void 0===t?void 0:t.length)>0&&1==(null===e||void 0===e?void 0:e.data.is_complete)),f.h.dispatch((0,_.RV)({})),vi())},complete:function(){Pl(!1)}})):(f.h.dispatch((0,_.Xc)({show:!0,message:"There are no items to be saved",color:"red"})),window.scrollTo({top:0,behavior:"smooth"}))},mi=function(e){if((null===e||void 0===e?void 0:e.length)>0){var n,o=null!==(n=ho.misc_info)&&void 0!==n?n:{};e.filter((function(e){var n;o[e]=+(null!==(n=o[e])&&void 0!==n?n:1)+1})),Pl(!0),(0,m.x5)({misc_info:o}).pipe((0,y.P)()).subscribe({})}},fi=function(){Wo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),Yo(!1)},_i=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=n.filter((function(n){return n.module_id===e})).filter((function(e){var n,i;return t.length>0?t.includes(e.id):""===o?e:(null===(n=e.title)||void 0===n?void 0:n.toUpperCase().includes(null===o||void 0===o?void 0:o.toUpperCase()))||(null===(i=e.component_fields.filter((function(e){var n,t,i,d,a,u;return"Record"===e.data_type_name?null===(n=go.find((function(n){var o;return(null===(o=n.component_fields.filter((function(n){return n.field_name===e.options.output&&n.component_blueprint_id===e.options.component_id&&n.value===(null===e||void 0===e?void 0:e.value)})))||void 0===o?void 0:o.length)>0})))||void 0===n||null===(t=n.component_fields.find((function(n){var o;return null===(o=e.options)||void 0===o?void 0:o.names.includes(n.field_name)})).value)||void 0===t?void 0:t.toUpperCase().includes(null===o||void 0===o?void 0:o.toUpperCase()):void 0!==l?("date"===e.data_type?null===(i=U()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===i?void 0:i.format("DD MMM YYYY").includes(o):null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.includes(o))&&e.field_name===l:"date"===e.data_type?null===(a=U()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===a?void 0:a.format("DD MMM YYYY").includes(o):null===e||void 0===e||null===(u=e.value)||void 0===u?void 0:u.toUpperCase().includes(null===o||void 0===o?void 0:o.toUpperCase())})))||void 0===i?void 0:i.length)>0}));return i},yi=function(e){var n,o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt,d=x.Z([D.Z(I.Z("created_date"))])(l.filter((function(e){return e.created_by.id===(null===Zo||void 0===Zo?void 0:Zo.id)?e:"Expired"!==e.status}))).map((function(n){var o,l,t,i,d,r,s,c,v,p,m,f,_,y,h,g,b,M,C={};n.component_fields.filter((function(e){return"output"!==e.data_type})).forEach((function(e){C[e.field_name]=e.value})),e.list.map((function(e){var o=n.component_fields.find((function(n){return n.field_name===e}));if(void 0!=o)if("People"===o.data_type_name)C[e]=o.value;else if("Positions"===o.data_type_name){var l,t;C[e]=null!==(l=null===(t=xo.find((function(e){return e.value===o.value})))||void 0===t?void 0:t.label)&&void 0!==l?l:""}else if("Date"===o.data_type_name){var i,d=new Date(null===o||void 0===o||null===(i=o.value)||void 0===i?void 0:i.split(",")[0]);C[e]=U()(d).format("DD MMM YYYY")}else if("Filters"===o.data_type_name){var a;C[e]=E.tq?"".concat(null===o||void 0===o?void 0:o.value.slice(0,20)):"".concat(null===o||void 0===o?void 0:o.value),null===(a=go.find((function(e){var n;return(null===(n=e.component_fields.filter((function(e){return e.field_name===o.options.output&&e.component_blueprint_id===o.options.component_id&&e.value===(null===o||void 0===o?void 0:o.value)})))||void 0===n?void 0:n.length)>0})))||void 0===a||a.component_fields.filter((function(e){C[e.field_name]=E.tq?e.value.slice(0,20):e.value}))}else if("Status"===o.data_type_name){var u;if(0==n.is_complete)C[e]="Draft";else C[e]="".concat(null!==(u=null===n||void 0===n?void 0:n.status)&&void 0!==u?u:null===o||void 0===o?void 0:o.value)}else{var r;C[e]=E.tq?null===o||void 0===o?void 0:o.value.split(",")[0].slice(0,20):null===o||void 0===o||null===(r=o.value)||void 0===r?void 0:r.split(",")[0]}})),null===e||void 0===e||null===(o=e.com)||void 0===o||null===(l=o.selected_fields)||void 0===l||null===(t=l.filter((function(e){return"Details"===e.data_type_name})))||void 0===t||t.forEach((function(e){var n,o,l,t,i=C[null!==(n=null===(o=e.options)||void 0===o?void 0:o.field)&&void 0!==n?n:e.options.key],d=go.find((function(n){return n.module_id===e.options.module_id&&n.component_fields.find((function(n){return n.field_name===e.options.key&&n.value===i}))}));C[e.field_name]=null===(l=e.options)||void 0===l||null===(t=l.fields.map((function(e){var n,o;return null===d||void 0===d||null===(n=d.component_fields)||void 0===n||null===(o=n.find((function(n){return n.field_name===e})))||void 0===o?void 0:o.value})))||void 0===t?void 0:t.join(" ")})),(null===n||void 0===n||null===(i=n.component_items)||void 0===i?void 0:i.length)>0&&(C["Total Qty"]=n.component_items.reduce((function(e,n){return e+ +n.quantity}),0)),(null===n||void 0===n||null===(d=n.shared_positions)||void 0===d?void 0:d.length)>0&&(C.Shares=null===n||void 0===n?void 0:n.shared_positions.map((function(e){var n;return null===(n=xo.find((function(n){return n.value===e.id})))||void 0===n?void 0:n.label})).toString());var w=new Date(n.created_date);return C.id=n.id,C.ID=n.id,C["Created By"]="".concat(null===n||void 0===n||null===(r=n.created_by)||void 0===r?void 0:r.first_name," ").concat(null===n||void 0===n||null===(s=n.created_by)||void 0===s?void 0:s.last_name),C["Created Date"]=U()(w).format("DD MMM YYYY h:mm a"),C["Assigned To"]="".concat(null!==(c=null===n||void 0===n||null===(v=n.assigned_to)||void 0===v?void 0:v.first_name)&&void 0!==c?c:""," ").concat(null!==(p=null===n||void 0===n||null===(m=n.assigned_to)||void 0===m?void 0:m.last_name)&&void 0!==p?p:""),C.Status=E.tq?null!==(f=null===n||void 0===n?void 0:n.status)&&void 0!==f?f:"-":rt?null===n||void 0===n?void 0:n.status:a.createElement("div",{className:u.statusBox,style:{display:(null!==n&&void 0!==n&&n.status,""),backgroundColor:null!==(_=null===(y=j.MO.find((function(e){return e.value===(null===n||void 0===n?void 0:n.status)})))||void 0===y?void 0:y.color)&&void 0!==_?_:null!==n&&void 0!==n&&n.status?"#3C32AA":" brown",height:"26px",maxWidth:(null===n||void 0===n||null===(h=n.status)||void 0===h?void 0:h.length)>12?"200px":"100px"}},0==n.is_complete?"DRAFT":null!==(g=null===n||void 0===n||null===(b=n.status)||void 0===b?void 0:b.toUpperCase())&&void 0!==g?g:"NONE"),C.Title=n.title,C.items=n.component_items,C[_o.processModule.module.name]=n.title,null===e||void 0===e||null===(M=e.reports)||void 0===M||M.filter((function(e){return"Formula"===e.data_type_name})).map((function(e){var o=(0,j.LV)(e.options,e.options.list.map((function(e){var n;return{value:null!==(n=C[e])&&void 0!==n?n:0}})),go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})),null===n||void 0===n?void 0:n.component_items);C[e.field_name]="".concat(o)})),C}));null===e||void 0===e||null===(n=e.reports)||void 0===n||n.filter((function(e){return"List Filter"===e.data_type_name})).map((function(e){d=d.filter((function(n){var o,l;return n[null===(o=e.options)||void 0===o?void 0:o.field]===(null===(l=e.options)||void 0===l?void 0:l.value)}))}));var r=null===e||void 0===e||null===(o=e.reports)||void 0===o?void 0:o.find((function(e){return"Transaction List"===e.data_type_name}));if(r){var s=[];d.map((function(e){e.items.filter((function(n){var o=(0,t.Z)({},e);Object.keys(r.options.map).map((function(e){o[r.options.map[e]]=n[e]})),s=[].concat((0,i.Z)(s),[o])})),delete e.items})),d=s}return null!==e&&void 0!==e&&e.title&&(d=(0,fe.HR)(d,e,_o)),d},hi=function(){var e,n,o,l,t,i;return a.createElement(_e.Z,{light:!0,style:{display:null!==_o&&void 0!==_o&&null!==(e=_o.processModule)&&void 0!==e&&null!==(n=e.module)&&void 0!==n&&null!==(o=n.options)&&void 0!==o&&o.one?go.find((function(e){var n,o,l;return e.module_id===(null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)&&(null===e||void 0===e||null===(l=e.created_by)||void 0===l?void 0:l.id)===Zo.id}))?"none":"":1!=(null===_o||void 0===_o||null===(l=_o.processModule)||void 0===l||null===(t=l.module)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.readOnly)||"manager"===Zo.user_type||"admin"===Zo.user_type?"":"none"},clicked:function(){si(),vl({})},icon:a.createElement("img",{src:r.IH})})},gi=function(){return(0,i.Z)(new Set(yt.filter((function(e){return void 0!==e.Status})).map((function(e){return e.Status})))).map((function(e){return{label:e,value:e}}))},bi=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yt,o=JSON.parse(JSON.stringify(n));e.filter((function(e,l){"status"===e.type?o="OR"===St.operator?[].concat((0,i.Z)(0==l?[]:o),(0,i.Z)(n.filter((function(n){return n.Status===e.value})))):o.filter((function(n){return n.Status===e.value})):"user"===e.type?o="OR"===St.operator?[].concat((0,i.Z)(0==l?[]:o),(0,i.Z)(n.filter((function(n){return n["Created By"]===e.label})))):o.filter((function(n){return n["Created By"]===e.label})):"fields"===e.type&&(o="OR"===St.operator?[].concat((0,i.Z)(0==l?[]:o),(0,i.Z)(n.filter((function(n){return n[e.filter]===e.value})))):o.filter((function(n){return n[e.filter]===e.value})))})),ht(o)},Mi=function(){var e;return a.createElement("div",{style:{display:""}},a.createElement(ge.Z,{value:null!==(e=St.operator)&&void 0!==e?e:"AND",className:u.dropdownSelectOperation,items:[{label:"AND",value:"AND"},{label:"OR",value:"OR"}],onChange:function(e){Zt((0,t.Z)((0,t.Z)({},St),{},{operator:e}))}}))},Ei=function(){return a.createElement("div",{style:{alignSelf:"flex-end",display:ti.component_blueprints.filter((function(e){var n;return 1==(null===(n=e.options)||void 0===n?void 0:n.asReport)})).length>0?"flex":"none"}},a.createElement(_e.Z,{light:!0,clicked:function(){rt?(Zt({list:[],operator:"AND"}),mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})))):mt([]),Et([]),st(!rt)},style:rt?{height:"36px"}:{}},rt?a.createElement(L.G,{icon:B.g82,style:{width:"25px",height:"25px"}}):a.createElement("img",{src:r.aR})),1==rt&&a.createElement(a.Fragment,null,a.createElement(ge.Z,{className:u.dropdownSelectReport,items:ti.component_blueprints.filter((function(e){var n,o,l;return 1==(null===(n=e.options)||void 0===n?void 0:n.asReport)&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(l=e.options)||void 0===l?void 0:l.showOnly.length)||Zo.positions.filter((function(n){var o,l;return null===(o=e.options)||void 0===o||null===(l=o.showOnly)||void 0===l?void 0:l.includes(n.id)})).length>0)})).map((function(e){return{label:null===e||void 0===e?void 0:e.name,value:e.id,blueprint:e}})),visible:!0,onChange:function(e){var n,o;mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})));var l=[];x.Z([k.Z(I.Z("index"))])(ti.component_blueprints.find((function(n){return n.id===e})).selected_fields.filter((function(e){return 1==e.visible}))).map((function(e){l=[].concat((0,i.Z)(l),[e.field_name]),"Info"===e.data_type_name?e.options.list.map((function(e){return l=[].concat((0,i.Z)(l),[e])})):"Transaction List"===e.data_type_name&&Object.values(e.options.map).map((function(e){return l=[].concat((0,i.Z)(l),[e])}))})),Zt({list:(0,i.Z)(new Set(l)),title:null===(n=ti.component_blueprints.find((function(n){return n.id===e})))||void 0===n?void 0:n.name,reports:x.Z([D.Z(I.Z("index"))])(ti.component_blueprints.find((function(n){return n.id===e})).selected_fields).map((function(e){return{field_name:e.field_name,data_type_name:e.data_type_name,options:e.options}})),operator:"AND"}),ht(yi({list:(0,i.Z)(new Set(l)),title:null===(o=ti.component_blueprints.find((function(n){return n.id===e})))||void 0===o?void 0:o.name,reports:x.Z([D.Z(I.Z("index"))])(ti.component_blueprints.find((function(n){return n.id===e})).selected_fields).map((function(e){return{field_name:e.field_name,data_type_name:e.data_type_name,options:e.options}})),operator:"AND"},go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)}))))},placeholder:"Reports"})))},Ci=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(n[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=_o.processModule.module)||void 0===e?void 0:e.name;return a.createElement(_e.Z,{light:!0,title:(null===St||void 0===St?void 0:St.title)&&"Export as file",clicked:function(){var e,d,a,u=rt?o:1==(null===(e=_o.processModule.module)||void 0===e||null===(d=e.options)||void 0===d?void 0:d.isMaster)?[].concat((0,i.Z)(o),["Shares","Title"]):o,r=Re.utils.book_new(),s=Re.utils.json_to_sheet([]);Re.utils.sheet_add_aoa(s,[u]),Re.utils.sheet_add_json(s,n.map((function(e){return Object.assign.apply(Object,[{}].concat((0,i.Z)(u.map((function(n){return(0,l.Z)({},n,e[n])})))))})),{origin:"A2",skipHeader:!0}),Re.utils.book_append_sheet(r,s,"".concat(null===(a=_o.processModule.module)||void 0===a?void 0:a.name)),(0,Re.writeFile)(r,"".concat(t).concat((0,A.now)(),".xlsx"))}},a.createElement("img",{src:r.so}))},wi=null===cl||void 0===cl||null===(X=cl.component_fields)||void 0===X?void 0:X.find((function(e){return"Status"===e.data_type_name})),Si=[];null===_o||void 0===_o||null===(H=_o.processModule)||void 0===H||null===(Q=H.steps)||void 0===Q||Q.filter((function(e){return null===e||void 0===e?void 0:e.component_blueprints.filter((function(e){var n,o;return(null===(n=e.options)||void 0===n||null===(o=n.showOnly)||void 0===o?void 0:o.length)>0}))})).filter((function(e){e.component_blueprints.filter((function(e){var n,o;return(null===(n=e.options)||void 0===n||null===(o=n.showOnly)||void 0===o?void 0:o.length)>0})).filter((function(e){e.options.showOnly.filter((function(e){Si=[].concat((0,i.Z)(Si),[e])}))}))}));var Zi=(null===_o||void 0===_o||null===(K=_o.processModule)||void 0===K||null===($=K.steps)||void 0===$?void 0:$.length)>0?null===_o||void 0===_o||null===(ee=_o.processModule)||void 0===ee||null===(ne=ee.steps)||void 0===ne||null===(oe=ne.find((function(e){return(null===e||void 0===e?void 0:e.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"Freehand"===e.data_type_name})).length>0})).length)>0})))||void 0===oe||null===(le=oe.component_blueprints.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Freehand"===e.data_type_name})))||void 0===n?void 0:n.length)>0})))||void 0===le||null===(te=le.options)||void 0===te?void 0:te.showOnly:void 0,xi=(null===_o||void 0===_o||null===(ie=_o.processModule)||void 0===ie||null===(de=ie.steps)||void 0===de?void 0:de.length)>0?null===_o||void 0===_o||null===(ue=_o.processModule)||void 0===ue||null===(re=ue.steps)||void 0===re||null===(se=re.find((function(e){return(null===e||void 0===e?void 0:e.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"Action Button"===e.data_type_name})).length>0})).length)>0})))||void 0===se||null===(ce=se.component_blueprints.find((function(e){var n;return(null===(n=e.selected_fields.filter((function(e){return"Action Button"===e.data_type_name})))||void 0===n?void 0:n.length)>0})))||void 0===ce||null===(ve=ce.options)||void 0===ve?void 0:ve.showOnly:void 0,ki=!xl&&(void 0===(null===cl||void 0===cl?void 0:cl.status)&&((null===(pe=Si)||void 0===pe?void 0:pe.filter((function(e){return Zo.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0||(null===Zi||void 0===Zi?void 0:Zi.filter((function(e){return Zo.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0)||(void 0===(null===cl||void 0===cl?void 0:cl.status)||"New"===(null===cl||void 0===cl?void 0:cl.status)||"Show"===(null===cl||void 0===cl?void 0:cl.status)||"None"===(null===cl||void 0===cl?void 0:cl.status)||"Reopen"===(null===cl||void 0===cl?void 0:cl.status)||null===(null===cl||void 0===cl?void 0:cl.status))&&((null===cl||void 0===cl||null===(me=cl.created_by)||void 0===me?void 0:me.id)===(null===Zo||void 0===Zo?void 0:Zo.id)||(null===cl||void 0===cl||null===(ye=cl.assigned_to)||void 0===ye?void 0:ye.id)===(null===Zo||void 0===Zo?void 0:Zo.id))||void 0!==(null===cl||void 0===cl?void 0:cl.status)&&!("Hide"===(null===cl||void 0===cl?void 0:cl.status)||"Closed"===(null===cl||void 0===cl?void 0:cl.status)||(null===cl||void 0===cl?void 0:cl.status)===(null!==(be=null===(Me=_o.processModule)||void 0===Me||null===(Ee=Me.module)||void 0===Ee||null===(Ce=Ee.options)||void 0===Ce?void 0:Ce.lock)&&void 0!==be?be:null===ho||void 0===ho||null===(we=ho.misc_info)||void 0===we?void 0:we.lock)||"Cancelled"===(null===cl||void 0===cl?void 0:cl.status))&&((null===(Se=Si)||void 0===Se?void 0:Se.filter((function(e){return Zo.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0||(null===Zi||void 0===Zi?void 0:Zi.filter((function(e){return Zo.positions.map((function(e){return e.id})).indexOf(e)>-1})).length)>0)&&(1!=(null===_o||void 0===_o||null===(Ge=_o.processModule)||void 0===Ge||null===(He=Ge.module)||void 0===He||null===(Ke=He.options)||void 0===Ke?void 0:Ke.strict)||(null===cl||void 0===cl||null===($e=cl.created_by)||void 0===$e?void 0:$e.id)!==(null===Zo||void 0===Zo?void 0:Zo.id))||(!1===(null===cl||void 0===cl?void 0:cl.is_complete)||null===(en=null===wi||void 0===wi||null===(nn=wi.options)||void 0===nn?void 0:nn.control)||void 0===en||en)&&(null===cl||void 0===cl||null===(on=cl.created_by)||void 0===on?void 0:on.id)===(null===Zo||void 0===Zo?void 0:Zo.id)&&(!(null!==wi&&void 0!==wi&&null!==(ln=wi.options)&&void 0!==ln&&ln.control||null!==_o&&void 0!==_o&&null!==(tn=_o.processModule)&&void 0!==tn&&null!==(dn=tn.module)&&void 0!==dn&&null!==(an=dn.options)&&void 0!==an&&an.close)||!((null===cl||void 0===cl?void 0:cl.status)===(null!==(un=null===(rn=_o.processModule)||void 0===rn||null===(sn=rn.module)||void 0===sn||null===(cn=sn.options)||void 0===cn?void 0:cn.lock)&&void 0!==un?un:null===ho||void 0===ho||null===(vn=ho.misc_info)||void 0===vn?void 0:vn.lock)))),Ii="trial_ended"!==ho.status&&"inactive"!==ho.status&&(0===(null===(pn=cl.component_fields)||void 0===pn?void 0:pn.filter((function(e){return"Action Button"===e.data_type_name&&"user"===e.options.action})).length)||0===(null===(mn=cl.component_fields)||void 0===mn?void 0:mn.filter((function(e){return"Action Button"===e.data_type_name&&"user"===e.options.action&&void 0===e.value})).length)&&((null===(fn=cl.component_fields)||void 0===fn?void 0:fn.filter((function(e){return"Action Button"===e.data_type_name&&"user"===e.options.action&&e.value===(null===Zo||void 0===Zo?void 0:Zo.id)})).length)>0||(null===cl||void 0===cl||null===(_n=cl.assigned_to)||void 0===_n?void 0:_n.id)===(null===Zo||void 0===Zo?void 0:Zo.id))),Di=(E.tq?[]:[a.createElement(_e.Z,{key:0,title:!E.tq&&"Close",icon:E.tq&&a.createElement(L.G,{icon:B.QQm,style:{ccolor:"var(--app-color-gray)",width:"20px",height:"20px"}}),style:{width:"100%"},clicked:function(){!xl&&tl(!1),kl(!1)}})]).concat(!xl&&(null===cl||void 0===cl||null===(yn=cl.component_fields)||void 0===yn?void 0:yn.length)>0&&(0,j.cQ)(null===cl||void 0===cl?void 0:cl.status,xi,cl,Zo,_o,ho)?null===_o||void 0===_o||null===(hn=_o.processModule)||void 0===hn||null===(gn=hn.steps)||void 0===gn||null===(bn=gn.find((function(e){return e.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"Action Button"===e.data_type_name})).length>0})).length>0})))||void 0===bn||null===(Mn=bn.component_blueprints.find((function(e){return e.selected_fields.filter((function(e){return"Action Button"===e.data_type_name})).length>0})))||void 0===Mn?void 0:Mn.selected_fields.filter((function(e){return"Action Button"===e.data_type_name})).map((function(e,n){var o,l,i,d;if("status"===e.options.action){var r,s,c,p,m,h,g,b,M,E=(null===ho||void 0===ho||null===(r=ho.misc_info)||void 0===r||null===(s=r.status)||void 0===s?void 0:s.length)>0?null===ho||void 0===ho||null===(c=ho.misc_info)||void 0===c?void 0:c.status:j.MO;if((null===ho||void 0===ho||null===(p=ho.misc_info)||void 0===p||null===(m=p.rules)||void 0===m?void 0:m.length)>0)null===ho||void 0===ho||null===(M=ho.misc_info)||void 0===M||M.rules.filter((function(e){return"status"===e.type})).filter((function(n){n.valueCondition===e.value&&(E="0"===n.allow?E.filter((function(e){return n.values.includes(e.value)})):E.filter((function(e){return!n.values.includes(e.value)})))}));return a.createElement("div",{key:n,style:{width:"100%",display:"user"===e.options.action&&null!==(h=cl.component_fields)&&void 0!==h&&null!==(g=h.find((function(n){return n.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id})))&&void 0!==g&&g.value?"none":""}},a.createElement(ge.Z,{titleProps:{fontSize:"16px",color:"var(--app-color-gray-light)"},className:u.multiselectComponent,key:n,visible:e.visible,mandatory:e.mandatory,value:null!==(b=e.value)&&void 0!==b?b:"",items:E,error:e.errors,onChange:function(n){var o,l,i,d;if(null!==(o=_o.processModule)&&void 0!==o&&null!==(l=o.module)&&void 0!==l&&null!==(i=l.options)&&void 0!==i&&i.credits&&(n===(null===(d=ho.options)||void 0===d?void 0:d.lock)||"Closed"===n)){var a,u,r,s,c,p,m,h,g,b,M=null===_o||void 0===_o||null===(a=_o.processModule)||void 0===a||null===(u=a.steps)||void 0===u||null===(r=u.find((function(e){return e.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"Payments"===e.data_type_name})).length>0})).length>0})))||void 0===r||null===(s=r.component_blueprints.find((function(e){return e.selected_fields.filter((function(e){return"Payments"===e.data_type_name})).length>0})))||void 0===s?void 0:s.selected_fields.find((function(e){return"Payments"===e.data_type_name})),E=null===(c=$o.newStepComponents.concat($o.components).find((function(e){return e.selected_fields.filter((function(e){var n;return e.field_name===(null===M||void 0===M||null===(n=M.options)||void 0===n?void 0:n.paymentField)})).length>0})))||void 0===c||null===(p=c.selected_fields)||void 0===p?void 0:p.find((function(e){var n;return e.field_name===(null===M||void 0===M||null===(n=M.options)||void 0===n?void 0:n.paymentField)})),C=0;if(null===(m=_o.processModule)||void 0===m||null===(h=m.selectedComponent.payments)||void 0===h||!h.stripe_id)return tl(!1),_o.processModule.showDetail=!1,void f.h.dispatch((0,_.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));if(!(+(null!==(g=null===E||void 0===E?void 0:E.value)&&void 0!==g?g:0)>0))return void f.h.dispatch((0,_.Xc)({show:!0,message:"No amount found",color:"red",spinner:!1,bottom:!0}));C=+(null!==(b=null===E||void 0===E?void 0:E.value)&&void 0!==b?b:0),"Cash"!==(null===M||void 0===M?void 0:M.value)&&(0,Be.e_)({user_id:Zo.id,id:(0,j.mR)(),total:C,product:"CR-".concat(null===cl||void 0===cl?void 0:cl.title),notes:"Wallet",quantity:1}).pipe((0,y.P)()).subscribe({next:function(){var e;Zo.wallet=+(+(null!==(e=null===Zo||void 0===Zo?void 0:Zo.wallet)&&void 0!==e?e:0)+C)}})}ho.start=!0,Pl(!0),(0,v.C0)({component_id:cl.id,index:0,group:99,value:n,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:function(e){Pl(!1),tl(!1),f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{showDetail:!1})))},error:function(){},complete:function(){}})},fieldIcon:e.icon,fieldLabel:e.field_name,placeholder:"Select status..."}))}return a.createElement(a.Fragment,null,a.createElement(_e.Z,{light:!0,title:e.field_name,loading:Nl,clicked:function(){if("user"===e.options.action||"creator"===e.options.action){var n,o,l,i="user"===e.options.action?Zo:Eo.find((function(e){var n;return e.id===(null===(n=cl.created_by)||void 0===n?void 0:n.id)}));if(null!==(n=_o.processModule)&&void 0!==n&&null!==(o=n.module)&&void 0!==o&&null!==(l=o.options)&&void 0!==l&&l.credits){var d,a,u,r,s,c,p,m,h,g=null===(d=cl.component_fields)||void 0===d?void 0:d.find((function(e){return"Payments"===e.data_type_name&&(null===e||void 0===e?void 0:e.value)})),b=null===(a=$o.newStepComponents.concat($o.components).find((function(e){return e.selected_fields.filter((function(e){var n;return e.field_name===(null===g||void 0===g||null===(n=g.options)||void 0===n?void 0:n.paymentField)})).length>0})))||void 0===a||null===(u=a.selected_fields)||void 0===u?void 0:u.find((function(e){var n;return e.field_name===(null===g||void 0===g||null===(n=g.options)||void 0===n?void 0:n.paymentField)}));if(!b)b=null===(h=cl.component_fields)||void 0===h?void 0:h.find((function(e){var n;return e.field_name===(null===g||void 0===g||null===(n=g.options)||void 0===n?void 0:n.paymentField)}));var M=0;if(void 0===(null===i||void 0===i?void 0:i.wallet)||0===(null===i||void 0===i?void 0:i.wallet))return f.h.dispatch((0,_.Xc)({show:!0,message:"You need to setup funds for your wallet",color:"red",spinner:!1,bottom:!0})),_o.processModule.showDetail=!1,void tl(!1);if(+(null!==(r=null===(s=b)||void 0===s?void 0:s.value)&&void 0!==r?r:0)>0&&"Cash"===(null===g||void 0===g?void 0:g.value)){var E,C,w,S;if((null!==(E=+(null===i||void 0===i?void 0:i.wallet))&&void 0!==E?E:0)<+(null===(C=b)||void 0===C?void 0:C.value))return f.h.dispatch((0,_.Xc)({show:!0,message:"Insufficient funds in wallet",color:"red",spinner:!1,bottom:!0})),_o.processModule.showDetail=!1,void tl(!1);M=null!==(w=null===(S=b)||void 0===S?void 0:S.value)&&void 0!==w?w:0}else if(null===(c=_o.processModule)||void 0===c||null===(p=c.selectedComponent)||void 0===p||null===(m=p.payments)||void 0===m||!m.stripe_id)return tl(!1),_o.processModule.showDetail=!1,void f.h.dispatch((0,_.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));"Cash"===(null===g||void 0===g?void 0:g.value)&&(0,Be.e_)({user_id:Zo.id,id:(0,j.mR)(),total:-M,product:"DB-".concat(null===cl||void 0===cl?void 0:cl.title),notes:"Wallet",quantity:1}).pipe((0,y.P)()).subscribe({next:function(){var e;return i.wallet=+(+(null!==(e=null===i||void 0===i?void 0:i.wallet)&&void 0!==e?e:0)-M)},error:function(){return f.h.dispatch((0,_.Xc)({show:!0,message:"Purchase error encountered",color:"red",spinner:!1,bottom:!0}))}})}Pl(!0),(0,v.C0)({component_id:cl.id,index:0,group:99,value:i.id,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:function(e){(0,v.dn)(cl.id,i.id).subscribe({next:function(e){Pl(!1),tl(!1),f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{showDetail:!1})))}})},error:function(){},complete:function(){}})}else"status"===e.options.action||"date"===e.options.action||e.options.action,Pl(!1)},style:{backgroundColor:"green",color:"white",width:"100%",display:"user"===e.options.action&&null!==(o=cl.component_fields)&&void 0!==o&&null!==(l=o.find((function(n){return n.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id})))&&void 0!==l&&l.value?"none":""}}),a.createElement(_e.Z,{title:"Decline",light:!0,loading:Nl,clicked:function(){var e,n;ul(!0),Pl(!0);var o=cl.component_fields.find((function(e){var n;return"People"===e.data_type_name&&!0===(null===(n=e.options)||void 0===n?void 0:n.calendar)}));(0,v.KL)((0,t.Z)((0,t.Z)({},cl),{},{selected_fields:o?cl.component_fields.filter((function(e){return e.id!==o.id})):cl.component_fields,assigned_to:{id:""}}),cl.id,null===(e=cl.shared_users)||void 0===e?void 0:e.map((function(e){return null===e||void 0===e?void 0:e.id})),cl.title,cl.is_complete,null===(n=cl.shared_positions)||void 0===n?void 0:n.map((function(e){return null===e||void 0===e?void 0:e.id}))).subscribe({error:function(e){f.h.dispatch((0,_.Xc)({show:!0,message:"Errors found",color:"red"}))},next:function(e){f.h.dispatch((0,_.aT)(cl.id)),Pl(!1),tl(!1),f.h.dispatch((0,_.q4)((0,t.Z)((0,t.Z)({},_o.processModule),{},{showDetail:!1})))}})},style:{backgroundColor:"red",color:"white",width:"100%",display:"user"===e.options.action&&null!==(i=cl.component_fields)&&void 0!==i&&null!==(d=i.find((function(n){return n.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id})))&&void 0!==d&&d.value?"none":""}}))})):[]).concat(xl?[]:[a.createElement(_e.Z,{light:!E.tq,key:3,title:!E.tq&&"Print",icon:E.tq&&a.createElement(L.G,{icon:B.wf8,style:{width:"20px",height:"20px"}}),style:{width:"100%",backgroundColor:E.tq?"green":"lightgray",display:E.tq?"none":""},clicked:function(){kl(!0)}})]).concat(xl?[a.createElement(he(),{key:4,trigger:function(){return a.createElement("button",{style:{width:"100%",display:E.tq?"none":""},className:u.singleButton},a.createElement(L.G,{icon:B.wf8}))},content:function(){return ai.current}})]:[]).concat(ki&&Ii?[a.createElement(_e.Z,{light:!E.tq,key:5,title:!E.tq&&"Edit",icon:E.tq&&a.createElement(L.G,{icon:B.Xcf,style:{width:"20px",height:"20px"}}),style:{backgroundColor:E.tq?"var(--app-color-blue)":"lightgray",width:"100%"},clicked:function(){var e,n,o,l,t,d;tl(!1),ul(!0),_o.processModule.isUpdating=!0,(null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(n=e.steps)||void 0===n?void 0:n.length)>0&&(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.steps)||void 0===l||l.filter((function(e){var n;return null===e||void 0===e||null===(n=e.component_blueprints)||void 0===n?void 0:n.filter((function(e){return e.selected_fields.filter((function(e){return e.value=void 0}))}))})));var a=[];qe.Z(Ae.Z("group"))(null!==(t=null===cl||void 0===cl?void 0:cl.component_fields)&&void 0!==t?t:[]).map((function(e){a=[].concat((0,i.Z)(a),[{id:e.component_blueprint_id,temp_id:e.id,selected_fields:Ye.Z(P.Z("group",e.group))(cl.component_fields)}])})),_o.processModule.steps.filter((function(e){e.component_blueprints.filter((function(e){var n,o,l,t,i,d;return(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asReport)||!(null!==e&&void 0!==e&&null!==(t=e.options)&&void 0!==t&&t.asReport))&&(0==(null===e||void 0===e||null===(i=e.options)||void 0===i?void 0:i.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))})).filter((function(e){e.selected_fields.filter((function(e){var n,o=null===(n=cl.component_fields)||void 0===n?void 0:n.find((function(n){return n.field_name===e.field_name}));if(void 0!=o)e.value=o.value,e.group=o.group;else if("Record"===e.data_type_name){var l,t=null===(l=cl.component_fields)||void 0===l?void 0:l.find((function(n){return n.field_name===e.options.name}));void 0!=t&&(e.value=t.value,e.value=t.group)}}))}))})),$o.components=a,$o.items=JSON.parse(JSON.stringify(null!==(d=null===cl||void 0===cl?void 0:cl.component_items)&&void 0!==d?d:[])),$o.newStepComponents=[],ho.start=!0,ci()}})]:[]).concat(!ki||null===_o||void 0===_o||null===(En=_o.processModule)||void 0===En||null===(Cn=En.module)||void 0===Cn||null===(wn=Cn.options)||void 0===wn||!wn.canCancel||"New"!==cl.status||null!==(Sn=cl.assigned_to)&&void 0!==Sn&&Sn.id?[]:[a.createElement(_e.Z,{key:6,title:"Cancel",style:{backgroundColor:"red",color:"white",width:"100%"},clear:!0,clicked:function(){(0,v.tE)(null===cl||void 0===cl?void 0:cl.id,"Cancelled").pipe((0,y.P)()).subscribe({next:function(e){}})}})]).concat(xl||null===_o||void 0===_o||null===(Zn=_o.processModule)||void 0===Zn||null===(xn=Zn.module)||void 0===xn||null===(kn=xn.options)||void 0===kn||!kn.canCancel||"New"!==cl.status&&"Unassigned"!==cl.status||null!==(In=cl.assigned_to)&&void 0!==In&&In.id?[]:[a.createElement(_e.Z,{key:7,loading:Nl,title:"Cancel Transaction",style:{backgroundColor:"red",color:"white",width:"100%"},clear:!0,clicked:function(){Pl(!0),(0,v.tE)(null===cl||void 0===cl?void 0:cl.id,"Cancelled").pipe((0,y.P)()).subscribe({next:function(e){var n;if(Pl(!1),null!==e&&void 0!==e&&null!==(n=e.data.payments)&&void 0!==n&&n.stripe_id){var o,l=Math.abs(+(null===e||void 0===e||null===(o=e.data.payments)||void 0===o?void 0:o.stripe_price));(0,Be.e_)({user_id:Zo.id,id:(0,j.mR)(),total:l,product:"RF-".concat(cl.title),notes:"Wallet",quantity:1}).pipe((0,y.P)()).subscribe({next:function(){var e;Zo.wallet=+(+(null!==(e=null===Zo||void 0===Zo?void 0:Zo.wallet)&&void 0!==e?e:0)+l),Pl(!1),tl(!1)}})}else Pl(!1),tl(!1),kl(!1)}})}})]).concat(xl||!0!==(null===(Dn=_o.processModule.module)||void 0===Dn?void 0:Dn.options.copyOutputs)||(null===cl||void 0===cl||null===(Nn=cl.created_by)||void 0===Nn?void 0:Nn.id)!==Zo.id?[]:[a.createElement(_e.Z,{key:8,light:!E.tq,title:!E.tq&&"Copy",icon:E.tq&&a.createElement(L.G,{icon:B.kZ_,style:{width:"20px",height:"20px"}}),style:{width:"100%",backgroundColor:E.tq?"orange":"lightgray",display:E.tq?"none":""},clicked:function(){zl(!0)}})]).concat((null===cl||void 0===cl||null===(Pn=cl.created_by)||void 0===Pn?void 0:Pn.id)===Zo.id&&(null===cl||void 0===cl||null===(On=cl.component_items)||void 0===On?void 0:On.length)>0&&!E.tq?[function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(n[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=_o.processModule.module)||void 0===e?void 0:e.name;return a.createElement(_e.Z,{light:!E.tq,icon:a.createElement("img",{src:r.so}),style:{width:"100%",backgroundColor:"lightgray"},clicked:function(){var e,d,a,u=null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(d=e.steps)||void 0===d?void 0:d.find((function(e){return e.component_blueprints.filter((function(e){var n,o;return(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find((function(e){return"Transaction List"===e.data_type_name})))})).length>0})),r=null===u||void 0===u||null===(a=u.component_blueprints)||void 0===a?void 0:a.find((function(e){var n;return(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Transaction List"===e.data_type_name&&!0===e.visible})).length)>0}));if(r){var s,c,v,p,m=null===_o||void 0===_o||null===(s=_o.processModule)||void 0===s||null===(c=s.steps)||void 0===c||null===(v=c.find((function(e){return e.component_blueprints.filter((function(e){var n;return null===(n=e.selected_fields)||void 0===n?void 0:n.find((function(e){return"Template"===e.data_type_name}))})).length>0})))||void 0===v||null===(p=v.component_blueprints)||void 0===p?void 0:p.find((function(e){var n;return(null===(n=e.selected_fields)||void 0===n?void 0:n.filter((function(e){return"Template"===e.data_type_name&&!0===e.visible})).length)>0}));(0,fe._G)(cl,r,m,o,n,_o,t)}else{var f,_=o,y=Re.utils.book_new(),h=Re.utils.json_to_sheet([]);Re.utils.sheet_add_json(h,n.map((function(e){return Object.assign.apply(Object,[{}].concat((0,i.Z)(_.map((function(n){return(0,l.Z)({},n,e[n])})))))})),{origin:"A2",skipHeader:!0}),Re.utils.book_append_sheet(y,h,"".concat(null===(f=_o.processModule.module)||void 0===f?void 0:f.name)),(0,Re.writeFile)(y,"".concat(t).concat((0,A.now)(),".xlsx"))}}})}(cl.component_items,["item_code","quantity","value","alt_value"])]:[]).concat(xl||!0!==(null===Zo||void 0===Zo?void 0:Zo.is_admin)||E.tq||(null!==wi&&void 0!==wi&&null!==(Tn=wi.options)&&void 0!==Tn&&Tn.control||null!==_o&&void 0!==_o&&null!==(qn=_o.processModule)&&void 0!==qn&&null!==(An=qn.module)&&void 0!==An&&null!==(Un=An.options)&&void 0!==Un&&Un.close)&&((null===cl||void 0===cl?void 0:cl.status)===(null!==(Yn=null===(Rn=_o.processModule)||void 0===Rn||null===(Ln=Rn.module)||void 0===Ln||null===(Bn=Ln.options)||void 0===Bn?void 0:Bn.lock)&&void 0!==Yn?Yn:null===ho||void 0===ho||null===(jn=ho.misc_info)||void 0===jn?void 0:jn.lock)||"Closed"===(null===cl||void 0===cl?void 0:cl.status))?[]:[a.createElement(_e.Z,{key:11,icon:E.tq&&a.createElement(L.G,{icon:B.$aW,style:{width:"20px",height:"20px"}}),title:!E.tq&&"Delete",style:{width:"100%",backgroundColor:"#F71534"},clicked:function(){var e,n,o;if(!0===(null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(n=e.module)||void 0===n||null===(o=n.options)||void 0===o?void 0:o.isMaster)){var l=go.filter((function(e){return e.module_id!==cl.module_id})).filter((function(e){return-1!=yo.filter((function(e){var n;return!0===(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.isMaster)})).map((function(e){return e.id})).indexOf(e.module_id)})),t=go.filter((function(e){return-1!=yo.filter((function(e){var n;return 1!=(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.isMaster)})).map((function(e){return e.id})).indexOf(e.module_id)})),i=l.filter((function(e){return e.component_fields.filter((function(e){return-1!=cl.component_fields.map((function(e){return e.value})).indexOf(e.value)})).length>0})).length>0||t.filter((function(e){return e.component_items.filter((function(e){return-1!=cl.component_fields.map((function(e){return e.value})).indexOf(e.item_code)})).length>0})).length>0||t.filter((function(e){return e.component_fields.filter((function(e){return"output"!==e.data_type&&-1!=cl.component_fields.map((function(e){return e.value})).indexOf(e.value)})).length>0})).length>0;Kl(i),Ll(!i)}else Ll(!0)}})]);return a.createElement("div",{className:u.processStepHost},a.createElement("div",{className:u.centeredCardMargin,"app-variant-is-mobile":E.tq?"true":"false"},1==(null===ti||void 0===ti?void 0:ti.rank)&&a.createElement(Ze,{title:null===_o||void 0===_o||null===(Fn=_o.processModule)||void 0===Fn||null===(zn=Fn.module)||void 0===zn?void 0:zn.name,subtitle:E.tq?"":null===_o||void 0===_o||null===(Vn=_o.processModule)||void 0===Vn?void 0:Vn.description,customStyle:{width:E.tq?"100%":"94%",minWidth:E.tq?"100px":"94%"},cardClicked:function(){wo(null===_o||void 0===_o?void 0:_o.processModule),Al(!ql),ql||(0,p.zJ)(null===_o||void 0===_o?void 0:_o.processModule.id).pipe((0,y.P)()).subscribe({next:function(e){f.h.dispatch((0,_.Xu)(e)),f.h.dispatch((0,_.an)([].concat((0,i.Z)(No.filter((function(n){return n.id!==e.id}))),[e]),1)),(0,v.d7)(j.KI,j.RI).pipe((0,y.P)()).subscribe({})}})}})),ql&&1==(null===ti||void 0===ti?void 0:ti.rank)&&a.createElement("div",{className:u.centeredCardMargin,"app-variant-is-mobile":E.tq?"true":"false"},a.createElement(Ze,{description:"Steps:",customStyle:{width:E.tq?"100%":"94%",minWidth:E.tq?"100px":"94%"}},a.createElement(ke.FZ,null,a.createElement(xe.Z,null)))),So,a.createElement("div",{className:u.centeredCardMargin,"app-variant-is-mobile":E.tq?"true":"false"},1===To&&void 0===(null===ti||void 0===ti?void 0:ti.component_blueprints)?a.createElement("div",{className:u.centeredSpinner},a.createElement(c.$j,{size:80,type:"ThreeDots"})):(null===ti||void 0===ti||null===(Wn=ti.component_blueprints)||void 0===Wn?void 0:Wn.filter((function(e){var n;return 1==(null===(n=e.options)||void 0===n?void 0:n.asModuleList)})).length)>0?null===ti||void 0===ti||null===(Gn=ti.component_blueprints)||void 0===Gn?void 0:Gn.filter((function(e){var n,o,l;return 1==e.options.asModuleList&&(Zo.positions.filter((function(n){var o,l;return null===(o=e.options)||void 0===o||null===(l=o.showOnly)||void 0===l?void 0:l.includes(n.id)})).length>0||0==(null===(n=e.options)||void 0===n||null===(o=n.showOnly)||void 0===o?void 0:o.length)||void 0===(null===(l=e.options)||void 0===l?void 0:l.showOnly))})).map((function(e,n){var o,l,d;return a.createElement(a.Fragment,{key:n},a.createElement(Z.default,{className:E.tq?u.listContainerMob:u.listContainer,isReport:rt,title:rt?"Reports":null===ti||void 0===ti?void 0:ti.name,columns:(null===(o=go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})))||void 0===o?void 0:o.filter((function(e){var n;return 0===(null===(n=e.component_fields)||void 0===n?void 0:n.length)})).length)>0?[_o.processModule.module.name]:E.tq?null!==e&&void 0!==e&&null!==(l=e.options)&&void 0!==l&&l.key?[_o.processModule.module.name,null===e||void 0===e||null===(d=e.options)||void 0===d?void 0:d.key]:[_o.processModule.module.name,"Status"]:(0,i.Z)(new Set(rt?St.list:x.Z([k.Z(I.Z("index"))])(e.selected_fields.filter((function(e){return 1==e.visible}))).map((function(e){var n;return"Info"===e.data_type_name?null===(n=e.options)||void 0===n?void 0:n.list:e.field_name})).flat())).slice(0,E.tq?2:18),list:rt?yt:yi({com:e,list:e.selected_fields.filter((function(e){return"Info"===e.data_type_name})).map((function(e){var n,o;return null!==(n=null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.key)&&void 0!==n?n:e.field_name})).concat(e.selected_fields.filter((function(e){return 1==e.visible})).map((function(e){return e.field_name})))}),addClicked:function(){si(),vl({})},onListItemClick:function(e){var n,o;if(!rt){var l,t,d,a,u=go.find((function(n){return n.id===e.id}));if(0===(null===(n=u.component_fields)||void 0===n?void 0:n.length))return Pl(!0),void(0,v.r6)(u.id).pipe((0,y.P)()).subscribe({next:function(e){vl(e),_l(e.is_complete),tl(!0),kl(!1),Pl(!1)},error:function(){}});if(vl(u),_l(u.is_complete),kl(!1),null!==u&&void 0!==u&&null!==(o=u.assigned_to)&&void 0!==o&&o.id&&!Eo.find((function(e){var n;return e.id===(null===u||void 0===u||null===(n=u.assigned_to)||void 0===n?void 0:n.id)})))(0,je.VG)(Eo.find((function(e){var n;return e.id===(null===(n=u.created_by)||void 0===n?void 0:n.id)}))?[null===u||void 0===u||null===(l=u.assigned_to)||void 0===l?void 0:l.id]:[null===u||void 0===u||null===(t=u.assigned_to)||void 0===t?void 0:t.id,null===u||void 0===u||null===(d=u.created_by)||void 0===d?void 0:d.id]).pipe((0,y.P)()).subscribe({next:function(e){f.h.dispatch((0,_.NY)(Eo.concat(e))),tl(!0)}});else if(_o.processModule.user_id!==Zo.id&&null!==(a=_o.processModule.module.options)&&void 0!==a&&a.skipDetail){var r,s,c,p,m,h;tl(!1),ul(!0),_o.processModule.isUpdating=!0,(null===_o||void 0===_o||null===(r=_o.processModule)||void 0===r||null===(s=r.steps)||void 0===s?void 0:s.length)>0&&(null===_o||void 0===_o||null===(c=_o.processModule)||void 0===c||null===(p=c.steps)||void 0===p||p.filter((function(e){var n;return null===e||void 0===e||null===(n=e.component_blueprints)||void 0===n?void 0:n.filter((function(e){return e.selected_fields.filter((function(e){return e.value=void 0}))}))})));var g=[];qe.Z(Ae.Z("group"))(null!==(m=null===u||void 0===u?void 0:u.component_fields)&&void 0!==m?m:[]).map((function(e){g=[].concat((0,i.Z)(g),[{id:e.component_blueprint_id,temp_id:e.id,selected_fields:Ye.Z(P.Z("group",e.group))(u.component_fields)}])})),_o.processModule.steps.filter((function(e){e.component_blueprints.filter((function(e){var n,o,l,t,i,d;return(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asReport)||!(null!==e&&void 0!==e&&null!==(t=e.options)&&void 0!==t&&t.asReport))&&(0==(null===e||void 0===e||null===(i=e.options)||void 0===i?void 0:i.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))})).filter((function(e){e.selected_fields.filter((function(e){var n=u.component_fields.find((function(n){return n.field_name===e.field_name}));if(void 0!=n)e.value=n.value,e.group=n.group;else if("Record"===e.data_type_name){var o=u.component_fields.find((function(n){return n.field_name===e.options.name}));void 0!=o&&(e.value=o.value,e.value=o.group)}}))}))})),$o.components=g,$o.items=JSON.parse(JSON.stringify(null!==(h=null===u||void 0===u?void 0:u.component_items)&&void 0!==h?h:[])),$o.newStepComponents=[],ho.start=!0,ci()}else tl(!0)}},pages:_o.processModule.module.count,onPageClicked:function(e){var n=go.filter((function(e){return e.module_id===_o.processModule.module.id}));if(12345===e){var o;n.length<(null===(o=_o.processModule.module)||void 0===o?void 0:o.count)&&(0,De.vC)(_o.processModule.module,j.Qc,999999,1).pipe((0,h.q)(1)).subscribe({next:function(e){var n;Pl(!1),_o.processModule.module.lastUpdate=0,_o.processModule.module.count=null!==(n=null===e||void 0===e?void 0:e.total)&&void 0!==n?n:0}})}else{var l,t,i=Math.ceil((null!==(l=_o.processModule.module)&&void 0!==l&&l.count?+(null===(t=_o.processModule.module)||void 0===t?void 0:t.count):n.length)/j.ZP);E.tq&&i>7&&(i=7);var d=Math.ceil(n.length/j.ZP),a=e;a>d&&(Pl(!0),Mo.componentsByModule[_o.processModule.module.name]=0,(0,De.vC)(_o.processModule.module,j.Qc,a-d<=1?j.ZP:j.ZP*a,a-d<=1?a:1).pipe((0,h.q)(1)).subscribe({next:function(e){var n;Pl(!1),Mo.componentsByModule[_o.processModule.module.name]=(0,A.now)(),_o.processModule.module.lastUpdate=0,_o.processModule.module.count=null!==(n=null===e||void 0===e?void 0:e.total)&&void 0!==n?n:0}}))}}},a.createElement("div",null,a.createElement("div",{style:{display:"flex"}},Mt.length>0&&a.createElement(_e.Z,{title:"Show all",clicked:function(){mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)}))),Zt((0,t.Z)((0,t.Z)({},St),{},{filter:void 0})),ht(yi((0,t.Z)((0,t.Z)({},St),{},{filter:void 0})))},style:{height:"30px",width:"140px"}}),Mt.map((function(e,n){return a.createElement(_e.Z,{className:u.customButton,icon:a.createElement("img",{src:r.C7,style:{height:"16px",width:"16px"}}),clicked:function(){Et(Mt.filter((function(n){return n.value!==e.value}))),bi(Mt.filter((function(n){return n.value!==e.value})),yi((0,t.Z)((0,t.Z)({},St),{},{filter:void 0})))},key:n,style:{height:"30px",width:"inherit"}},"".concat(0==n?"":e.operator," ").concat(e.label))})),Mt.length>0&&a.createElement(_e.Z,{title:"Apply",style:{height:"30px",width:"160px"},clicked:function(){bi(Mt,yi((0,t.Z)((0,t.Z)({},St),{},{filter:void 0})))},light:!0})),rt&&a.createElement("div",{style:{display:"flex"}},Mi(),gi().length>0&&a.createElement(ge.Z,{className:u.dropdownSelectComponent,items:gi(),onChange:function(e){Mt.map((function(e){return e.label})).includes(e)||Et([].concat((0,i.Z)(Mt),[{label:e,value:e,type:"status",operator:St.operator}]))},placeholder:"Status"}),rt&&a.createElement(ge.Z,{className:u.dropdownSelectComponent,items:St.list.map((function(e){return{label:e,value:e}})),onChange:function(e){Zt((0,t.Z)((0,t.Z)({},St),{},{filter:void 0})),setTimeout((function(){return Zt((0,t.Z)((0,t.Z)({},St),{},{filter:e}))}),10)},placeholder:"Filter by fields"}),1==rt&&void 0!==(null===St||void 0===St?void 0:St.filter)&&a.createElement(ge.Z,{className:u.dropdownSelectComponentL,items:(0,i.Z)(new Set(yi(St).map((function(e){return e[St.filter]})))).map((function(e){return{label:e,value:e}})),onChange:function(e){Mt.map((function(e){return e.value})).includes(e)||Et([].concat((0,i.Z)(Mt),[{label:"".concat(St.filter,": ").concat(e),value:e,type:"fields",filter:St.filter,operator:St.operator}]))},placeholder:"Field value"}),1==rt&&a.createElement(ge.Z,{className:u.dropdownSelectComponent,items:Eo.map((function(e){return{label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}})),onChange:function(e){if(!Mt.map((function(e){return e.label})).includes(e)){var n=Eo.find((function(n){return n.id===e}));Et([].concat((0,i.Z)(Mt),[{label:"".concat(n.first_name," ").concat(n.last_name),value:e,type:"user",operator:St.operator}]))}},placeholder:"Created by"}))),a.createElement("div",{className:u.actionsContainer},!(null!==St&&void 0!==St&&St.title)&&rt&&a.createElement("label",{style:{padding:"20px 0px 20px 5px",fontSize:"12px"}},"OR"===St.operator?"Selecting OR will select all instances of selected value":"Selecting AND will only include instances of selected value"),rt?(null===St||void 0===St?void 0:St.title)&&Ci(yt,St.list,St.title):a.createElement("div",{className:u.searchContainer},a.createElement(L.G,{icon:B.wn1,style:{width:"25px",height:"25px",padding:"5px"}}),a.createElement("input",{placeholder:"Search",className:u.searchInput,onChange:function(e){var n,o,l;if("deleteContentBackward"===e.nativeEvent.inputType)mt(_i(null===_o||void 0===_o||null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l?void 0:l.id,go,e.target.value));else if((null===(n=e.target.value)||void 0===n?void 0:n.length)>0){var t,i;mt(_i(null===_o||void 0===_o||null===(t=_o.processModule)||void 0===t||null===(i=t.module)||void 0===i?void 0:i.id,pt,e.target.value))}else 0==e.target.value.length&&mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)})))}})),rt&&Ei(),a.createElement("div",{style:{display:rt?"none":"flex",alignSelf:"flex-end"}},!("trial_ended"===ho.status||"inactive"===ho.status||"free"===ho.status||"on_trial"===ho.status)&&hi(),"on_trial"===ho.status&&go.filter((function(e){return e.module_id===_o.processModule.module.id&&U()(new Date(e.created_date)).format("DDMMYYYY")===U()(new Date).format("DDMMYYYY")})).length<5&&hi(),"free"===ho.status&&go.filter((function(e){return U()(new Date(e.created_date)).format("DDMMYYYY")===U()(new Date).format("DDMMYYYY")})).length<3&&hi(),!E.tq&&Ei(),!E.tq&&Ci(yi({list:e.selected_fields.filter((function(e){return 1==e.visible})).map((function(e){return e.field_name}))}),e.selected_fields.filter((function(e){return 1==e.visible})).map((function(e){return e.field_name}))),a.createElement(_e.Z,{light:!0,clicked:function(){Pl(!0);var e=yo.find((function(e){return e.id===_o.processModule.module_id}));Mo.componentsByModule[e.name]=0,(0,De.vC)(e,j.Qc,j.R6,1).pipe((0,h.q)(1)).subscribe({next:function(n){var o,l=null!==n&&void 0!==n&&n.data?null===n||void 0===n?void 0:n.data:n;f.h.dispatch((0,_.mK)(Ue.Z(I.Z("created_date"),[].concat((0,i.Z)(go.filter((function(e){return e.module_id!==_o.processModule.module_id}))),(0,i.Z)(l))),j.KI,Io.map((function(e){return e.fields})).flat(1))),Mo.componentsByModule[e.name]=(0,A.now)(),e.lastUpdate=(0,A.now)(),e.count=null!==(o=null===n||void 0===n?void 0:n.total)&&void 0!==o?o:0,Pl(!1)},complete:function(){},error:function(){return Pl(!1)}})},icon:a.createElement("img",{src:r.Fd}),loading:Nl,message:"Fetching ".concat(_o.processModule.module.name,"...")})))))})):a.createElement("div",{className:u.listContainer,"app-variant-is-mobile":E.tq?"true":"false"},a.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},a.createElement("p",{className:u.stepTitleSmaller},null===ti||void 0===ti?void 0:ti.name),a.createElement(_e.Z,{clear:!0,clicked:function(){var n,o,l;Pl(!0),null===(n=_o.processModule.module)||void 0===n||null===(o=n.options)||void 0===o||null===(l=o.supporting)||void 0===l||l.filter((function(n,o){var l,t,i;Pl(!0),(0,De.vC)({id:n,name:null!==(l="".concat(null===yo||void 0===yo||null===(t=yo.find((function(e){return e.id===n})))||void 0===t?void 0:t.name).concat(o))&&void 0!==l?l:"".concat(null===(i=e)||void 0===i?void 0:i.name).concat(o)},j.Qc,j.R6,1).pipe((0,h.q)(1)).subscribe({next:function(e){var n,l,t,i;(null===(n=_o.processModule.module)||void 0===n||null===(l=n.options)||void 0===l||null===(t=l.supporting)||void 0===t?void 0:t.length)==o+1&&(Pl(!1),ci(null===(i=_o.processModule.steps[_o.processModule.stepIndex-1])||void 0===i?void 0:i.id))},error:function(){return Pl(!1)}})}))},icon:a.createElement("img",{src:r.Fd}),loading:Nl})),a.createElement("br",null),a.createElement("label",{className:u.stepGuidanceSmaller},null===ti||void 0===ti?void 0:ti.guidance),Vo&&a.createElement(S.Z,{message:Vo,onClick:function(){return Wo("")}}),a.createElement(Xe,{nextButtonClicked:Xo,step:ti,setIsMandatoryError:jo,isMandatoryError:Bo,begunModule:_o,companyData:ho,blueprints:Io,components:go,products:Co,authenticatedUser:Zo,isEditing:bo,companyUsersArray:Eo,usersArray:It,setUsers:bl,setPositions:wl,setIsCompleted:_l,selectedComponent:cl,goToNextStep:ci,companyPositionsArray:xo,cart:ko,allModules:yo,editMode:Ut},a.createElement("div",{className:u.menuRightButtons}),function(){var e,n,o,l,t,i,d;return a.createElement("div",{className:u.menuAccordionButtons},_o.processModule.stepIndex>0&&a.createElement(_e.Z,{title:"Cancel",light:!0,clicked:function(){$o.components.length>0||$o.newStepComponents.length>0?Ht(!0):(_o.processModule.back_array=[],mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)}))),ci(_o.processModule.steps[0].id),Yt(!1))}}),_o.processModule.stepIndex>0&&a.createElement(_e.Z,{title:"Back",light:!0,style:{width:"80px"},clicked:function(){var e,n,o;if(1==_o.processModule.stepIndex&&mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)}))),1==(null===ti||void 0===ti||null===(e=ti.options)||void 0===e?void 0:e.deleteOnBack)&&ti.component_blueprints.filter((function(e){return e.selected_fields.filter((function(e){return"output"!==e.data_type})).map((function(e){e.value=void 0}))})),(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.back_array)||void 0===o?void 0:o.length)>0){var l,t=null===_o||void 0===_o||null===(l=_o.processModule)||void 0===l?void 0:l.back_array.pop();t&&ci(t)}else{var i;ci(null===(i=_o.processModule.steps[_o.processModule.stepIndex-1])||void 0===i?void 0:i.id)}}}),!0===(null===ti||void 0===ti?void 0:ti.is_end)?a.createElement(_e.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:al?"Update":fl&&null!==(e=null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o||null===(l=o.options)||void 0===l?void 0:l.save)&&void 0!==e?e:"Save",loading:Nl,style:{marginLeft:"0px",display:null!==_o&&void 0!==_o&&null!==(t=_o.processModule)&&void 0!==t&&null!==(i=t.module)&&void 0!==i&&null!==(d=i.options)&&void 0!==d&&d.nosave?"none":$o.components.length>0||$o.newStepComponents.length>0?"":"none"},clicked:function(){var e,n,o,l,t,i;return Ut?Wo("Saving is not allowed in Edit Mode"):1==(null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e||null===(n=e.module)||void 0===n||null===(o=n.options)||void 0===o?void 0:o.emailOutputs)&&1==(null===_o||void 0===_o||null===(l=_o.processModule)||void 0===l||null===(t=l.module)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.selectiveEmail)&&fl?Jl(!0):pi()}}):a.createElement(_e.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:"Next",style:{width:"80px"},clicked:function(){var e,n,o,l,t,i,d,a,u;Array.isArray(null===_o||void 0===_o||null===(e=_o.processModule)||void 0===e?void 0:e.back_array)||(_o.processModule.back_array=[]),null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||n.back_array.push(null===$o||void 0===$o||null===(o=$o.currentStep)||void 0===o?void 0:o.id);var r,s,c,v,p,m=null===(l=ti.component_blueprints.find((function(e){return e.selected_fields.filter((function(e){var n,o;return"Dropdown"===e.data_type_name&&(null===(n=e.options)||void 0===n?void 0:n.jump1)&&"decision"===(null===(o=e.options)||void 0===o?void 0:o.type)})).length>0})))||void 0===l||null===(t=l.selected_fields)||void 0===t?void 0:t.find((function(e){var n;return"Dropdown"===e.data_type_name&&(null===(n=e.options)||void 0===n?void 0:n.jump1)})),y=null===(i=ti.component_blueprints.find((function(e){return e.selected_fields.filter((function(e){var n;return"Value Button"===e.data_type_name&&(null===(n=e.options)||void 0===n?void 0:n.jump1)})).length>0})))||void 0===i||null===(d=i.selected_fields)||void 0===d?void 0:d.filter((function(e){var n;return"Value Button"===e.data_type_name&&(null===(n=e.options)||void 0===n?void 0:n.jump1)}));if(null!==m&&void 0!==m&&null!==(a=m.options)&&void 0!==a&&a.jump1&&null!==m&&void 0!==m&&null!==(u=m.options)&&void 0!==u&&u.jump2)if(0==(null===m||void 0===m||null===(r=m.options)||void 0===r?void 0:r.list.indexOf(null===m||void 0===m?void 0:m.value)))ri(null===(c=No.find((function(e){var n;return e.id===(null===m||void 0===m||null===(n=m.options)||void 0===n?void 0:n.process)})))||void 0===c||null===(v=c.steps)||void 0===v||null===(p=v.find((function(e){return e.id===(null===m||void 0===m?void 0:m.options.jump1)})))||void 0===p?void 0:p.id);else if(1==(null===m||void 0===m||null===(s=m.options)||void 0===s?void 0:s.list.indexOf(null===m||void 0===m?void 0:m.value))){var h,g,b;ri(null===(h=No.find((function(e){var n;return e.id===(null===m||void 0===m||null===(n=m.options)||void 0===n?void 0:n.process)})))||void 0===h||null===(g=h.steps)||void 0===g||null===(b=g.find((function(e){return e.id===(null===m||void 0===m?void 0:m.options.jump2)})))||void 0===b?void 0:b.id)}else{var M;null===_o||void 0===_o||null===(M=_o.processModule)||void 0===M||M.back_array.pop(),f.h.dispatch((0,_.Xc)({show:!0,message:"Please select a value for ".concat(null===m||void 0===m?void 0:m.field_name),color:"red",bottom:!1}))}else if((null===y||void 0===y?void 0:y.length)>0){var E,C,w,S,Z,x=y.filter((function(e){return void 0!==e.value}));if(1==x.length)ri(null===(E=No.find((function(e){var n,o;return e.id===(null===(n=x[0])||void 0===n||null===(o=n.options)||void 0===o?void 0:o.process)})))||void 0===E||null===(C=E.steps)||void 0===C||null===(w=C.find((function(e){var n;return e.id===(null===(n=x[0])||void 0===n?void 0:n.options.jump1)})))||void 0===w?void 0:w.id);else null===_o||void 0===_o||null===(S=_o.processModule)||void 0===S||null===(Z=S.back_array)||void 0===Z||Z.pop(),f.h.dispatch((0,_.Xc)({show:!0,message:"A selection is required",color:"red",bottom:!1})),window.scrollTo({top:0,behavior:"smooth"})}else if((null===ti||void 0===ti?void 0:ti.next_steps.length)>1||ii.length>1||di.length>1)Yo(!Uo);else if(1===ti.next_steps.length){var k;ri(null===ti||void 0===ti||null===(k=ti.next_steps[0])||void 0===k?void 0:k.id)}else{var I;ri(null===(I=_o.processModule.steps[_o.processModule.steps.findIndex((function(e){return e.id===ti.id}))+1])||void 0===I?void 0:I.id)}}}),Uo&&a.createElement("div",{className:u.goToNextStep},null===ti||void 0===ti?void 0:ti.next_steps.map((function(e,n){return a.createElement("div",{key:n,onClick:function(){return ri(e.id)},className:u.nextStepsContainer},a.createElement("div",{className:u.nextStepImageContainer},a.createElement("img",{alt:"",src:r.c6})),a.createElement("p",null,null===e||void 0===e?void 0:e.name))})),null===ii||void 0===ii?void 0:ii.map((function(e,n){return a.createElement("div",{key:n,onClick:function(){return ri(e.id)},className:u.nextStepsContainer},a.createElement("div",{className:u.nextStepImageContainer},a.createElement("img",{alt:"",src:r.th})),a.createElement("p",null,null===e||void 0===e?void 0:e.name))})),null===di||void 0===di?void 0:di.map((function(e,n){return a.createElement("div",{key:n,onClick:function(){return function(e){f.h.dispatch((0,_.pU)(e)),Yo(!1)}(e)},className:u.nextStepsContainer},a.createElement("div",{className:u.nextStepImageContainer},a.createElement("img",{alt:"",src:r.IR})),a.createElement("p",null,null===e||void 0===e?void 0:e.name))}))))}())),(null===_o||void 0===_o||null===(Jn=_o.processModule)||void 0===Jn||null===(Xn=Jn.module)||void 0===Xn||null===(Hn=Xn.options)||void 0===Hn?void 0:Hn.ads)&&$t&&0==(null===ti||void 0===ti||null===(Qn=ti.component_blueprints)||void 0===Qn?void 0:Qn.filter((function(e){var n;return 1==(null===(n=e.options)||void 0===n?void 0:n.asModuleList)})).length)&&a.createElement("div",{style:{textAlign:"center"}},function(e){if(e){var n=x.Z([D.Z(I.Z("created_date"))])(go.filter((function(n){return n.module_id===e.id}))).filter((function(e){var n;return(null===(n=e.component_fields)||void 0===n?void 0:n.filter((function(e){var n,o,l,t,i;return"Status"===e.data_type_name&&!(e.value===(null!==(n=null===(o=_o.processModule)||void 0===o||null===(l=o.module)||void 0===l||null===(t=l.options)||void 0===t?void 0:t.lock)&&void 0!==n?n:null===(i=ho.misc_info)||void 0===i?void 0:i.lock)||"Closed"===e.value||"Cancelled"===e.value||"Hide"===e.value)})).length)>0})).map((function(e,n){var o,l,t,i,d=e.component_fields.find((function(e){var n,o,l;return"Link"===e.data_type_name&&((null!==(n=null===e||void 0===e?void 0:e.value)&&void 0!==n?n:"").includes("jpg")||(null!==(o=null===e||void 0===e?void 0:e.value)&&void 0!==o?o:"").includes("png")||(null!==(l=null===e||void 0===e?void 0:e.value)&&void 0!==l?l:"").includes("pdf"))}));return a.createElement("div",{key:n,className:u.imageCard,onClick:function(){}},d&&(null!==(o="".concat(null===d||void 0===d?void 0:d.value))&&void 0!==o&&o.includes("jpg")||null!==(l="".concat(null===d||void 0===d?void 0:d.value))&&void 0!==l&&l.includes("jpeg")||null!==(t="".concat(null===d||void 0===d?void 0:d.value))&&void 0!==t&&t.includes("png")||null!==(i="".concat(null===d||void 0===d?void 0:d.value))&&void 0!==i&&i.includes("pdf"))&&null!==d&&void 0!==d&&d.value.includes("pdf")?a.createElement("embed",{src:"".concat(null===d||void 0===d?void 0:d.value,"#toolbar=0&navpanes=0&scrollbar=0&zoom=100%"),width:"1000px",height:"1000px"}):a.createElement("img",{alt:"lg",src:null===d||void 0===d?void 0:d.value,style:{objectFit:"contain",height:"100vh",borderRadius:"5px"}}))}));return(null===n||void 0===n?void 0:n.length)>0&&a.createElement(c.U7,{isOpen:$t,onClose:function(){localStorage.setItem("showAdsDate",(0,A.now)()),ei(!1)},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:"60%",minWidth:"600px",backgroundColor:"var(--app-color-gray-lightest)"}},a.createElement("div",{className:u.center,style:{display:(null===n||void 0===n?void 0:n.length)>0?"":"none",flexDirection:"column"}},(null===n||void 0===n?void 0:n.length)>1?a.createElement(We.tq,{slidesPerView:"auto",centeredSlides:!0,spaceBetween:200,initialSlide:1,pagination:{clickable:!0,dynamicBullets:!0},autoplay:{delay:1e4,disableOnInteraction:!0},modules:[Ve.pt,Ve.tl],className:"mySwiper"},(null===n||void 0===n?void 0:n.length)>0&&n.map((function(e,n){return a.createElement(We.o5,{key:n,className:u.swiperslide},e)}))):n),a.createElement(c.pd,{title:"Do not show popup again?",style:{margin:"0px 20% 20px 20%",width:"auto",backgroundColor:"var(--app-color-gray-lightest)",padding:"10px 50px 10px 50px"},value:!$t,toggleSelected:function(e){localStorage.setItem("showAdsDate",(0,A.now)()),localStorage.setItem("showAds",!e),ei(!1)}}))}return a.createElement(a.Fragment,null)}(yo.find((function(e){var n,o,l;return e.id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o||null===(l=o.options)||void 0===l?void 0:l.ads)})))),Xt&&a.createElement(ze.Z,{openModal:Xt,setOpenModal:Ht,dialogHandler:function(){_o.processModule.back_array=[],mt(go.filter((function(e){var n,o;return e.module_id===(null===_o||void 0===_o||null===(n=_o.processModule)||void 0===n||null===(o=n.module)||void 0===o?void 0:o.id)}))),ci(_o.processModule.steps[0].id),Yt(!1),Ht(!1)},title:"You have unsaved items. Are you sure you want to cancel?",proceedTitle:"Yes",cancelTitle:"No, return back",loading:Nl}),Vt&&_o.processModule.stepIndex>0&&a.createElement(c.U7,{isOpen:Vt,onClose:function(){return Wt(!1)},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"40%"}},a.createElement("div",{style:{padding:"30px"}},a.createElement("p",{className:u.deleteText},"There were unsaved data for ".concat(cl.title,". Do you want to restore them?")),a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(_e.Z,{title:"Yes, restore",clicked:function(){f.h.dispatch((0,_.Xc)({show:!0,message:"Reverting to saved data from the cache. Press Save to permanently save these records. Cancel to revert back",color:"red",spinner:!1,bottom:!0})),$o.items=JSON.parse(localStorage.getItem("items")),$o.newStepComponents=JSON.parse(localStorage.getItem("newStepComponents")),localStorage.removeItem("transaction"),Wt(!1)}}),a.createElement(_e.Z,{title:"No, use the current data as is",light:!0,clicked:function(){localStorage.removeItem("transaction"),Wt(!1)}})))),Rl&&a.createElement(c.U7,{isOpen:v.v7,onClose:function(){},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"20%"}},a.createElement("div",null,a.createElement("p",{className:u.deleteText},"Are you sure you want to delete ".concat(cl.title,"?")),a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(_e.Z,{title:"Yes, delete",style:{backgroundColor:"red"},clicked:function(){ot(!0),(0,v.v7)(cl.id).pipe((0,y.P)()).subscribe({next:function(){ot(!1),tl(!1),Ll(!1)},complete:function(){},error:function(){ot(!1),Ll(!1)}})},loading:nt}),a.createElement(_e.Z,{title:"No",light:!0,clicked:function(){return Ll(!1)}})))),Fl&&a.createElement(c.U7,{isOpen:Fl,onClose:function(){},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"20%"}},a.createElement("div",null,a.createElement("p",{className:u.deleteText},"Are you sure you want to copy ".concat(cl.title,"? This will create a new copy")),a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(_e.Z,{title:"Yes, copy",clicked:function(){var e;tl(!1),zl(!1),si();var n=[];qe.Z(Ae.Z("group"))(null!==(e=null===cl||void 0===cl?void 0:cl.component_fields)&&void 0!==e?e:[]).map((function(e){n=[].concat((0,i.Z)(n),[{id:e.component_blueprint_id,temp_id:e.id,selected_fields:Ye.Z(P.Z("group",e.group))(cl.component_fields)}])})),_o.processModule.steps.filter((function(e){e.component_blueprints.filter((function(e){e.selected_fields.filter((function(e){var n,o=null===(n=cl.component_fields)||void 0===n?void 0:n.find((function(n){return n.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id}));if(void 0!=o)"ID"===e.data_type_name||"Status"===e.data_type_name?e.value=void 0:e.value=o.value;else if("Record"===e.data_type_name){var l,t=null===(l=cl.component_fields)||void 0===l?void 0:l.find((function(n){return n.field_name===e.options.name}));void 0!=t&&(e.value=t.value)}}))}))})),el({action:g._U.addModuleComponents,value:n}),el({action:g._U.setModuleItems,value:cl.component_items}),ul(!1),_o.processModule.isUpdating=!1,vl({})}}),a.createElement(_e.Z,{title:"No",light:!0,clicked:function(){return zl(!1)}})))),Ql&&a.createElement(c.U7,{isOpen:Ql,onClose:function(){},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"20%"}},a.createElement("div",null,a.createElement("p",{className:u.deleteText},"Cannot delete ".concat(cl.title,". Some transactions and master data are using this item")),a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(_e.Z,{title:"Close",light:!0,clicked:function(){return Kl(!1)}}))))),Bt&&a.createElement(c.U7,{isOpen:Bt,onClose:function(){},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"80%"}},a.createElement(Le.default,{hasCloseIcon:!0,label:null===_o||void 0===_o||null===(Kn=_o.processModule)||void 0===Kn||null===($n=Kn.module)||void 0===$n?void 0:$n.name,withBack:!1,paymentPath:"begin-module",onClose:function(){return jt(!1)},companyData:ho,subscriptionInfo:{user_id:Zo.id,ref:$o.id,plan_price:null!==(eo=null===$o||void 0===$o?void 0:$o.plan)&&void 0!==eo?eo:0,currency:null!==(no=null===$o||void 0===$o?void 0:$o.currency)&&void 0!==no?no:"PHP",plan:"CC-".concat($o.id),total:null!==(oo=+(null===$o||void 0===$o?void 0:$o.total))&&void 0!==oo?oo:0,billable_users:[Zo],duration:0,dlabel:$o.id},onError:function(e){Wo(e),jo(!0),jt(!1),f.h.dispatch((0,_.Xc)({show:!0,message:"Transaction was created but the selected payment mode encountered an issue. Please select another payment option. You may also manually attach your proof of payment",color:"red",bottom:!0})),f.h.dispatch((0,_.RV)({})),vi()}})),Gl&&a.createElement(c.U7,{isOpen:Gl,onClose:function(){return Jl(!1)},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"15%"}},a.createElement("div",null,a.createElement(c.jL,{ungrouped:!0,title:"nonmanager"===Zo.user_type?"Type an email address to send copy of this transaction (optional)":"Select users to email this transaction (Optional)",columned:!0,withAckButton:!1},"nonmanager"===Zo.user_type?a.createElement("input",{placeholder:"Use comma, no space, for multiple email addresses",className:u.emailInput,onChange:function(e){new RegExp(/^([a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)(([, ]+[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])\.([a-z0-9]([a-z0-9-]*[a-z0-9]))*)?)*$/).test(e.target.value)&&Tt(e.target.value.split(","))}}):a.createElement(Ie.Cm,{id:"Users",tagEmplacement:"inlined",searchable:!1,items:It.filter((function(e){var n;return e.department===(null===(n=Zo.departments[0])||void 0===n?void 0:n.name)})),groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:[],className:u.peoplePositionsSelect,inputClassName:u.peoplePositionsSelectInput,molclassname:u.peoplePositionsSelectMenuOverlay,moliclassname:u.peoplePositionsSelectMenuOverlayItem,onChange:function(e){e.length>0?Tt(null===e||void 0===e?void 0:e.map((function(e){return null===e||void 0===e?void 0:e.user.email}))):Tt([])}})),a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(_e.Z,{title:"Back",light:!0,clicked:function(){return Jl(!1)}}),a.createElement(_e.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:al?"Update":fl&&null!==(lo=null===_o||void 0===_o||null===(to=_o.processModule)||void 0===to||null===(io=to.module)||void 0===io||null===(ao=io.options)||void 0===ao?void 0:ao.save)&&void 0!==lo?lo:"Save",loading:Nl,style:{marginLeft:"0px"},clicked:function(){Jl(!1),pi()}})))),ll&&0==(null===_o||void 0===_o||null===(uo=_o.processModule)||void 0===uo?void 0:uo.stepIndex)&&a.createElement(c.U7,{isOpen:ll,onClose:function(){return tl(!1)},hasCloseIcon:!!E.tq,backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:(E.tq,"100%"),height:"auto",minWidth:E.tq?"100%":"1000px",backgroundColor:"transparent"}},a.createElement("div",{"app-variant-is-mobile":E.tq?"true":"false",style:{display:"flex",justifyContent:"center",flexDirection:"column"}},a.createElement(Qe,{ref:ai,begunModule:_o,allModules:yo,companyData:ho,components:go,selectedComponent:cl,companyUsersArray:Eo,print:xl,step:r.Nb,companyPositionsArray:xo,authenticatedUser:Zo,setIsOpen:tl,setSelectedComponent:vl},(null===cl||void 0===cl||null===(ro=cl.component_fields)||void 0===ro?void 0:ro.length)>0&&a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",padding:xl?"0 30%":(null===Di||void 0===Di?void 0:Di.length)>4?"0 5%":"0 25%"}},Di)))),it&&a.createElement(c.U7,{isOpen:it,hasCloseIcon:!0,onClose:function(){return Do?li("/"):dt(!1)},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:E.tq?"100%":"30%",height:"auto"}},a.createElement("div",{style:{textAlign:"center",padding:"0 20px"}},a.createElement("p",{className:u.modalTitle},null===(so=_o.processModule.module)||void 0===so?void 0:so.name),a.createElement("p",{className:u.modalSubTitle},null!==(co=null===_o||void 0===_o||null===(vo=_o.processModule)||void 0===vo||null===(po=vo.module)||void 0===po||null===(mo=po.options)||void 0===mo?void 0:mo.message)&&void 0!==co?co:"Transaction saved"))))}))}}]);
//# sourceMappingURL=1400.b6b8db36.chunk.js.map