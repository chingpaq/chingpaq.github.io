"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[824],{68517:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var l=a(87462),n=a(1413),r=a(70885),i=a(67861),o=a(29118),s=a(39518),d=a(11577),c=a(41771),u=a(43984),m=a(75105),v=a(89293),p=a(20086),f=a(61616),_={host:"MyProfile_host__Bnmii",labeledContainerHost:"MyProfile_labeledContainerHost__IQZCc",labeledContainerLabel:"MyProfile_labeledContainerLabel__Tg+ZM",avatarDragContainer:"MyProfile_avatarDragContainer__1jOhu",avatarUploadIcon:"MyProfile_avatarUploadIcon__sZ016",avatarUploadText:"MyProfile_avatarUploadText__9UN2K",avatarAcceptedFormatsText:"MyProfile_avatarAcceptedFormatsText__zXNGB",avatarUploadPictureContainer:"MyProfile_avatarUploadPictureContainer__jjcmU",avatarUploadPictureText:"MyProfile_avatarUploadPictureText__6Jnly",avatarDragInput:"MyProfile_avatarDragInput__90brU",avatarContentContainer:"MyProfile_avatarContentContainer__kqcIC",avatarUrlImg:"MyProfile_avatarUrlImg__yCO7Y",avatarErrorText:"MyProfile_avatarErrorText__nxaLE",labeledFieldHost:"MyProfile_labeledFieldHost__hKuOZ",labeledFieldLabel:"MyProfile_labeledFieldLabel__cdIoV",labeledFieldChildrenContainer:"MyProfile_labeledFieldChildrenContainer__sG4-y",labeledFieldError:"MyProfile_labeledFieldError__xG-9G",label:"MyProfile_label__efRly",inputField:"MyProfile_inputField__RqYBM",emailParagraph:"MyProfile_emailParagraph__XK4WI",positionsParagraph:"MyProfile_positionsParagraph__LuOSk",errorGeneralText:"MyProfile_errorGeneralText__JSHju",success:"MyProfile_success__f1kym",userDataWrapper:"MyProfile_userDataWrapper__k9v75",userSettingsContainer:"MyProfile_userSettingsContainer__lwFPb",deletePositionContainer:"MyProfile_deletePositionContainer__HGaAl",deletePosition_title:"MyProfile_deletePosition_title__3lF+T",deletePosition_description:"MyProfile_deletePosition_description__1MKdp",deletePosition_checkboxContainer:"MyProfile_deletePosition_checkboxContainer__8r2sD",deletePosition_buttonContainer:"MyProfile_deletePosition_buttonContainer__0eBDk"},g=a(73500),y=a(88374),E=a(23280),h=a(63789),P=function(e){var t=e.label,a=e.children,l=e.readOnly;return i.createElement("div",{className:_.labeledContainerHost,style:{width:g.tq?"100%":"50%"},"app-readonly":l?"true":"false"},i.createElement("p",{className:_.labeledContainerLabel},t),a)},b=function(e){var t=e.label,a=e.error,l=e.children,n=e.wrappedContent;return i.createElement("div",{className:_.labeledFieldHost},i.createElement("label",{className:_.labeledFieldLabel},t),n?i.createElement("div",{className:_.labeledFieldChildrenContainer},l):l,(null===a||void 0===a?void 0:a.length)>0&&i.createElement("p",{className:_.labeledFieldError},a))},x=(0,s.$j)((function(e){return{authenticatedUser:e.authReducer.authenticatedUser,user:e.sessionReducer.user,components:e.flowReducer.components}}),(function(e){return{onSetAuthenticatedUserPosition:function(t){return e((0,u.IF)(t))}}}))((function(e){var t,a,u,x,C,N,w,M,Z,F=e.authenticatedUser,S=e.user,U=e.components,k=(0,i.useState)(""),T=(0,r.Z)(k,2),I=T[0],D=T[1],j=(0,i.useState)(F),G=(0,r.Z)(j,2),L=G[0],O=G[1],W=(0,i.useState)(""),A=(0,r.Z)(W,2),H=A[0],q=A[1],R=(0,i.useState)(""),z=(0,r.Z)(R,2),B=z[0],K=z[1],Y=(0,i.useState)(""),V=(0,r.Z)(Y,2),J=V[0],X=V[1],Q=(0,i.useState)(""),$=(0,r.Z)(Q,2),ee=$[0],te=$[1],ae=(0,i.useState)(""),le=(0,r.Z)(ae,2),ne=le[0],re=le[1],ie=(0,i.useState)(!1),oe=(0,r.Z)(ie,2),se=oe[0],de=oe[1],ce=(0,i.useState)(!1),ue=(0,r.Z)(ce,2),me=ue[0],ve=ue[1],pe=(0,i.useState)(!1),fe=(0,r.Z)(pe,2),_e=fe[0],ge=fe[1],ye=(0,i.useState)(!1),Ee=(0,r.Z)(ye,2),he=Ee[0],Pe=Ee[1],be=(0,E.TH)().state,xe=(0,E.s0)(),Ce=(0,s.I0)(),Ne=(0,i.useCallback)((function(e){return e.forEach((function(e){var t,a;if(D(""),(null===e||void 0===e||null===(t=e.type)||void 0===t?void 0:t.toString().indexOf("image/"))>-1&&["jpeg","jpg","png"].indexOf(null===e||void 0===e||null===(a=e.type)||void 0===a?void 0:a.toString().split("/")[1])>-1){var l=new FileReader;l.readAsDataURL(e),l.onloadend=function(t){(new FormData).append("avatar",e),(0,m.xx)(L.id,e).subscribe({next:function(e){O(e)},error:function(e){D(null===e||void 0===e?void 0:e.data)}})}}}))}),[]),we=(0,o.uI)({onDrop:Ne}),Me=we.getRootProps,Ze=we.getInputProps,Fe=we.isDragActive,Se=(0,i.useState)(""),Ue=(0,r.Z)(Se,2),ke=Ue[0],Te=Ue[1],Ie=(0,i.useState)(""),De=(0,r.Z)(Ie,2),je=De[0],Ge=De[1];(0,i.useEffect)((function(){var e;Te(""),(null===be||void 0===be||null===(e=be.user)||void 0===e?void 0:e.id.length)>0?(O(be.user),Ce((0,y.IW)(!1))):(Ce((0,y.IW)(!0)),(0,m.IC)().pipe((0,d.P)()).subscribe({next:function(e){O(e)},error:function(e){Te(e.data)}}))}),[]);var Le=(0,i.useState)({first_name:"",last_name:""}),Oe=(0,r.Z)(Le,2),We=Oe[0],Ae=Oe[1],He=(0,i.useState)({first_name:!1,last_name:!1}),qe=(0,r.Z)(He,2),Re=qe[0],ze=qe[1],Be=(0,i.useCallback)((function(){Object.values(Re).some((function(e){return!0===e}))&&(Ae({first_name:"",last_name:""}),Ge(""),(0,m.TP)(L.id,L.first_name,L.last_name).pipe((0,d.P)()).subscribe({next:function(){ze({first_name:!1,last_name:!1})},error:function(e){var t,a,l={first_name:"",last_name:""};e.data.errors.first_name&&(l.first_name=null===(t=e.data.errors.first_name)||void 0===t?void 0:t.join("; "));e.data.errors.last_name&&(l.last_name=null===(a=e.data.errors.last_name)||void 0===a?void 0:a.join("; "));"The given data was invalid."!==e.data.message&&Ge(e.data.message),Ae((function(e){return(0,n.Z)((0,n.Z)({},e),l)}))}}))}),[L,Re]),Ke=(0,i.useCallback)((function(){var e;return i.createElement("div",(0,l.Z)({className:_.avatarDragContainer,"app-drag-active":Fe?"true":"false"},Me()),i.createElement("input",(0,l.Z)({},Ze(),{className:_.avatarDragInput,accept:"*,image/png, image/jpeg, image/jpg"})),Fe?i.createElement("div",{className:_.avatarContentContainer},i.createElement(c.rG2,{className:_.avatarUploadIcon})):i.createElement("div",{className:_.avatarContentContainer},(null===L||void 0===L||null===(e=L.photo)||void 0===e?void 0:e.length)>2?i.createElement("img",{alt:"lg",src:(0,v.oY)(null===L||void 0===L?void 0:L.photo),className:_.avatarUrlImg}):i.createElement("div",{className:_.avatarUploadPictureContainer},i.createElement(c.rG2,{className:_.avatarUploadIcon}))))}),[L]);return console.log(U.filter((function(e){var t,a;return(null===e||void 0===e||null===(t=e.created_by)||void 0===t?void 0:t.id)===(null===be||void 0===be||null===(a=be.user)||void 0===a?void 0:a.id)})).length>0),i.createElement("div",{id:"my-profile-settings",className:_.host},(null===be||void 0===be||null===(t=be.user)||void 0===t||null===(a=t.id)||void 0===a?void 0:a.length)>0&&1==F.is_admin?i.createElement("div",{style:{width:"70%",display:"flex",justifyContent:"space-between"}},i.createElement(p.zx,{title:"Back",clicked:function(){return xe("/users")},style:{width:"100px"}}),(null===be||void 0===be?void 0:be.user)&&i.createElement(p.zx,{title:"Show Tasks",loading:me,light:!0,clicked:function(){return ge(!0)}})):i.createElement("div",{style:{margin:"80px 0 0 0"}},i.createElement(f.Z,{headerTitle:"My Profile",targetProcessing:!1})),g.tq&&i.createElement(P,{label:"Personal Information"}),g.tq&&i.createElement("div",{style:{display:"",alignSelf:"center"}},i.createElement(b,{label:"Profile picture"},Ke(),(null===I||void 0===I?void 0:I.length)>0&&i.createElement("p",{className:_.avatarErrorText},I))),i.createElement("div",{className:_.labeledContainerHost,style:{width:g.tq?"100%":"50%"}},i.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},!g.tq&&i.createElement(P,{label:"Personal Information"}),i.createElement("div",{style:{padding:"0 0 0px 0",display:g.tq?"none":""}},i.createElement(b,{label:"Profile picture"},Ke(),(null===I||void 0===I?void 0:I.length)>0&&i.createElement("p",{className:_.avatarErrorText},I)))),i.createElement("div",{className:_.userDataWrapper},i.createElement(p.sm,{className:_.userSettingsContainer,onClickOutside:Be},i.createElement("div",{style:{width:"inherit"}},i.createElement(b,{label:"First Name",error:We.first_name},i.createElement("input",{type:"text",name:"first-name",className:_.inputField,placeholder:"First Name",value:null!==(u=null===L||void 0===L?void 0:L.first_name)&&void 0!==u?u:"",onChange:function(e){return O((function(t){return(0,n.Z)((0,n.Z)({},t),{},{first_name:e.target.value})}))},onFocus:function(){ze((function(e){return(0,n.Z)((0,n.Z)({},e),{},{display_name:!0})}))}})),i.createElement(b,{label:"Last Name",error:We.last_name},i.createElement("input",{type:"text",name:"last-name",className:_.inputField,placeholder:"Last Name",value:null!==(x=null===L||void 0===L?void 0:L.last_name)&&void 0!==x?x:"",onChange:function(e){return O((function(t){return(0,n.Z)((0,n.Z)({},t),{},{last_name:e.target.value})}))},onFocus:function(){ze((function(e){return(0,n.Z)((0,n.Z)({},e),{},{display_name:!0})}))}})),i.createElement(b,{label:"Username",wrappedContent:!0},i.createElement("p",{className:_.emailParagraph},null===L||void 0===L?void 0:L.username)),i.createElement(b,{label:"Work Email",wrappedContent:!0},i.createElement("p",{className:_.emailParagraph},null===L||void 0===L?void 0:L.email)),i.createElement(b,{label:"Position"+((null===(C=L.positions)||void 0===C?void 0:C.length)>1?"s":""),wrappedContent:!0},(null===(N=L.positions)||void 0===N?void 0:N.length)>0&&(null===(w=L.positions)||void 0===w?void 0:w.map((function(e,t){return i.createElement("p",{key:t,className:_.positionsParagraph},e.name)}))))),i.createElement("div",{style:{display:g.tq?"":"flex",gap:"24px",marginTop:"15px",width:"100%"}},i.createElement("div",{style:{flex:1}},i.createElement(b,{label:(null===be||void 0===be||null===(M=be.user)||void 0===M||null===(Z=M.id)||void 0===Z?void 0:Z.length)>0&&1==F.is_admin?"Admin Password":"Old Password",error:We.first_name},i.createElement("input",{type:"password",name:"old-password",className:_.inputField,value:H,onChange:function(e){return q(e.target.value)}}))),i.createElement("div",{style:{flex:1}},i.createElement(b,{label:"New Password",error:We.first_name},i.createElement("input",{type:"password",name:"new-password",className:_.inputField,value:J,onChange:function(e){return X(e.target.value)}}))),i.createElement("div",{style:{flex:1}},i.createElement(b,{label:"Verify New Password",error:We.last_name},i.createElement("input",{type:"password",name:"verify-password",className:_.inputField,value:ee,onChange:function(e){return te(e.target.value)}})))),i.createElement("div",{style:{display:"flex"}},H.length>5&&J.length>5&&ee.length>5&&i.createElement("div",{style:{display:"flex",gap:"24px",marginTop:"15px",maxWidth:"100%"}},i.createElement(p.zx,{title:"Update password",loading:me,lighter:!0,clicked:function(){if(ve(!0),J!==ee)return ve(!1),re("Confirmation does not match");(0,m.N4)(H,J,ee,L.id).pipe((0,d.P)()).subscribe({next:function(){ve(!1),Pe(!0),K(""),re(""),je(""),ke("")},error:function(e){var t,a,l,n;(console.log(e),null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&null!==(a=t.errors)&&void 0!==a&&a.old_password)&&K(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(n=l.errors)||void 0===n?void 0:n.old_password[0]);ve(!1),Pe(!1)},complete:function(){q(""),X(""),te("")}})}})),1==S.is_admin&&null!==be&&0==(null===be||void 0===be?void 0:be.user.is_admin)&&0==(null===be||void 0===be?void 0:be.user.positions.length)&&0===U.filter((function(e){var t,a;return(null===e||void 0===e||null===(t=e.created_by)||void 0===t?void 0:t.id)===(null===be||void 0===be||null===(a=be.user)||void 0===a?void 0:a.id)})).length&&i.createElement("div",{style:{display:"flex",gap:"24px",marginTop:"15px",maxWidth:"100%"}},i.createElement(p.zx,{title:"Delete User",loading:me,light:!0,clicked:function(){return de(!0)}}))),i.createElement("div",null,he&&i.createElement("p",{className:_.success},"Password Successfully changed")),i.createElement("div",null,(null===B||void 0===B?void 0:B.length)>0&&i.createElement("p",{className:_.errorGeneralText},B)),i.createElement("div",null,(null===ne||void 0===ne?void 0:ne.length)>0&&i.createElement("p",{className:_.errorGeneralText},ne)),i.createElement("div",null,(null===ke||void 0===ke?void 0:ke.length)>0&&i.createElement("p",{className:_.errorGeneralText},ke)),i.createElement("div",null,(null===je||void 0===je?void 0:je.length)>0&&i.createElement("p",{className:_.errorGeneralText},je))),i.createElement(p.U7,{shadowedContainerStyle:{maxWidth:"400px",minWidth:"300px",width:"40%"},onClose:function(){de(!1)},isOpen:se,backdropColor:!0,blured:!0},i.createElement("h1",{className:_.deletePosition_title},"Delete User"),i.createElement("p",{className:_.deletePosition_description},"Press Delete to continue with the delete of user"),i.createElement("div",{className:_.deleteModalContainer},i.createElement("div",{className:_.deletePosition_buttonContainer,style:{display:"flex"}},i.createElement(p.zx,{title:"Close",style:{marginLeft:"0px",width:"79%",padding:"0 10px"},titleStyle:{textAlign:"center"},clicked:function(){de(!1)}}),i.createElement(p.zx,{title:"Delete",style:{marginLeft:"0px",width:"79%",padding:"0 10px"},light:!0,loading:me,titleStyle:{textAlign:"center"},clicked:function(){ve(!0),(0,m.NY)(L.id).pipe((0,d.P)()).subscribe({next:function(){ve(!1),de(!1),xe("/users")},error:function(e){console.log(e)},complete:function(){}})}})))),_e&&(null===be||void 0===be?void 0:be.user)&&i.createElement(h.Z,{isVisible:_e,activeItem:null===be||void 0===be?void 0:be.user,handleClose:function(){return ge(!1)},isAdmin:S.is_admin}))))}))}}]);
//# sourceMappingURL=824.21b35c34.chunk.js.map