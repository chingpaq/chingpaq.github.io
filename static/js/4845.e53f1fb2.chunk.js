"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[4845,5887],{3999:(e,l,o)=>{o.d(l,{rr:()=>ge,ZP:()=>ye});var t=o(1413),i=o(67861);const n={processStepHost:"ModuleStep_processStepHost__fdU12",listContainer:"ModuleStep_listContainer__+T0XF",listContainerMob:"ModuleStep_listContainerMob__7T+-i",detailContainer:"ModuleStep_detailContainer__EFIwE",centeredCardMargin:"ModuleStep_centeredCardMargin__eYosE",centeredSpinner:"ModuleStep_centeredSpinner__sOFdo",emptyElementsSection:"ModuleStep_emptyElementsSection__ehjx-",stepCounter:"ModuleStep_stepCounter__mD22I",clockIcon:"ModuleStep_clockIcon__TY0er",stepTitle:"ModuleStep_stepTitle__f9SxJ",stepTitleSmaller:"ModuleStep_stepTitleSmaller__Ng9ym",stepGuidance:"ModuleStep_stepGuidance__aWqq0",stepGuidanceSmaller:"ModuleStep_stepGuidanceSmaller__IKIF+",inputContainer:"ModuleStep_inputContainer__s9qZ2",selectInput:"ModuleStep_selectInput__LcokN",multiselectWithSearch:"ModuleStep_multiselectWithSearch__qMOzq",smoMultiselectParent:"ModuleStep_smoMultiselectParent__Pweb-",selectMenuItem:"ModuleStep_selectMenuItem__i73KN",inputClassName:"ModuleStep_inputClassName__VI3pY",toggleMenuInputButton:"ModuleStep_toggleMenuInputButton__gcFHY",goToNextStep:"ModuleStep_goToNextStep__ePl+k",nextStepsContainer:"ModuleStep_nextStepsContainer__zcpA0",nextStepImageContainer:"ModuleStep_nextStepImageContainer__55MGd",nextStepWrapper:"ModuleStep_nextStepWrapper__ZtiNA",headerContainer:"ModuleStep_headerContainer__4kozo",content:"ModuleStep_content__ClnRX","react-grid-layout":"ModuleStep_react-grid-layout__21OCf",layoutJSON:"ModuleStep_layoutJSON__tFPI9",columns:"ModuleStep_columns__dPw3m","react-grid-item":"ModuleStep_react-grid-item__tFcr7","react-grid-placeholder":"ModuleStep_react-grid-placeholder__canbf",resizing:"ModuleStep_resizing__xUUDG",static:"ModuleStep_static__IPrAy",text:"ModuleStep_text__MzRSh",minMax:"ModuleStep_minMax__SkZxD",add:"ModuleStep_add__aOZYV","react-grid-dragHandleExample":"ModuleStep_react-grid-dragHandleExample__iEu5W",cssTransforms:"ModuleStep_cssTransforms__aN9IT","react-draggable-dragging":"ModuleStep_react-draggable-dragging__epzS0","react-resizable-handle":"ModuleStep_react-resizable-handle__XaFka",singleButton:"ModuleStep_singleButton__+BXaC",menuRightButtons:"ModuleStep_menuRightButtons__r-OPw",menuButtons:"ModuleStep_menuButtons__TsY6r",menuAccordionButtons:"ModuleStep_menuAccordionButtons__4QNWj",detailLabel:"ModuleStep_detailLabel__hVTU1",subLabel:"ModuleStep_subLabel__6PFJJ",modalHeaderTitle:"ModuleStep_modalHeaderTitle__hDlRr",p:"ModuleStep_p__njhI7",accordionContainer:"ModuleStep_accordionContainer__oW7nH",itemsTable:"ModuleStep_itemsTable__ttZKV",sharesTable:"ModuleStep_sharesTable__Gy1CG",peoplePositionsSelect:"ModuleStep_peoplePositionsSelect__jXRrK",peoplePositionsSelectInput:"ModuleStep_peoplePositionsSelectInput__NSg8e",peoplePositionsSelectMenuOverlay:"ModuleStep_peoplePositionsSelectMenuOverlay__S0xqm",peoplePositionsSelectMenuOverlayItem:"ModuleStep_peoplePositionsSelectMenuOverlayItem__Vuo-D",deleteText:"ModuleStep_deleteText__XIVyR",deleteButton:"ModuleStep_deleteButton__PhwaV",searchContainer:"ModuleStep_searchContainer__s1Y37",searchInput:"ModuleStep_searchInput__XukKm",emailInput:"ModuleStep_emailInput__sTwU9",actionsContainer:"ModuleStep_actionsContainer__jWMeW",detailButton:"ModuleStep_detailButton__w7F3v",detailButtonTitleContainer:"ModuleStep_detailButtonTitleContainer__8ffTu",fetchingLatestP:"ModuleStep_fetchingLatestP__gnf89",modalTitle:"ModuleStep_modalTitle__T4SaB",modalSubTitle:"ModuleStep_modalSubTitle__SIFKS",dropdownSelectComponent:"ModuleStep_dropdownSelectComponent__L66Sz",dropdownSelectComponentL:"ModuleStep_dropdownSelectComponentL__wOEsz",dropdownSelectOperation:"ModuleStep_dropdownSelectOperation__DEwuW",dropdownSelectReport:"ModuleStep_dropdownSelectReport__g2+2D",cardTitle:"ModuleStep_cardTitle__h24lD",customButton:"ModuleStep_customButton__sVkp5",fieldTypeInput:"ModuleStep_fieldTypeInput__q1+bw",fieldRowContainer:"ModuleStep_fieldRowContainer__5hIbd",templateInformation:"ModuleStep_templateInformation__UjdWL",emulatedFlexGap:"ModuleStep_emulatedFlexGap__yE15Q","mobile-navbar":"ModuleStep_mobile-navbar__P0z8E","mobile-navbar-close":"ModuleStep_mobile-navbar-close__5fZ-y","hamb-icon":"ModuleStep_hamb-icon__lSxYR","open-nav":"ModuleStep_open-nav__39a-n",description:"ModuleStep_description__GUBFo",tableHostSimple:"ModuleStep_tableHostSimple__VmM5x",imageCard:"ModuleStep_imageCard__HGrB9",imageColumn:"ModuleStep_imageColumn__IBD9y",imageLogoPrint:"ModuleStep_imageLogoPrint__I5-r0",title:"ModuleStep_title__whugX",statusBox:"ModuleStep_statusBox__qcpUN",checkboxLabelClass:"ModuleStep_checkboxLabelClass__h93jt"};var d=o(85692),a=o(39518),s=o(48929),u=o(6073),r=o(93389),v=o(34710),p=o(88827),c=o(88374),m=o(11577),_=o(10103),f=o(88550),h=o(49119),g=o(16127),y=o(12308),M=o(51330),b=o(48963),S=o(79633),C=o(47144),x=o.n(C),E=o(27436);const w=e=>{var l;const{component:o,isMandatoryError:t,nextButtonClicked:n,setIsMandatoryError:a}=e,[s]=(0,f.pQ)(),[u]=(0,i.useState)(""),r=(0,i.useRef)(null);(0,i.useEffect)(()=>{v()},[n]);const v=()=>{var e;null!==o&&void 0!==o&&null!==(e=o.selected_fields)&&void 0!==e&&e.some(e=>{var l;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.length)<1)})?a(!0):a(!1)},p=(e,l)=>{var o,t;0==l?s.newProduct={name:e,product_code:null===s||void 0===s||null===(o=s.newProduct)||void 0===o?void 0:o.product_code}:s.newProduct={product_code:e,name:null===s||void 0===s||null===(t=s.newProduct)||void 0===t?void 0:t.name}};return i.createElement("div",{id:"accordion",className:b.Z.section},i.createElement("div",{className:x()(b.Z.accordionContainer,!0),"app-variant-has-error":u?"error":""},i.createElement("div",{style:{display:"flex"}},i.createElement("p",{className:b.Z.title,style:{color:t&&n?"var(--app-color-error)":""}},"New Product Details")),i.createElement("div",{ref:r,style:{maxHeight:"",display:"flex",padding:"0px 0px 20px 0px"},className:b.Z.content},i.createElement(S.Z,{fieldIcon:d.MQ,fieldLabel:"Product Name",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},i.createElement("div",{className:b.Z.fieldRowContainer},i.createElement("input",{type:"text",onChange:e=>{p(e.target.value,0)},autoComplete:"none",className:b.Z.fieldTypeInput,name:"field.field_name"}))),i.createElement("div",{style:{width:"10px"}}),i.createElement(S.Z,{fieldIcon:d.MQ,fieldLabel:"Product Code",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},i.createElement("div",{className:b.Z.fieldRowContainer},i.createElement("input",{type:"text",onChange:e=>{p(e.target.value,1)},autoComplete:"none",className:b.Z.fieldTypeInput,name:"field.field_name"}))))),u&&(null===u||void 0===u||null===(l=u.errors)||void 0===l?void 0:l.title)&&i.createElement(E.Z,{message:u.errors.title}),u&&(null===u||void 0===u?void 0:u.message)&&i.createElement(E.Z,{message:u.message}))};var Z=o(41131),k=o(40694),I=o(81330),N=o.n(I),P=o(63864);const D={userCard:"GeneralCard_userCard__0SOp0",cls:"GeneralCard_cls__aX-Sn",userCardContainer:"GeneralCard_userCardContainer__wJA5U",userCardContainerTop:"GeneralCard_userCardContainerTop__UB7lh",userCardInnerContainer:"GeneralCard_userCardInnerContainer__XVh+2",avatarUrlImg:"GeneralCard_avatarUrlImg__qfa2g",userCardBottomContainer:"GeneralCard_userCardBottomContainer__0WoR6",fullName:"GeneralCard_fullName__QizQf",position:"GeneralCard_position__3X6Ea",email:"GeneralCard_email__U8cda"},U=e=>{const{cardClicked:l,title:o,subtitle:t,children:n,description:d,customClass:a=D.userCard,customStyle:s}=e;return i.createElement("div",{className:a,onClick:l,style:s},i.createElement("div",{className:D.userCardContainer},i.createElement("div",{className:D.userCardBottomContainer},i.createElement("p",{className:D.fullName},o),i.createElement("p",{className:D.email},d),i.createElement("p",{className:D.position},t),n)))};var T=o(60761),O=o(49465),q=o(29937),A=o(73500),B=o(4358),R=o(1542),Y=o(49523),L=o(25403),F=o(4292),W=o(9204),j=o(32086),z=o(53431),G=o(68218),X=o(84634),V=o(35606),J=o(79544),H=o(98032),Q=o(62169),K=o(13397),$=o(88346),ee=o(8284),le=(o(67055),o(71901),o(50981)),oe=o.n(le),te=o(95007),ie=o(87424),ne=o(23280),de=o(27658),ae=o(52902),se=o(12075),ue=o(75105),re=o(51481),ve=o(41757),pe=o(44408),ce=o(23910),me=o(46415);o(60940),o(56120),o(37704),o(72666),o(68623),o(3863),o(95361);e=o.hmd(e);var _e=o(456);const fe=(0,i.memo)(e=>{var l,o,d,a,u,v,p,c,_,f,g,y;const{step:b,isMandatoryError:S,nextButtonClicked:C,setIsMandatoryError:x,begunModule:E,companyData:k,components:I,isEditing:N,companyUsersArray:D,setUsers:U,setPositions:T=()=>{},products:O,selectedComponent:q,goToNextStep:R,authenticatedUser:Y,setIsCompleted:L,companyPositionsArray:F,cart:W,blueprints:j,allModules:z,usersArray:G,editMode:X}=e,[V]=((0,h.WidthProvider)(h.Responsive),(0,i.useState)(null===(l=null===q||void 0===q?void 0:q.is_complete)||void 0===l||l));let J=[];const H=i.createElement(me.mQ,{style:{width:"100%",marginTop:"50px",minHeight:"30vh"}},i.createElement(me.td,null,null===b||void 0===b?void 0:b.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||Y.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).map((e,l)=>{var o;return i.createElement(me.OK,{key:l},i.createElement("div",{style:{padding:"10px 0",fontSize:"16px",fontWeight:"bold",fontFamily:"var(--app-text-main-font)",transform:"scaleY(1.1)",color:"var(--app-color-gray-dark)"}},null===e||void 0===e||null===(o=e.name)||void 0===o?void 0:o.toUpperCase()))})),(null===b||void 0===b||null===(o=b.component_blueprints)||void 0===o?void 0:o.length)>0?null===b||void 0===b?void 0:b.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||Y.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).map((e,l)=>{const o=e.selected_fields.find(e=>"Template"===e.data_type_name&&1==e.visible),n=e.selected_fields.find(e=>"Video"===e.data_type_name&&1==e.visible);return o?i.createElement(me.x4,{key:l},i.createElement(Z.ZP,{templateName:o.field_name,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,component:e,companyData:k,components:I,products:O,selectedComponent:q,component_blueprint:e,editMode:X,blueprints:j,allModules:z,authenticatedUser:Y,companyUsersArray:D,companyPositionsArray:F,begunModule:E})):e.selected_fields.filter(e=>1==e.visible).length>0?i.createElement(me.x4,{key:l,style:{margin:"30px 0 0 0"}},i.createElement(M.Z,{editMode:X,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,blueprints:j,component:e,companyData:k,components:I,allModules:z,products:O,authenticatedUser:Y,selectedComponent:q,companyUsersArray:D,companyPositionsArray:F,begunModule:E}),(null===q||void 0===q?void 0:q.id)&&(null===n||void 0===n?void 0:n.value)&&oe()(null===n||void 0===n?void 0:n.value)<=(0,le.now)()&&(0,le.now)()<oe()(null===n||void 0===n?void 0:n.value).add("minutes",10)&&i.createElement(M.Z,{editMode:X,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,blueprints:j,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},n),{},{options:(0,t.Z)((0,t.Z)({},n.options),{},{start:!0})})]}),companyData:k,components:I,allModules:z,products:O,authenticatedUser:Y,selectedComponent:q,companyUsersArray:D,companyPositionsArray:F,begunModule:E,shouldDisplay:!0,isEnabled:!0})):i.createElement(me.x4,null)}):i.createElement(me.x4,null)),Q=(null===b||void 0===b||null===(d=b.component_blueprints)||void 0===d?void 0:d.length)>0?null===b||void 0===b?void 0:b.component_blueprints.map((e,l)=>{const o=e.selected_fields.find(e=>"Template"===e.data_type_name&&1==e.visible),n=e.selected_fields.find(e=>"Video"===e.data_type_name&&1==e.visible);return o?i.createElement("div",{key:l},i.createElement(Z.ZP,{templateName:o.field_name,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,component:e,companyData:k,components:I,products:O,selectedComponent:q,component_blueprint:e,editMode:X,blueprints:j,allModules:z,authenticatedUser:Y,companyUsersArray:D,companyPositionsArray:F,begunModule:E})):e.selected_fields.filter(e=>1==e.visible).length>0?i.createElement("div",{key:l,style:{margin:"30px 0 0 0"}},i.createElement(M.Z,{editMode:X,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,blueprints:j,component:e,companyData:k,components:I,allModules:z,products:O,authenticatedUser:Y,selectedComponent:q,companyUsersArray:D,companyPositionsArray:F,begunModule:E}),(null===q||void 0===q?void 0:q.id)&&(null===n||void 0===n?void 0:n.value)&&oe()(null===n||void 0===n?void 0:n.value)<=(0,le.now)()&&(0,le.now)()<oe()(null===n||void 0===n?void 0:n.value).add("minutes",10)&&i.createElement(M.Z,{editMode:X,nextButtonClicked:C,isMandatoryError:S,blueprintIndex:l,setIsMandatoryError:x,blueprints:j,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},n),{},{options:(0,t.Z)((0,t.Z)({},n.options),{},{start:!0})})]}),companyData:k,components:I,allModules:z,products:O,authenticatedUser:Y,selectedComponent:q,companyUsersArray:D,companyPositionsArray:F,begunModule:E,shouldDisplay:!0,isEnabled:!0})):i.createElement(i.Fragment,null)}):i.createElement(i.Fragment,null),[K,$]=(0,i.useState)({currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:{lg:b.options.layout},editing:N});return i.createElement("div",null,i.createElement(s.j3,{permissions:[s.po.processes.create]},i.createElement("button",{onClick:()=>{J=K.layouts.lg.map(e=>(0,t.Z)((0,t.Z)({},e),{},{static:!1})),$((0,t.Z)((0,t.Z)({},K),{},{layouts:{lg:J},editing:!K.editing}))},hidden:!K.editing},"Edit Layout"),i.createElement("button",{onClick:()=>{const e=J.map(e=>(0,t.Z)((0,t.Z)({},e),{},{static:!0}));(0,r.T5)({options:(0,t.Z)((0,t.Z)({},b.options),{},{layout:e})},b.id,!0).pipe((0,m.P)()).subscribe({next:l=>{$((0,t.Z)((0,t.Z)({},K),{},{layouts:{lg:e},editing:!K.editing}))},error:e=>{$((0,t.Z)((0,t.Z)({},K),{},{layouts:{lg:b.options.layout},editing:!K.editing}))}})},hidden:!K.editing},"Save Layout")),null!==b&&void 0!==b&&null!==(a=b.options)&&void 0!==a&&a.tabbed&&!A.tq||null!==b&&void 0!==b&&null!==(u=b.options)&&void 0!==u&&u.tabbed&&(null===b||void 0===b?void 0:b.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||Y.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).length)<3?H:Q,"product"===(null===(v=E.processModule.module)||void 0===v?void 0:v.options.outputTo)&&(null===b||void 0===b?void 0:b.is_end)&&i.createElement(w,{nextButtonClicked:C,isMandatoryError:S,setIsMandatoryError:x,component:{}}),((null===q||void 0===q||null===(p=q.created_by)||void 0===p?void 0:p.id)===Y.id||(null===(c=E.processModule)||void 0===c?void 0:c.user_id)===Y.id)&&(null===(_=E.processModule.module)||void 0===_?void 0:_.options.forSpecificUsers)&&(null===b||void 0===b?void 0:b.is_end)&&i.createElement("div",{style:{border:"1px dashed var(--app-color-gray-lighter)",marginTop:"100px",borderRadius:"8px 8px 0 0"}},i.createElement("p",{className:n.title},"Shares"),(()=>{var e;return i.createElement(s.jL,{ungrouped:!0,ttitle:"Select users to share this item:",columned:!0,withAckButton:!1},i.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select users to share this item:"),i.createElement(B.Cm,{style:{width:"50%"},id:"Users",tagEmplacement:"inlined",searchable:!1,items:G,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_users)||void 0===e?void 0:e.map(e=>G.find(l=>l.value===e.id)),className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?(U(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.value)),null!==q&&void 0!==q&&q.id&&(q.shared_users=null===e||void 0===e?void 0:e.map(e=>({id:null===e||void 0===e?void 0:e.value})))):U([])}}))})(),(()=>{var e;return i.createElement(s.jL,{ungrouped:!0,columned:!0,withAckButton:!1},i.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select positions to share this item:"),i.createElement(B.Cm,{style:{width:"50%"},id:"Positions",tagEmplacement:"inlined",searchable:!1,items:F,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_positions)||void 0===e?void 0:e.map(e=>F.find(l=>l.value===e.id)),className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?(T(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.value)),null!==q&&void 0!==q&&q.id&&(q.shared_positions=null===e||void 0===e?void 0:e.map(e=>({id:null===e||void 0===e?void 0:e.value})))):T([])}}))})()),(null===(f=E.processModule.module)||void 0===f?void 0:f.options.forSpecificUsers)&&(null===b||void 0===b?void 0:b.is_end)&&i.createElement("div",{style:{height:"200px"}}),(null===b||void 0===b?void 0:b.is_end)&&(void 0===(null===q||void 0===q?void 0:q.is_complete)||0==(null===q||void 0===q?void 0:q.is_complete))&&(()=>{var e,l,o;return i.createElement("div",{className:n.emptyElementsSection,style:{width:"260px",padding:"0px 0px 0px 20px"}},i.createElement(s.pd,{id:"draft",title:"Save as draft?",ungrouped:!0,withAckButton:!1,style:{margin:"20px 2.5% 10px 5px",width:"auto",display:null!==E&&void 0!==E&&null!==(e=E.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.nosave?"none":""},value:!V,toggleSelected:e=>{var l,o,t;(L(!e),null!==q&&void 0!==q&&q.id)&&(q.status=e?"Draft":null!==E&&void 0!==E&&null!==(l=E.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(t=o.options)&&void 0!==t&&t.lock?"New":"None")}}))})(),(null===b||void 0===b||null===(g=b.pathway_steps)||void 0===g?void 0:g.length)>0&&(()=>{const e=b.pathway_steps.map(e=>({label:"".concat(e.name),value:e.id})),l=D.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}));return i.createElement("div",{className:n.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(l.length*l.length>4?70:200,"px")}},i.createElement(P.Z,{visible:!0,mandatory:!1,items:e,onChange:e=>{R(e)},placeholder:"Continue to this step..."}))})(),(null===b||void 0===b||null===(y=b.pathway_processes)||void 0===y?void 0:y.length)>0&&(()=>{const e=b.pathway_processes.map(e=>({label:"".concat(e.name),value:e.id})),l=D.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}));return i.createElement("div",{className:n.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(l.length*l.length>4?70:200,"px")}},i.createElement(P.Z,{visible:!0,mandatory:!1,items:e,onChange:()=>{},placeholder:"Continue to this process..."}))})(),e.children)}),he=e=>{var l,o,t,d,a,s;const{selectedComponent:u,companyPositionsArray:r,companyUsersArray:v}=e;return i.createElement("div",{style:{width:"100%"}},((null===u||void 0===u||null===(l=u.shared_users)||void 0===l?void 0:l.length)>0||(null===u||void 0===u||null===(o=u.shared_positions)||void 0===o?void 0:o.length)>0)&&i.createElement("div",{className:n.accordionContainer},i.createElement("p",{className:n.cardTitle},"Shares"),i.createElement("div",{style:{display:"flex"}},i.createElement(S.D,{width:A.tq?"100%":"45%",fieldLabel:"Positions",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===u||void 0===u||null===(t=u.shared_positions)||void 0===t?void 0:t.length)>0&&i.createElement(y.default,{withColumns:!1,className:n.sharesTable,columns:["Position"],list:null===u||void 0===u||null===(d=u.shared_positions)||void 0===d?void 0:d.map(e=>{const l=null===r||void 0===r?void 0:r.find(l=>l.value===e.id);return{Position:null===l||void 0===l?void 0:l.label}})})),i.createElement(S.D,{width:A.tq?"100%":"45%",fieldLabel:"Users",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===u||void 0===u||null===(a=u.shared_users)||void 0===a?void 0:a.length)>0&&i.createElement(y.default,{withColumns:!1,className:n.sharesTable,columns:["User"],list:null===u||void 0===u||null===(s=u.shared_users)||void 0===s?void 0:s.map(e=>{const l=null===v||void 0===v?void 0:v.find(l=>l.id===e.id);return{User:"".concat(null===l||void 0===l?void 0:l.first_name," ").concat(null===l||void 0===l?void 0:l.last_name)}})})))))},ge=i.forwardRef((e,l)=>{var o,d,a,s,u,r;const{begunModule:v,allModules:p,companyData:c,selectedComponent:m,setSelectedComponent:_,companyUsersArray:f,companyPositionsArray:h,print:y,components:M=[],bypassCustom:b=!1,authenticatedUser:S,setIsOpen:C=()=>{}}=e,[x,E]=(0,i.useState)([]),w=null===v||void 0===v||null===(o=v.processModule)||void 0===o||null===(d=o.steps)||void 0===d||null===(a=d.find(e=>e.component_blueprints.filter(e=>{var l;return null===(l=e.selected_fields)||void 0===l?void 0:l.find(e=>"Template"===e.data_type_name)}).length>0))||void 0===a||null===(s=a.component_blueprints)||void 0===s||null===(u=s.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Template"===e.data_type_name&&!0===e.visible).length)>0}))||void 0===u||null===(r=u.selected_fields)||void 0===r?void 0:r.find(e=>"Template"===e.data_type_name),k=()=>{var e,l,o,n;const d=null===v||void 0===v||null===(e=v.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.find(e=>e.component_blueprints.filter(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name))}).length>0),a=null===d||void 0===d||null===(o=d.component_blueprints)||void 0===o?void 0:o.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Transaction List"===e.data_type_name&&!0===e.visible).length)>0});return i.createElement(Z.ij,{selectedComponent:m,templateName:null===w||void 0===w?void 0:w.field_name,component_blueprint:a,template:w,companyUsersArray:f,begunModule:v,companyData:c,authenticatedUser:S},a&&i.createElement(g.dh,{key:0,field:null===(n=a.selected_fields)||void 0===n?void 0:n.find(e=>"Transaction List"===e.data_type_name),selectedComponent:m,companyUsersArray:f,component:(0,t.Z)((0,t.Z)({},a),{},{created_date:m.created_date,values:[]})}))};return(0,i.useEffect)(()=>{var o,d,a;let s=[];if(G.Z(X.Z("group"))(null!==(o=null===m||void 0===m?void 0:m.component_fields)&&void 0!==o?o:[]).map(e=>{s=[...s,{id:e.component_blueprint_id,selected_fields:$.Z(ee.Z("group",e.group))(m.component_fields)}]}),(null===v||void 0===v||null===(d=v.processModule)||void 0===d||null===(a=d.completeSteps)||void 0===a?void 0:a.length)>0){var u,r,x,w;let o=[i.createElement("div",{key:0,style:{display:null!==e&&void 0!==e&&e.noHeader?"none":"",height:"auto",padding:"20px"}},y&&(null!==c&&void 0!==c&&c.logo?i.createElement("img",{className:n.imageLogoPrint,alt:"lg",onError:e=>e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg",src:null!==(u=null===c||void 0===c?void 0:c.logo)&&void 0!==u?u:"https://i.quotev.com/b2gtjqawaaaa.jpg"}):i.createElement("div",{style:{padding:"20px"}},(0,O.lh)("30px","var(--app-color-gray-dark)","bold"),i.createElement("div",{style:{fontSize:"12px",fontWeight:"normal",fontFamily:"var(--app-text-main-font)"}},null===c||void 0===c||null===(r=c.display_name)||void 0===r?void 0:r.toUpperCase())))),k()];var I,N,P,D,U,T,q,B,R,Y,L,F,W;if(v.processModule.completeSteps.map(e=>{e.component_blueprints.filter(e=>{var l,o;return 0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asModuleList)||void 0==(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.asModuleList)}).map((l,n)=>{var d,a,u;const r=null!==(d=null===m||void 0===m||null===(a=m.component_fields)||void 0===a?void 0:a.filter(e=>e.component_blueprint_id===l.id))&&void 0!==d?d:[];null===r||void 0===r||r.find(e=>!(""===e.value||void 0===e.value||null===e.value));var _,h,y;(null===r||void 0===r?void 0:r.length)>0&&(null===(u=l.selected_fields)||void 0===u?void 0:u.filter(e=>1==e.visible).length)>0&&(o=null!==l.options?[...o,i.createElement("div",{key:o.length,style:{display:""}},i.createElement(g.ZP,{setIsOpen:C,step:e,isInherited:!1,nextButtonClicked:()=>{},isMandatoryError:!1,stepId:e.id,blueprintIndex:n,setIsMandatoryError:()=>{},component:(0,t.Z)((0,t.Z)({},l),{},{created_date:m.created_date,values:null!==(_=null===(h=s.find(e=>e.id===l.id))||void 0===h?void 0:h.selected_fields)&&void 0!==_?_:[]}),begunModule:v,allModules:p,companyData:c,components:s,allComponents:M,companyUsersArray:f,selectedComponent:m}))]:[...o,i.createElement("div",{key:o.length},i.createElement(g.ZP,{setIsOpen:C,step:e,isInherited:!1,nextButtonClicked:()=>{},isMandatoryError:!1,stepId:e.id,blueprintIndex:n,setIsMandatoryError:()=>{},component:(0,t.Z)((0,t.Z)({},l),{},{created_date:m.created_date,values:null===(y=s.find(e=>e.id===l.id))||void 0===y?void 0:y.selected_fields}),begunModule:v,allModules:p,companyData:c,components:s,allComponents:M,companyUsersArray:f,selectedComponent:m}))])})}),null!==v&&void 0!==v&&null!==(x=v.processModule)&&void 0!==x&&null!==(w=x.completeSteps)&&void 0!==w&&w.find(e=>{var l;return(null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>"Template"===e.data_type_name).length>0).length)>0&&0==b}))E(i.createElement(Z.C6,{ref:l,print:y,begunModule:v,allModules:p,companyData:c,components:M,selectedComponent:m,setSelectedComponent:_,companyUsersArray:f,companyPositionsArray:h,payments:i.createElement(g.$p,{component:m}),creator:i.createElement(g.Xo,{component:m,show:null===v||void 0===v||null===(I=v.processModule)||void 0===I||null===(N=I.module)||void 0===N||null===(P=N.options)||void 0===P?void 0:P.anonymous,process:null===v||void 0===v?void 0:v.processModule}),shares:(null===v||void 0===v||null===(D=v.processModule)||void 0===D||null===(U=D.module)||void 0===U||null===(T=U.options)||void 0===T?void 0:T.forSpecificUsers)&&i.createElement(he,{key:o.length+3,selectedComponent:m,companyUsersArray:f,companyPositionsArray:h})},o));else E([i.createElement("div",{style:{display:A.tq?"none":"flex",width:"100%",alignContent:"space-between"}},i.createElement("div",{className:n.cardTitle,style:{fontSize:"18px",padding:"10px 0",width:"100%"}},m.status&&"None"!==m.status&&i.createElement(i.Fragment,null,i.createElement("span",{style:{fontWeight:"normal",fontSize:"16px"}},"Status : ")," ",m.status)),",",i.createElement("label",{className:n.checkboxLabelClass},"Show all fields",i.createElement("input",{type:"checkbox",defaultChecked:null===m||void 0===m?void 0:m.show,onChange:e=>{_((0,t.Z)((0,t.Z)({},m),{},{show:e.target.checked}))}}))),...o,i.createElement(g.$p,{component:m,key:o.length+1}),(null===v||void 0===v||null===(q=v.processModule)||void 0===q||null===(B=q.module)||void 0===B||null===(R=B.options)||void 0===R?void 0:R.forSpecificUsers)&&(null===S||void 0===S?void 0:S.id)===(null===(Y=m.created_by)||void 0===Y?void 0:Y.id)&&i.createElement(he,{key:o.length+2,selectedComponent:m,companyUsersArray:f,companyPositionsArray:h}),i.createElement(g.Xo,{component:m,key:o.length+3,show:null===v||void 0===v||null===(L=v.processModule)||void 0===L||null===(F=L.module)||void 0===F||null===(W=F.options)||void 0===W?void 0:W.anonymous,process:null===v||void 0===v?void 0:v.processModule})])}},[m,y]),i.createElement("div",{ref:l,style:{padding:y?"50px 0px 50px 0px":"20px",alignSelf:"center",backgroundColor:"white",margin:"auto",width:A.tq?"100%":(0,Z.ev)(null===w||void 0===w?void 0:w.field_name)}},x,e.children)}),ye=(0,a.$j)(e=>{const{begunModule:l,allModules:o,companyData:t,components:i,rememberPath:n,lastUpdates:d,companyUsersArray:a,products:s,transactions:u,companyProcesses:r,companyPositionsArray:v,cart:p,blueprints:c,allTasks:m,axiosAbort:_}=e.flowReducer,{authenticatedUser:f}=e.authReducer;return{begunModule:l,allModules:o,companyData:t,components:i,rememberPath:n,lastUpdates:d,companyUsersArray:a,products:s,transactions:u,companyProcesses:r,authenticatedUser:f,companyPositionsArray:v,cart:p,blueprints:c,allTasks:m,axiosAbort:_}},e=>({onSetSelectedProcess:l=>e((0,c.Xu)(l))}))(function(l){var o,a,h,g,M,b,S,C,x,w,I,D,me,he,ye,Me,be,Se,Ce,xe,Ee,we,Ze,ke,Ie,Ne,Pe,De,Ue,Te,Oe,qe,Ae,Be,Re,Ye,Le,Fe,We,je,ze,Ge,Xe,Ve,Je,He,Qe,Ke,$e,el,ll,ol,tl,il,nl,dl,al,sl,ul,rl,vl,pl,cl,ml,_l,fl,hl,gl,yl,Ml,bl,Sl,Cl,xl,El,wl,Zl,kl,Il,Nl,Pl,Dl,Ul,Tl,Ol,ql,Al,Bl,Rl,Yl,Ll,Fl,Wl,jl,zl,Gl,Xl,Vl,Jl,Hl,Ql,Kl,$l,eo,lo,oo,to,io,no,ao,so,uo,ro,vo,po,co,mo;const{navigateTo:_o,begunModule:fo,allModules:ho,companyData:go,components:yo,isEditing:Mo,lastUpdates:bo,companyUsersArray:So,products:Co,onSetSelectedProcess:xo,children:Eo,authenticatedUser:wo,companyPositionsArray:Zo,cart:ko,blueprints:Io,paymentID:No,companyProcesses:Po,allTasks:Do,axiosAbort:Uo}=l,[To]=(0,i.useState)(1),[Oo,qo]=(0,i.useState)(!1),[Ao,Bo]=(0,i.useState)(!1),[Ro,Yo]=(0,i.useState)(""),[Lo,Fo]=(0,i.useState)(!1),[Wo,jo]=(0,f.pQ)(),[zo,Go]=(0,i.useState)(!1),[Xo,Vo]=(0,i.useState)(1==(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o?void 0:o.isUpdating)),[Jo,Ho]=(0,i.useState)(null!==(a=null===fo||void 0===fo||null===(h=fo.processModule)||void 0===h?void 0:h.selectedComponent)&&void 0!==a?a:{}),[Qo,Ko]=(0,i.useState)(null===(g=null===Jo||void 0===Jo?void 0:Jo.is_complete)||void 0===g||g),[$o,et]=(0,i.useState)([]),[lt,ot]=(0,i.useState)([]),[tt,it]=(0,i.useState)(!1),[nt,dt]=(0,i.useState)(!1),[at,st]=(0,i.useState)(!1),[ut,rt]=(0,i.useState)(!1),[vt,pt]=(0,i.useState)(!1),[ct,mt]=(0,i.useState)(!1),[_t,ft]=(0,i.useState)(!1),[ht,gt]=(0,i.useState)(!1),[yt,Mt]=(0,i.useState)(!1),[bt,St]=(0,i.useState)(!1),[Ct,xt]=(0,i.useState)([]),[Et,wt]=(0,i.useState)([]),[Zt,kt]=(0,i.useState)([]),[It,Nt]=(0,i.useState)({list:[],operator:"AND"}),[Pt,Dt]=(0,i.useState)([]),[Ut,Tt]=(0,i.useState)([]),[Ot,qt]=(0,i.useState)(!1),[At,Bt]=(0,i.useState)(!1),[Rt,Yt]=(0,i.useState)(!1),[Lt,Ft]=(0,i.useState)(!1),[Wt,jt]=(0,i.useState)("false"!==localStorage.getItem("showAds")&&(null!==(M=oe()(+localStorage.getItem("showAdsDate")).format("DD MMM YYYY")!==oe()((0,le.now)()).format("DD MMM YYYY"))&&void 0!==M&&M)),[zt,Gt]=(0,i.useState)(1),Xt=(0,ne.s0)(),Vt=(null===fo||void 0===fo||null===(b=fo.processModule)||void 0===b||null===(S=b.steps)||void 0===S?void 0:S.length)>0?null===fo||void 0===fo||null===(C=fo.processModule)||void 0===C?void 0:C.steps[fo.processModule.stepIndex]:{},Jt=(null===fo||void 0===fo||null===(x=fo.processModule)||void 0===x||null===(w=x.steps)||void 0===w?void 0:w.length)>0?null===(I=fo.processModule.steps[fo.processModule.stepIndex])||void 0===I?void 0:I.pathway_steps:[],Ht=(null===fo||void 0===fo||null===(D=fo.processModule)||void 0===D||null===(me=D.steps)||void 0===me?void 0:me.length)>0?null===(he=fo.processModule.steps[fo.processModule.stepIndex])||void 0===he?void 0:he.pathway_processes:[];let Qt=(0,i.useRef)();(0,i.useEffect)(()=>{let e=So.filter(e=>0==e.departments.length).map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id,department:"General",user:e}));So.filter(e=>e.departments.length>0).filter(l=>{l.departments.filter(o=>{e=[...e,{label:"".concat(l.first_name," ").concat(l.last_name),value:l.id,department:null===o||void 0===o?void 0:o.name,user:l}]})}),Dt(e)},[So]),(0,i.useEffect)(()=>{var e,l;if((null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&!bt){var o,t;Nt({list:[],operator:"AND"}),void 0!==(null===_o||void 0===_o?void 0:_o.key)?xt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,yo,_o.value,_o.key)):xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}));let e={id:""},l=[],i=[];const n=o=>{o.component_fields.map(t=>{var n,d;o.procedure_id!==(null===_e||void 0===_e?void 0:_e.id)&&(e=Po.find(e=>e.id===o.procedure_id),null!==(n=e)&&void 0!==n&&n.steps&&(l=Y.Z(L.Z("component_blueprints"),F.Z)(null===(d=e)||void 0===d?void 0:d.steps),i=Y.Z(L.Z("selected_fields"),F.Z)(l)));const a=i.find(e=>e.procedure_step_blueprint_field_id===t.procedure_step_blueprint_field_id);var s;a&&(t.data_type_name=a.data_type_name,t.data_type=a.data_type,t.field_name=a.field_name,t.options=a.options,t.component_blueprint_id=null===(s=l.find(e=>e.selected_fields.filter(e=>e.procedure_step_blueprint_field_id===t.procedure_step_blueprint_field_id).length>0))||void 0===s?void 0:s.id)})};W.Z(n,yo.filter(e=>{var l;return(null!==(l=null===e||void 0===e?void 0:e.component_fields)&&void 0!==l?l:[]).filter(e=>void 0===(null===e||void 0===e?void 0:e.field_name)).length>0}))}},[null===fo||void 0===fo||null===(ye=fo.processModule)||void 0===ye?void 0:ye.steps,yo]),(0,i.useEffect)(()=>{if(No){var e;const a=JSON.parse(localStorage.getItem("forPayment")),s=null===(e=a.component_fields)||void 0===e?void 0:e.find(e=>"Payments"===e.data_type_name);var l;if(s)if(2===(null===(l=a.component_fields)||void 0===l?void 0:l.filter(e=>e.field_name===s.options.paymentField||e.value===No).length)){var o,t,i,n,d;const e=null===(o=a.component_fields)||void 0===o?void 0:o.find(e=>e.field_name===s.options.paymentField);dt(!0),(0,de.e_)({user_id:wo.id,id:a.id,total:null!==(t=+(null===e||void 0===e?void 0:e.value))&&void 0!==t?t:0,product:"CR-".concat(null!==(i=null===a||void 0===a?void 0:a.title)&&void 0!==i?i:null===fo||void 0===fo||null===(n=fo.processModule)||void 0===n||null===(d=n.module)||void 0===d?void 0:d.name," ").concat(No),notes:"E-Payment",quantity:1}).pipe((0,m.P)()).subscribe({next:e=>{dt(!1),Mt(!0),(0,u.tE)(null===a||void 0===a?void 0:a.id,"Paid").pipe((0,m.P)()).subscribe({next:e=>{localStorage.removeItem("forPayment"),fo.processModule.selectedComponent=e,Ho(e)}})}})}else dt(!1),p.h.dispatch((0,c.Xc)({show:!0,message:"Payment #".concat(No," was received but transaction was not matched, please report this to your administrator"),color:"red",bottom:!0}))}},[No]),(0,i.useEffect)(()=>{var e,l,o,t;(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&!bt&&(void 0!==_o.key||""!==_o.key)&&xt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,yo,_o.value))},[_o]),(0,i.useEffect)(()=>{var e,l,o,t,i;null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.selectedComponent)&&void 0!==l&&l.id&&Jo.id!==(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.selectedComponent)||void 0===t?void 0:t.id)&&Ho(null===fo||void 0===fo||null===(i=fo.processModule)||void 0===i?void 0:i.selectedComponent)},[null===fo||void 0===fo||null===(Me=fo.processModule)||void 0===Me?void 0:Me.selectedComponent]),(0,i.useEffect)(()=>{localStorage.getItem("transaction")&&!zo&&localStorage.getItem("transaction")===Jo.id&&Yt(!0)},[Jo,zo]);const Kt=(0,i.useCallback)(()=>{let e=!1;return Vt.component_blueprints.filter(e=>{var l,o;return null===e.options||(!1===(null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)||void 0===(null===(o=e.options)||void 0===o?void 0:o.allowMultipleInputs))}).some(e=>{var l;return!0===(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Summary"!==e.data_type_name&&"Profile"!==e.data_type_name&&"ID"!==e.data_type_name&&"Info"!==e.data_type_name&&"Notes"!==e.data_type_name&&"URL"!==e.data_type_name&&"Emails"!==e.data_type_name&&"Template"!==e.data_type_name&&"Global"!==e.data_type_name&&"Chart"!==e.data_type_name&&"Value"!==e.data_type_name).some(e=>{var l;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.length)<1)}))})&&(console.log("with manadatory errors",Vt.component_blueprints),e=!0),!0===e?(Bo(!0),!0):(Yo(""),Bo(!1),!1)},[Vt]),$t=e=>{Fo(!0),Kt()&&!1===Xo?ni():li(e)},ei=e=>{Wo.components=[],Wo.items=[],Wo.currentStep={},Wo.newStepComponents=[],fo.processModule.steps.filter(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>e.value=void 0))),fo.processModule.isUpdating=!1,p.h.dispatch((0,c.wM)({routes:{},pins:""})),Vo(!1),Go(!1),Fo(!0),li(e),go.start=!1,(0,v.aK)().pipe((0,m.P)()).subscribe({next:()=>{}})},li=function(e){Fo(!1),Bo(!1),qo(!1);let l={};if(void 0===e){if(l=fo.processModule.steps[fo.processModule.stepIndex+1],void 0===l)return void p.h.dispatch((0,c.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));jo({action:f._U.setCurrentStep,value:l}),p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:fo.processModule.stepIndex+1})))}else{if(l=fo.processModule.steps.find(l=>l.id===e),void 0==l)l=fo.processModule.steps[fo.processModule.stepIndex+1],p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:fo.processModule.stepIndex+1})));else{var o;if(void 0===fo.processModule.steps[(null===(o=l)||void 0===o?void 0:o.rank)-1])return void p.h.dispatch((0,c.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));var i;p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:(null===(i=l)||void 0===i?void 0:i.rank)-1})))}jo({action:f._U.setCurrentStep,value:l})}const n=Wo.newStepComponents.filter(e=>null===e.options||(void 0===e.allowMultipleInputs||!1===e.options.allowMultipleInputs));jo({action:f._U.setComponents,value:[...Wo.components.filter(e=>n.every(l=>l.id!==e.id)),...j.Z(e=>e.selected_fields.filter(e=>""===e.value).length>0,n)]}),jo({action:f._U.setModuleNewStepComponents,value:l.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Status"===e.data_type_name||"ID"===e.data_type_name||"Value"===e.data_type_name).length>0)})},oi=()=>{jo({action:f._U.setModuleItems,value:[]}),jo({action:f._U.setComponents,value:[]}),jo({action:f._U.addModuleComponents,value:[]}),jo({action:f._U.setModuleNewStepComponents,value:[]}),ei(fo.processModule.steps[0].id)},ti=()=>{var e,l,o,i,n,d,a,s,r,v,_,f,h,g,y,M,b,S,C;if(Kt())return Yo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),void qo(!1);const x=Wo.newStepComponents,E=[...Wo.components.filter(e=>x.every(l=>l.id!==e.id)),...j.Z(e=>{var l;return e.selected_fields.filter(e=>""===e.value||null===e.value||!(null!==e&&void 0!==e&&e.value)).length===(null===(l=e.selected_fields)||void 0===l?void 0:l.length)},x)];let w,Z,k=[],I=[],N="",P="",D=!1,U=Xo?null===Jo||void 0===Jo?void 0:Jo.status:null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.lock?"New":"None",T=[];const q=null===Jo||void 0===Jo?void 0:Jo.status,A={};let B=Xo?(null!==(i=z.Z(Math.max,L.Z("group",G.Z(X.Z("group"))(null!==(n=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==n?n:[]))))&&void 0!==i?i:-1)+1:0;E.map((e,l)=>{var o,i;let n=l;const d=null===(o=e.selected_fields.filter(e=>"Record"===e.data_type_name||"Filters"===e.data_type_name))||void 0===o?void 0:o.find(e=>+(null===e||void 0===e?void 0:e.group)>=0);d&&Xo?n=d.group:Xo&&(n=B,B++),e.selected_fields.filter(e=>("Record"===e.data_type_name||"Filters"===e.data_type_name)&&!0===e.visible).map((e,l)=>{var o;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){var i,d;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})],N=e.value,A[e.field_name]=e.value;const o=null===(i=yo.find(l=>l.component_fields.filter(l=>{var o;return l.component_blueprint_id===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.component_id)&&(null===l||void 0===l?void 0:l.value)===N}).length>0))||void 0===i||null===(d=i.component_fields.find(e=>"Email Recipient"===e.data_type_name))||void 0===d?void 0:d.value;o&&(w=o)}});const a=null===(i=e.selected_fields.filter(e=>!("Record"===e.data_type_name||"Filters"===e.data_type_name)))||void 0===i?void 0:i.find(e=>+(null===e||void 0===e?void 0:e.group)>=0);a&&Xo?n=a.group:Xo&&(n=B,B++),e.selected_fields.filter(e=>!("Record"===e.data_type_name||"Filters"===e.data_type_name||"Module"===e.data_type_name)).map((e,l)=>{var o,i,d,a;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){if(A[e.field_name]=e.value,"ID"===(null===e||void 0===e?void 0:e.data_type_name))null!==fo&&void 0!==fo&&null!==(d=fo.processModule)&&void 0!==d&&d.isUpdating?I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})]:(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n,value:"".concat(null===e||void 0===e?void 0:e.options.id).concat(null===(null===go||void 0===go?void 0:go.misc_info)?1:null!==(a=null===go||void 0===go?void 0:go.misc_info[null===e||void 0===e?void 0:e.field_name])&&void 0!==a?a:1)})],k=[...k,"".concat(e.field_name)]);else if("Value"===(null===e||void 0===e?void 0:e.data_type_name)){var s;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e||null===(s=e.options)||void 0===s?void 0:s.value,group:n})]}else if("Email Recipient"===(null===e||void 0===e?void 0:e.data_type_name))I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:e.value.replace(/ /g,""),group:n})];else if("Product Lookup"===e.data_type_name)I=[...I];else if("Status"===e.data_type_name&&"Draft"===e.value&&1==Qo)D=!0,I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"New",group:n})],U="New";else if("Status"===e.data_type_name)I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e?void 0:e.value,group:n})],U=null===e||void 0===e?void 0:e.value;else if("Positions"===e.data_type_name&&!0===(null===e||void 0===e||null===(i=e.options)||void 0===i?void 0:i.share))I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e?void 0:e.value,group:n})],T=[null===e||void 0===e?void 0:e.value];else if("Formula"===e.data_type_name){var u;const o=null!==fo&&void 0!==fo&&null!==(u=fo.processModule)&&void 0!==u&&u.isUpdating?(0,O.LV)(null===e||void 0===e?void 0:e.options,Jo.component_fields.filter(l=>{var o;return null===(o=e.options)||void 0===o?void 0:o.list.includes(l.field_name)}),E,Wo.items):e.value;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:o.toString(),group:n})]}else if("output"!==e.data_type){var r,v,p,c;if("People"===e.data_type_name){var m,_,f,h,g;if(!0===(null===(m=e.options)||void 0===m?void 0:m.email)){var y,M;const l=null===(y=Pt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===y||null===(M=y.user)||void 0===M?void 0:M.email;P=l?P.concat(P.length>0?",".concat(l):l):P,e.email=void 0}if(!0===(null===(_=e.options)||void 0===_?void 0:_.assign))Z=null===(h=Pt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===h||null===(g=h.user)||void 0===g?void 0:g.id,Xo&&(Jo.assigned_to={id:Z});if(!0===(null===(f=e.options)||void 0===f?void 0:f.share)){var b,S;const l=null===(b=Pt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===b||null===(S=b.user)||void 0===S?void 0:S.id;l&&($o.push(l),Xo&&Jo.shared_users.push({id:l}))}}"email"===(null===e||void 0===e||null===(r=e.options)||void 0===r?void 0:r.actionToPerform2)&&null!==e&&void 0!==e&&null!==(v=e.options)&&void 0!==v&&null!==(p=v.valueToMatch2)&&void 0!==p&&null!==(c=p.split(","))&&void 0!==c&&c.includes(null===e||void 0===e?void 0:e.value)&&w&&(D=!0,P=P.concat(P.length>0?",".concat(w):w)),I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})]}}else if("Status"===(null===e||void 0===e?void 0:e.data_type_name))1==Qo?(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"New",group:n})],U="New"):(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"Draft",group:n})],U="Draft"),A[e.field_name]=e.value;else if("Action Button"===(null===e||void 0===e?void 0:e.data_type_name)){var C,x,N;I=[...I],A[e.field_name]=e.value,"status"===(null===e||void 0===e||null===(C=e.options)||void 0===C?void 0:C.action)?U=e.value:"user"!==(null===(x=e.options)||void 0===x?void 0:x.action)&&"creator"!==(null===(N=e.options)||void 0===N?void 0:N.action)||(Jo.assigned_to=null===e||void 0===e?void 0:e.value)}})});let R,Y,F,W="";if((null===(d=fo.processModule)||void 0===d||null===(a=d.module)||void 0===a||null===(s=a.options)||void 0===s||null===(r=s.title)||void 0===r?void 0:r.length)>0){var V,J,H,Q,K,$,ee,le,te,ie,ne,ae,se,ve,pe;if(null===(V=fo.processModule)||void 0===V||null===(J=V.module)||void 0===J||null===(H=J.options)||void 0===H||null===(Q=H.title)||void 0===Q||Q.map(e=>{if("Info"!==e){const n=I.find(l=>l.field_name===e);var l,o,t,i;if("Date"===(null===n||void 0===n?void 0:n.data_type_name)||"Calendar"===(null===n||void 0===n?void 0:n.data_type_name))W=""===W?"".concat(oe()(null===n||void 0===n?void 0:n.value).format("DD MMMM YYYY")):"".concat(null!==(l=W)&&void 0!==l?l:"","  ").concat(oe()(null===n||void 0===n?void 0:n.value).format("DD MMMM YYYY"));else W=""===W?"".concat(null!==(o=null===n||void 0===n?void 0:n.value)&&void 0!==o?o:""):"".concat(null!==(t=W)&&void 0!==t?t:"","  ").concat(null!==(i=null===n||void 0===n?void 0:n.value)&&void 0!==i?i:"")}else{const e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});if(void 0!==e){var n,d;const l=null===(n=e.component_blueprints)||void 0===n||null===(d=n.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===d?void 0:d.find(e=>"Info"===e.data_type_name),o=yo.find(e=>{var o;return(null===(o=e.component_fields.filter(e=>{var o;return e.component_blueprint_id===l.options.component_id&&(e.value===A[l.field_name]||e.value===A[null===(o=l.options)||void 0===o?void 0:o.key])}))||void 0===o?void 0:o.length)>0});var a,s,u,r,v,p,c;if(o)if((null===l||void 0===l||null===(a=l.options)||void 0===a||null===(s=a.list)||void 0===s?void 0:s.length)>0)W=""===W?"".concat(null!==(u=null===(r=o.component_fields.find(e=>{var o;return e.field_name===(null===l||void 0===l||null===(o=l.options)||void 0===o?void 0:o.list[0])}))||void 0===r?void 0:r.value)&&void 0!==u?u:""):"".concat(null!==(v=W)&&void 0!==v?v:"","  ").concat(null!==(p=null===(c=o.component_fields.find(e=>{var o;return e.field_name===(null===l||void 0===l||null===(o=l.options)||void 0===o?void 0:o.list[0])}))||void 0===c?void 0:c.value)&&void 0!==p?p:"")}}}),null!==(K=fo.processModule)&&void 0!==K&&null!==($=K.module)&&void 0!==$&&null!==(ee=$.options)&&void 0!==ee&&ee.title.find(e=>"UUID"===e))W="".concat(null===(ne=fo.processModule)||void 0===ne||null===(ae=ne.module)||void 0===ae?void 0:ae.name," #").concat(Xo?Jo.id.replace(/\D/g,"").slice(-5):(0,O.mR)().replace(/\D/g,"").slice(-5));if(null!==(le=fo.processModule)&&void 0!==le&&null!==(te=le.module)&&void 0!==te&&null!==(ie=te.options)&&void 0!==ie&&ie.title.find(e=>"Module Name"===e))W=" ".concat(null===(se=fo.processModule)||void 0===se||null===(ve=se.module)||void 0===ve?void 0:ve.name," - ").concat(null!==(pe=W)&&void 0!==pe?pe:"")}else{var ce,me;W="".concat(null===(ce=fo.processModule)||void 0===ce||null===(me=ce.module)||void 0===me?void 0:me.name," #").concat(Xo?Jo.id.replace(/\D/g,"").slice(-5):(0,O.mR)().replace(/\D/g,"").slice(-5))}let _e,fe={};if(!0===(null===(v=fo.processModule)||void 0===v||null===(_=v.module)||void 0===_||null===(f=_.options)||void 0===f?void 0:f.emailOutputs)){var he,ge;let e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name&&1==e.options.email))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});if(void 0!==e){var ye,Me;const l=null===(ye=e.component_blueprints)||void 0===ye||null===(Me=ye.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>{var l;return"Info"===e.data_type_name&&1==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.email)}))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===Me?void 0:Me.find(e=>{var l;return"Info"===e.data_type_name&&!0===(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.email)}),o=yo.find(e=>{var o;return(null===(o=e.component_fields.filter(e=>e.component_blueprint_id===l.options.component_id&&e.value===N))||void 0===o?void 0:o.length)>0});o&&(Y=l.id,R=o.id)}if(e=fo.processModule.steps.find(e=>{var l;return!0===e.is_end&&(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Emails"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0}),void 0!==e){var be;(null===(be=e.component_blueprints)||void 0===be?void 0:be.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Emails"===e.data_type_name))||void 0===l?void 0:l.length)>0})).selected_fields.filter(e=>"Emails"===e.data_type_name).filter(e=>{var l;I.find(l=>l.value===e.options.valueToMatch&&l.field_name===e.options.fieldToMatch)&&(w&&(F=e,D=!0,!0===(null===(l=e.options)||void 0===l?void 0:l.copyEmailRecip)&&(P=P.concat(P.length>0?",".concat(w):w))))})}var Se;if(P=""===P?[]:null!==(he=P.split(","))&&void 0!==he?he:[],(Ut.length>0||P.length>0)&&(P=Xo?!0===D?[...Ut,...P]:[...Ut]:[...Ut,...P]),P.length>0&&(fe={emailTo:P}),Y&&R&&(fe=(0,t.Z)((0,t.Z)({},fe),{},{info:Y,target:R})),(null===(ge=F)||void 0===ge?void 0:ge.id.length)>0)fe=(0,t.Z)((0,t.Z)({},fe),{},{template:null===(Se=F)||void 0===Se?void 0:Se.id})}if(!0===(null===(h=fo.processModule)||void 0===h||null===(g=h.module)||void 0===g||null===(y=g.options)||void 0===y?void 0:y.rewards)&&q!==U){const e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Rewards"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});var Ce,xe,Ee,we,Ze,ke;if(void 0!==e)if(_e=null===(Ce=e.component_blueprints)||void 0===Ce||null===(xe=Ce.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Rewards"===e.data_type_name))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===xe?void 0:xe.find(e=>"Rewards"===e.data_type_name),_e.options.status===U)wo.options.rewards=+(null!==(Ee=null===wo||void 0===wo||null===(we=wo.options)||void 0===we?void 0:we.rewards)&&void 0!==Ee?Ee:0)+ +(null===(Ze=_e)||void 0===Ze||null===(ke=Ze.options)||void 0===ke?void 0:ke.points)}var Ie,Ne,Pe,De,Ue,Te,Oe,qe,Ae,Be,Re,Ye,Le,Fe,We,je,ze,Ge,Xe,Ve,Je,He,Qe,Ke,$e,el,ll,ol,tl,il;null!==(M=fo.processModule)&&void 0!==M&&null!==(b=M.module)&&void 0!==b&&null!==(S=b.options)&&void 0!==S&&S.close&&(U=(null===(Ie=fo.processModule)||void 0===Ie||null===(Ne=Ie.module)||void 0===Ne||null===(Pe=Ne.options)||void 0===Pe||null===(De=Pe.lock)||void 0===De?void 0:De.length)>0?(null!==(Ue=null===(Te=fo.processModule)||void 0===Te||null===(Oe=Te.module)||void 0===Oe||null===(qe=Oe.options)||void 0===qe?void 0:qe.lock)&&void 0!==Ue?Ue:"").split(",")[0]:null!==(Ae=null===go||void 0===go||null===(Be=go.misc_info)||void 0===Be?void 0:Be.lock)&&void 0!==Ae?Ae:"Close");(null===(C=I)||void 0===C?void 0:C.length)>0?(dt(!0),Xo?(Jo.options=fe,Jo.status=U,null!==Wo&&void 0!==Wo&&Wo.assigned_to&&(Jo.assigned_to={id:null===Wo||void 0===Wo?void 0:Wo.assigned_to}),(0,u.KL)((0,t.Z)((0,t.Z)({},Jo),{},{selected_fields:[...I],component_items:Wo.items}),Jo.id,null===Jo||void 0===Jo||null===(Re=Jo.shared_users)||void 0===Re?void 0:Re.map(e=>null===e||void 0===e?void 0:e.id),W,Qo,(null===(Ye=fo.processModule)||void 0===Ye||null===(Le=Ye.module)||void 0===Le||null===(Fe=Le.options)||void 0===Fe||null===(We=Fe.shares)||void 0===We?void 0:We.length)>0?[...null!==(je=null===(ze=fo.processModule)||void 0===ze||null===(Ge=ze.module)||void 0===Ge||null===(Xe=Ge.options)||void 0===Xe?void 0:Xe.shares)&&void 0!==je?je:[],...T]:[...null!==(Ve=null===Jo||void 0===Jo||null===(Je=Jo.shared_positions)||void 0===Je?void 0:Je.map(e=>null===e||void 0===e?void 0:e.id))&&void 0!==Ve?Ve:[],...T]).subscribe({error:e=>{p.h.dispatch((0,c.Xc)({show:!0,message:"Errors found",color:"red"}))},next:e=>{var l,o,i,n,d,a,s;if(fo.processModule.selectedComponent=e.data,Ho(e.data),Wo.id=null===e||void 0===e?void 0:e.data.id,null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.single)return localStorage.setItem(null===(a=fo.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(null===e||void 0===e?void 0:e.data)),void li(null===(s=fo.processModule.steps[0])||void 0===s?void 0:s.id);const u=I.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});if(u){var r;const l=JSON.parse(null!==(r=null===u||void 0===u?void 0:u.value)&&void 0!==r?r:{task:0}),o=Do.find(e=>e.id===(null===l||void 0===l?void 0:l.task));var v,_;if(o)(0,re.xJ)((0,t.Z)((0,t.Z)({},o),{},{assignee_id:null===e||void 0===e||null===(v=e.data)||void 0===v||null===(_=v.created_by)||void 0===_?void 0:_.id}),null===o||void 0===o?void 0:o.id).pipe((0,m.P)()).subscribe({})}const f=I.find(e=>"Payments"===e.data_type_name),h=I.find(e=>{var l;return e.field_name===(null===f||void 0===f||null===(l=f.options)||void 0===l?void 0:l.paymentField)});var g;if("Closed"!==(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(!f||null!==e&&void 0!==e&&null!==(g=e.data.payments)&&void 0!==g&&g.stripe_id||"Cash"===(null===f||void 0===f?void 0:f.value)||"Wallet"===(null===f||void 0===f?void 0:f.value)||"Points"===(null===f||void 0===f?void 0:f.value))if(f){var y,M,b,S,C,x;if(h&&"Cash"!==(null===f||void 0===f?void 0:f.value)&&((null!==(y=null===(M=fo.processModule)||void 0===M||null===(b=M.module)||void 0===b||null===(S=b.options)||void 0===S?void 0:S.lock)&&void 0!==y?y:"").split(",").includes(U)||U===(null===(C=go.misc_info)||void 0===C?void 0:C.lock))&&wo.id===(null===Jo||void 0===Jo||null===(x=Jo.assigned_to)||void 0===x?void 0:x.id)&&q!==U){var E,w;const e=+(null===h||void 0===h?void 0:h.value)-+(null===h||void 0===h?void 0:h.value)*+(null!==(E=null===go||void 0===go||null===(w=go.misc_info)||void 0===w?void 0:w.rate)&&void 0!==E?E:.2);(0,de.e_)({user_id:wo.id,id:(0,O.mR)(),total:e,product:"CR-".concat(W),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var l;wo.wallet=+(+(null!==(l=null===wo||void 0===wo?void 0:wo.wallet)&&void 0!==l?l:0)+e),oi()}})}else _e?(0,ue.Vy)(wo,null===wo||void 0===wo?void 0:wo.options).pipe((0,m.P)()).subscribe({next:()=>{oi()},error:()=>p.h.dispatch((0,c.Xc)({show:!0,message:"Errors found",color:"red"}))}):oi()}else oi();else Wo.total=+(null===h||void 0===h?void 0:h.value),Wo.plan=+(null===h||void 0===h?void 0:h.value),localStorage.setItem("forPayment",JSON.stringify(e)),Bt(!0),dt(!1);else oi()},complete:()=>{dt(!1)}})):(0,u.LM)({id:E[0].id,selected_fields:[...I],component_items:Wo.items,options:fe,status:U,assigned_to:null!==(He=null===Wo||void 0===Wo?void 0:Wo.assigned_to)&&void 0!==He?He:Z},"",fo.processModule.module_id,$o,W,Qo,(null===(Qe=fo.processModule)||void 0===Qe||null===(Ke=Qe.module)||void 0===Ke||null===($e=Ke.options)||void 0===$e||null===(el=$e.shares)||void 0===el?void 0:el.length)>0?[...null!==(ll=null===(ol=fo.processModule)||void 0===ol||null===(tl=ol.module)||void 0===tl||null===(il=tl.options)||void 0===il?void 0:il.shares)&&void 0!==ll?ll:[],...T]:[...lt,...T]).subscribe({next:e=>{var l,o,i,n,d,a,s;if(fo.processModule.selectedComponent=e,Ho(e),Wo.id=null===e||void 0===e?void 0:e.id,null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.single)return localStorage.setItem(null===(a=fo.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(e)),li(null===(s=fo.processModule.steps[0])||void 0===s?void 0:s.id),void Vo(!0);k.length>0&&ii(k);const u=I.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});if(u){var r;const l=JSON.parse(null!==(r=null===u||void 0===u?void 0:u.value)&&void 0!==r?r:{task:0}),o=Do.find(e=>e.id===(null===l||void 0===l?void 0:l.task));var v;if(o)(0,re.xJ)((0,t.Z)((0,t.Z)({},o),{},{assignee_id:null===e||void 0===e||null===(v=e.created_by)||void 0===v?void 0:v.id}),null===o||void 0===o?void 0:o.id).pipe((0,m.P)()).subscribe({})}var _,f,h,g;if("Closed"!==(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(I.filter(e=>!("Cash"===(null===e||void 0===e?void 0:e.value)||"Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name).length>0)localStorage.setItem("forPayment",JSON.stringify(e)),dt(!1),Bt(!0);else if(I.filter(e=>("Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name).length>0){var y;const l=I.find(e=>"Payments"===e.data_type_name);(0,de.e_)({user_id:wo.id,id:(0,O.mR)(),total:-Wo.total,product:"DB-".concat(W),notes:null!==(y=null===l||void 0===l?void 0:l.value)&&void 0!==y?y:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var o,i;(0,ue.Vy)(wo,(0,t.Z)((0,t.Z)({},null===wo||void 0===wo?void 0:wo.options),{},{points:+(+(null!==(o=null===wo||void 0===wo||null===(i=wo.options)||void 0===i?void 0:i.points)&&void 0!==o?o:0)-("Points"===(null===l||void 0===l?void 0:l.value)?+Wo.total:0))})).pipe((0,m.P)()).subscribe({next:l=>{var o,t,i,n;wo.options=l.options,Mt((null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t||null===(i=t.options)||void 0===i||null===(n=i.message)||void 0===n?void 0:n.length)>0&&1==e.is_complete),p.h.dispatch((0,c.RV)({})),oi()}})}})}else{var M,b,S,C;dt(!1),Mt((null===fo||void 0===fo||null===(M=fo.processModule)||void 0===M||null===(b=M.module)||void 0===b||null===(S=b.options)||void 0===S||null===(C=S.message)||void 0===C?void 0:C.length)>0&&1==e.is_complete),p.h.dispatch((0,c.RV)({})),oi()}else dt(!1),Mt((null===fo||void 0===fo||null===(_=fo.processModule)||void 0===_||null===(f=_.module)||void 0===f||null===(h=f.options)||void 0===h||null===(g=h.message)||void 0===g?void 0:g.length)>0&&1==e.is_complete),p.h.dispatch((0,c.RV)({})),oi()},error:e=>{var l,o,t,i;null!==e&&void 0!==e&&e.data&&(p.h.dispatch((0,c.Xc)({show:!0,message:"Errors found",color:"red"})),null!==k&&ii(k),Mt((null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o||null===(t=o.options)||void 0===t||null===(i=t.message)||void 0===i?void 0:i.length)>0&&1==(null===e||void 0===e?void 0:e.data.is_complete)),p.h.dispatch((0,c.RV)({})),oi())},complete:()=>{dt(!1)}})):(p.h.dispatch((0,c.Xc)({show:!0,message:"There are no items to be saved",color:"red"})),window.scrollTo({top:0,behavior:"smooth"}))},ii=e=>{if((null===e||void 0===e?void 0:e.length)>0){var l;const o=null!==(l=go.misc_info)&&void 0!==l?l:{};e.filter(e=>{var l;o[e]=+(null!==(l=o[e])&&void 0!==l?l:1)+1}),dt(!0),(0,v.x5)({misc_info:o}).pipe((0,m.P)()).subscribe({})}},ni=()=>{Yo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),qo(!1)},di=function(e){let l=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(l=>l.module_id===e).filter(e=>{var i,n;return t.length>0?t.includes(e.id):""===l?e:(null===(i=e.title)||void 0===i?void 0:i.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase()))||(null===(n=e.component_fields.filter(e=>{var t,i,n,d,a,s;return"Record"===e.data_type_name?null===(t=yo.find(l=>{var o;return(null===(o=l.component_fields.filter(l=>l.field_name===e.options.output&&l.component_blueprint_id===e.options.component_id&&l.value===(null===e||void 0===e?void 0:e.value)))||void 0===o?void 0:o.length)>0}))||void 0===t||null===(i=t.component_fields.find(l=>{var o;return null===(o=e.options)||void 0===o?void 0:o.names.includes(l.field_name)}).value)||void 0===i?void 0:i.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase()):void 0!==o?("date"===e.data_type?null===(n=oe()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===n?void 0:n.format("DD MMM YYYY").includes(l):null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.includes(l))&&e.field_name===o:"date"===e.data_type?null===(a=oe()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===a?void 0:a.format("DD MMM YYYY").includes(l):null===e||void 0===e||null===(s=e.value)||void 0===s?void 0:s.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase())}))||void 0===n?void 0:n.length)>0})},ai=function(e){var l,o;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ct,a=V.Z([J.Z(H.Z("created_date"))])(d.filter(e=>e.created_by.id===(null===wo||void 0===wo?void 0:wo.id)?e:"Expired"!==e.status)).map(l=>{var o,t,d,a,s,u,r,v,p,c,m,_,f,h,g,y,M,b;const S={};l.component_fields.filter(e=>"output"!==e.data_type).forEach(e=>{S[e.field_name]=e.value}),e.list.map(e=>{const o=l.component_fields.find(l=>l.field_name===e);if(void 0!=o)if("People"===o.data_type_name)S[e]=o.value;else if("Positions"===o.data_type_name){var t,d;S[e]=null!==(t=null===(d=Zo.find(e=>e.value===o.value))||void 0===d?void 0:d.label)&&void 0!==t?t:""}else if("Date"===o.data_type_name){var a;const l=new Date(null===o||void 0===o||null===(a=o.value)||void 0===a?void 0:a.split(",")[0]);S[e]=oe()(l).format("DD MMM YYYY")}else if("Link"===o.data_type_name||"Image"===o.data_type_name){var s,u,r;(null!==(s="".concat(S[e]))&&void 0!==s&&s.includes("jpg")||null!==(u="".concat(S[e]))&&void 0!==u&&u.includes("jpeg")||null!==(r="".concat(S[e]))&&void 0!==r&&r.includes("png"))&&(S[e]=i.createElement("img",{alt:"lg",src:null===o||void 0===o?void 0:o.value,className:n.imageColumn}))}else if("Filters"===o.data_type_name){var v;S[e]=A.tq?"".concat(null===o||void 0===o?void 0:o.value.slice(0,20)):"".concat(null===o||void 0===o?void 0:o.value),null===(v=yo.find(e=>{var l;return(null===(l=e.component_fields.filter(e=>e.field_name===o.options.output&&e.component_blueprint_id===o.options.component_id&&e.value===(null===o||void 0===o?void 0:o.value)))||void 0===l?void 0:l.length)>0}))||void 0===v||v.component_fields.filter(e=>{S[e.field_name]=A.tq?e.value.slice(0,20):e.value})}else if("Status"===o.data_type_name){var p;if(0==l.is_complete)S[e]="Draft";else S[e]="".concat(null!==(p=null===l||void 0===l?void 0:l.status)&&void 0!==p?p:null===o||void 0===o?void 0:o.value)}else{var c;S[e]=A.tq?null===o||void 0===o?void 0:o.value.split(",")[0].slice(0,20):null===o||void 0===o||null===(c=o.value)||void 0===c?void 0:c.split(",")[0]}}),null===e||void 0===e||null===(o=e.com)||void 0===o||null===(t=o.selected_fields)||void 0===t||null===(d=t.filter(e=>"Details"===e.data_type_name))||void 0===d||d.forEach(e=>{var l,o,t,i;const n=S[null!==(l=null===(o=e.options)||void 0===o?void 0:o.field)&&void 0!==l?l:e.options.key],d=yo.find(l=>l.module_id===e.options.module_id&&l.component_fields.find(l=>l.field_name===e.options.key&&l.value===n));S[e.field_name]=null===(t=e.options)||void 0===t||null===(i=t.fields.map(e=>{var l,o;return null===d||void 0===d||null===(l=d.component_fields)||void 0===l||null===(o=l.find(l=>l.field_name===e))||void 0===o?void 0:o.value}))||void 0===i?void 0:i.join(" ")}),(null===l||void 0===l||null===(a=l.component_items)||void 0===a?void 0:a.length)>0&&(S["Total Qty"]=l.component_items.reduce((e,l)=>e+ +l.quantity,0)),(null===l||void 0===l||null===(s=l.shared_positions)||void 0===s?void 0:s.length)>0&&(S.Shares=null===l||void 0===l?void 0:l.shared_positions.map(e=>{var l;return null===(l=Zo.find(l=>l.value===e.id))||void 0===l?void 0:l.label}).toString());const C=new Date(l.created_date);return S.id=l.id,S.ID=l.id,S["Created By"]="".concat(null===l||void 0===l||null===(u=l.created_by)||void 0===u?void 0:u.first_name," ").concat(null===l||void 0===l||null===(r=l.created_by)||void 0===r?void 0:r.last_name),S["Created Date"]=oe()(C).format("DD MMM YYYY h:mm a"),S["Assigned To"]="".concat(null!==(v=null===l||void 0===l||null===(p=l.assigned_to)||void 0===p?void 0:p.first_name)&&void 0!==v?v:""," ").concat(null!==(c=null===l||void 0===l||null===(m=l.assigned_to)||void 0===m?void 0:m.last_name)&&void 0!==c?c:""),S.Status=A.tq?null!==(_=null===l||void 0===l?void 0:l.status)&&void 0!==_?_:"-":bt?null===l||void 0===l?void 0:l.status:i.createElement("div",{className:n.statusBox,style:{display:(null!==l&&void 0!==l&&l.status,""),backgroundColor:null!==(f=null===(h=O.MO.find(e=>e.value===(null===l||void 0===l?void 0:l.status)))||void 0===h?void 0:h.color)&&void 0!==f?f:null!==l&&void 0!==l&&l.status?"#3C32AA":" brown",height:"26px",maxWidth:(null===l||void 0===l||null===(g=l.status)||void 0===g?void 0:g.length)>12?"200px":"100px"}},0==l.is_complete?"DRAFT":null!==(y=null===l||void 0===l||null===(M=l.status)||void 0===M?void 0:M.toUpperCase())&&void 0!==y?y:"NONE"),S.Title=l.title,S.items=l.component_items,S[fo.processModule.module.name]=l.title,null===e||void 0===e||null===(b=e.reports)||void 0===b||b.filter(e=>"Formula"===e.data_type_name).map(e=>{const o=(0,O.LV)(e.options,e.options.list.map(e=>{var l;return{value:null!==(l=S[e])&&void 0!==l?l:0}}),yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}),null===l||void 0===l?void 0:l.component_items);S[e.field_name]="".concat(o)}),S});null===e||void 0===e||null===(l=e.reports)||void 0===l||l.filter(e=>"List Filter"===e.data_type_name).map(e=>{a=a.filter(l=>{var o,t;return l[null===(o=e.options)||void 0===o?void 0:o.field]===(null===(t=e.options)||void 0===t?void 0:t.value)})});const s=null===e||void 0===e||null===(o=e.reports)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name);if(s){let e=[];a.map(l=>{l.items.filter(o=>{const i=(0,t.Z)({},l);Object.keys(s.options.map).map(e=>{i[s.options.map[e]]=o[e]}),e=[...e,i]}),delete l.items}),a=e}return null!==e&&void 0!==e&&e.title&&(a=(0,Z.HR)(a,e,fo)),a},si=()=>{var e,l,o,t,n,a;return i.createElement(k.Z,{light:!0,style:{display:null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.one?yo.find(e=>{var l,o,t;return e.module_id===(null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)&&(null===e||void 0===e||null===(t=e.created_by)||void 0===t?void 0:t.id)===wo.id})?"none":"":1!=(null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t||null===(n=t.module)||void 0===n||null===(a=n.options)||void 0===a?void 0:a.readOnly)||"manager"===wo.user_type||"admin"===wo.user_type?"":"none"},clicked:()=>{ei(),Ho({})},icon:i.createElement("img",{src:d.IH})})},ui=()=>[...new Set(Et.filter(e=>void 0!==e.Status).map(e=>e.Status))].map(e=>({label:e,value:e})),ri=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et,o=JSON.parse(JSON.stringify(l));e.filter((e,t)=>{"status"===e.type?o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l.Status===e.value)]:o.filter(l=>l.Status===e.value):"user"===e.type?o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l["Created By"]===e.label)]:o.filter(l=>l["Created By"]===e.label):"fields"===e.type&&(o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l[e.filter]===e.value)]:o.filter(l=>l[e.filter]===e.value))}),wt(o)},vi=()=>{var e;return i.createElement("div",{style:{display:""}},i.createElement(P.Z,{value:null!==(e=It.operator)&&void 0!==e?e:"AND",className:n.dropdownSelectOperation,items:[{label:"AND",value:"AND"},{label:"OR",value:"OR"}],onChange:e=>{Nt((0,t.Z)((0,t.Z)({},It),{},{operator:e}))}}))},pi=()=>i.createElement("div",{style:{alignSelf:"flex-end",display:Vt.component_blueprints.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asReport)}).length>0?"flex":"none"}},i.createElement(k.Z,{light:!0,clicked:()=>{bt?(Nt({list:[],operator:"AND"}),xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))):xt([]),kt([]),St(!bt)},style:bt?{height:"36px"}:{}},bt?i.createElement(se.G,{icon:ae.g82,style:{width:"25px",height:"25px"}}):i.createElement("img",{src:d.aR})),1==bt&&i.createElement(i.Fragment,null,i.createElement(P.Z,{className:n.dropdownSelectReport,items:Vt.component_blueprints.filter(e=>{var l,o,t;return 1==(null===(l=e.options)||void 0===l?void 0:l.asReport)&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||wo.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).map(e=>({label:null===e||void 0===e?void 0:e.name,value:e.id,blueprint:e})),visible:!0,onChange:e=>{var l,o;xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}));let t=[];V.Z([K.Z(H.Z("index"))])(Vt.component_blueprints.find(l=>l.id===e).selected_fields.filter(e=>1==e.visible)).map(e=>{t=[...t,e.field_name],"Info"===e.data_type_name?e.options.list.map(e=>t=[...t,e]):"Transaction List"===e.data_type_name&&Object.values(e.options.map).map(e=>t=[...t,e])}),Nt({list:[...new Set(t)],title:null===(l=Vt.component_blueprints.find(l=>l.id===e))||void 0===l?void 0:l.name,reports:V.Z([J.Z(H.Z("index"))])(Vt.component_blueprints.find(l=>l.id===e).selected_fields).map(e=>({field_name:e.field_name,data_type_name:e.data_type_name,options:e.options})),operator:"AND"}),wt(ai({list:[...new Set(t)],title:null===(o=Vt.component_blueprints.find(l=>l.id===e))||void 0===o?void 0:o.name,reports:V.Z([J.Z(H.Z("index"))])(Vt.component_blueprints.find(l=>l.id===e).selected_fields).map(e=>({field_name:e.field_name,data_type_name:e.data_type_name,options:e.options})),operator:"AND"},yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})))},placeholder:"Reports"}))),ci=function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(l[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=fo.processModule.module)||void 0===e?void 0:e.name;return i.createElement(k.Z,{light:!0,title:(null===It||void 0===It?void 0:It.title)&&"Export as file",clicked:()=>{var e,i,n;const d=bt?o:1==(null===(e=fo.processModule.module)||void 0===e||null===(i=e.options)||void 0===i?void 0:i.isMaster)?[...o,"Shares","Title"]:o,a=te.utils.book_new(),s=te.utils.json_to_sheet([]);te.utils.sheet_add_aoa(s,[d]),te.utils.sheet_add_json(s,l.map(e=>Object.assign({},...d.map(l=>({[l]:e[l]})))),{origin:"A2",skipHeader:!0}),te.utils.book_append_sheet(a,s,"".concat(null===(n=fo.processModule.module)||void 0===n?void 0:n.name)),(0,te.writeFile)(a,"".concat(t).concat((0,le.now)(),".xlsx"))}},i.createElement("img",{src:d.so}))},mi=null===Jo||void 0===Jo||null===(be=Jo.component_fields)||void 0===be?void 0:be.find(e=>"Status"===e.data_type_name);let _i=[];null===fo||void 0===fo||null===(Se=fo.processModule)||void 0===Se||null===(Ce=Se.steps)||void 0===Ce||Ce.filter(e=>null===e||void 0===e?void 0:e.component_blueprints.filter(e=>{var l,o;return(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)>0})).filter(e=>{e.component_blueprints.filter(e=>{var l,o;return(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)>0}).filter(e=>{e.options.showOnly.filter(e=>{_i=[..._i,e]})})});const fi=(null===fo||void 0===fo||null===(xe=fo.processModule)||void 0===xe||null===(Ee=xe.steps)||void 0===Ee?void 0:Ee.length)>0?null===fo||void 0===fo||null===(we=fo.processModule)||void 0===we||null===(Ze=we.steps)||void 0===Ze||null===(ke=Ze.find(e=>(null===e||void 0===e?void 0:e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Freehand"===e.data_type_name).length>0).length)>0))||void 0===ke||null===(Ie=ke.component_blueprints.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Freehand"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===Ie||null===(Ne=Ie.options)||void 0===Ne?void 0:Ne.showOnly:void 0,hi=(null===fo||void 0===fo||null===(Pe=fo.processModule)||void 0===Pe||null===(De=Pe.steps)||void 0===De?void 0:De.length)>0?null===fo||void 0===fo||null===(Ue=fo.processModule)||void 0===Ue||null===(Te=Ue.steps)||void 0===Te||null===(Oe=Te.find(e=>(null===e||void 0===e?void 0:e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0).length)>0))||void 0===Oe||null===(qe=Oe.component_blueprints.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Action Button"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===qe||null===(Ae=qe.options)||void 0===Ae?void 0:Ae.showOnly:void 0;console.log("begunModule",fo,Jo);const gi=!tt&&(void 0===(null===Jo||void 0===Jo?void 0:Jo.status)&&((null===(Be=_i)||void 0===Be?void 0:Be.filter(e=>wo.positions.map(e=>e.id).indexOf(e)>-1).length)>0||(null===fi||void 0===fi?void 0:fi.filter(e=>wo.positions.map(e=>e.id).indexOf(e)>-1).length)>0)||(void 0===(null===Jo||void 0===Jo?void 0:Jo.status)||"New"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Show"===(null===Jo||void 0===Jo?void 0:Jo.status)||"None"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Reopen"===(null===Jo||void 0===Jo?void 0:Jo.status)||null===(null===Jo||void 0===Jo?void 0:Jo.status))&&((null===Jo||void 0===Jo||null===(Re=Jo.created_by)||void 0===Re?void 0:Re.id)===(null===wo||void 0===wo?void 0:wo.id)||(null===Jo||void 0===Jo||null===(Ye=Jo.assigned_to)||void 0===Ye?void 0:Ye.id)===(null===wo||void 0===wo?void 0:wo.id))||void 0!==(null===Jo||void 0===Jo?void 0:Jo.status)&&!("Hide"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Closed"===(null===Jo||void 0===Jo?void 0:Jo.status)||(null!==(Le=null===(Fe=fo.processModule)||void 0===Fe||null===(We=Fe.module)||void 0===We||null===(je=We.options)||void 0===je?void 0:je.lock)&&void 0!==Le?Le:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)||(null===Jo||void 0===Jo?void 0:Jo.status)===(null===go||void 0===go||null===(ze=go.misc_info)||void 0===ze?void 0:ze.lock)||"Cancelled"===(null===Jo||void 0===Jo?void 0:Jo.status))&&((null===(Ge=_i)||void 0===Ge?void 0:Ge.filter(e=>wo.positions.map(e=>e.id).indexOf(e)>-1).length)>0||(null===fi||void 0===fi?void 0:fi.filter(e=>wo.positions.map(e=>e.id).indexOf(e)>-1).length)>0)&&(1!=(null===fo||void 0===fo||null===(Xe=fo.processModule)||void 0===Xe||null===(Ve=Xe.module)||void 0===Ve||null===(Je=Ve.options)||void 0===Je?void 0:Je.strict)||(null===Jo||void 0===Jo||null===(He=Jo.created_by)||void 0===He?void 0:He.id)!==(null===wo||void 0===wo?void 0:wo.id))||(null===(Qe=fo.processModule)||void 0===Qe||null===(Ke=Qe.module)||void 0===Ke||null===($e=Ke.options)||void 0===$e?void 0:$e.allEdit)||(!1===(null===Jo||void 0===Jo?void 0:Jo.is_complete)||null===(el=null===mi||void 0===mi||null===(ll=mi.options)||void 0===ll?void 0:ll.control)||void 0===el||el)&&(null===Jo||void 0===Jo||null===(ol=Jo.created_by)||void 0===ol?void 0:ol.id)===(null===wo||void 0===wo?void 0:wo.id)&&(!(null!==mi&&void 0!==mi&&null!==(tl=mi.options)&&void 0!==tl&&tl.control||null!==fo&&void 0!==fo&&null!==(il=fo.processModule)&&void 0!==il&&null!==(nl=il.module)&&void 0!==nl&&null!==(dl=nl.options)&&void 0!==dl&&dl.close)||!((null===Jo||void 0===Jo?void 0:Jo.status)===(null===go||void 0===go||null===(al=go.misc_info)||void 0===al?void 0:al.lock)||(null!==(sl=null===(ul=fo.processModule)||void 0===ul||null===(rl=ul.module)||void 0===rl||null===(vl=rl.options)||void 0===vl?void 0:vl.lock)&&void 0!==sl?sl:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)))),yi="trial_ended"!==go.status&&"inactive"!==go.status&&(0===(null===(pl=Jo.component_fields)||void 0===pl?void 0:pl.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action).length)||0===(null===(cl=Jo.component_fields)||void 0===cl?void 0:cl.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action&&void 0===e.value).length)&&((null===(ml=Jo.component_fields)||void 0===ml?void 0:ml.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action&&e.value===(null===wo||void 0===wo?void 0:wo.id)).length)>0||(null===Jo||void 0===Jo||null===(_l=Jo.assigned_to)||void 0===_l?void 0:_l.id)===(null===wo||void 0===wo?void 0:wo.id))),Mi=(A.tq?[]:[i.createElement(k.Z,{key:0,title:!A.tq&&"Close",icon:A.tq&&i.createElement(se.G,{icon:ae.QQm,style:{ccolor:"var(--app-color-gray)",width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px"},clicked:()=>{!tt&&Go(!1),it(!1)}})]).concat(!tt&&(null===Jo||void 0===Jo||null===(fl=Jo.component_fields)||void 0===fl?void 0:fl.length)>0&&(0,O.cQ)(null===Jo||void 0===Jo?void 0:Jo.status,hi,Jo,wo,fo,go)?null===fo||void 0===fo||null===(hl=fo.processModule)||void 0===hl||null===(gl=hl.steps)||void 0===gl||null===(yl=gl.find(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0).length>0))||void 0===yl||null===(Ml=yl.component_blueprints.find(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0))||void 0===Ml?void 0:Ml.selected_fields.filter(e=>"Action Button"===e.data_type_name).map((e,l)=>{var o,d,a,s;if("status"===e.options.action){var r,v,_,f,h,g,y,M;let o=(null===go||void 0===go||null===(r=go.misc_info)||void 0===r||null===(v=r.status)||void 0===v?void 0:v.length)>0?null===go||void 0===go||null===(_=go.misc_info)||void 0===_?void 0:_.status:O.MO;var b;if((null===go||void 0===go||null===(f=go.misc_info)||void 0===f||null===(h=f.rules)||void 0===h?void 0:h.length)>0)null===go||void 0===go||null===(b=go.misc_info)||void 0===b||b.rules.filter(e=>"status"===e.type).filter(l=>{l.valueCondition===e.value&&(o="0"===l.allow?o.filter(e=>l.values.includes(e.value)):o.filter(e=>!l.values.includes(e.value)))});return i.createElement("div",{key:l,style:{width:"100%",display:"user"===e.options.action&&null!==(g=Jo.component_fields)&&void 0!==g&&null!==(y=g.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==y&&y.value?"none":""}},i.createElement(P.Z,{titleProps:{fontSize:"16px",color:"var(--app-color-gray-light)"},className:n.multiselectComponent,key:l,visible:e.visible,mandatory:e.mandatory,value:null!==(M=e.value)&&void 0!==M?M:"",items:o,error:e.errors,onChange:l=>{var o,i,n,d;if(null!==(o=fo.processModule)&&void 0!==o&&null!==(i=o.module)&&void 0!==i&&null!==(n=i.options)&&void 0!==n&&n.credits&&(l===(null===(d=go.options)||void 0===d?void 0:d.lock)||"Closed"===l)){var a,s,r,v,_,f,h,g;const e=null===fo||void 0===fo||null===(a=fo.processModule)||void 0===a||null===(s=a.steps)||void 0===s||null===(r=s.find(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Payments"===e.data_type_name).length>0).length>0))||void 0===r||null===(v=r.component_blueprints.find(e=>e.selected_fields.filter(e=>"Payments"===e.data_type_name).length>0))||void 0===v?void 0:v.selected_fields.find(e=>"Payments"===e.data_type_name),l=null===(_=Wo.newStepComponents.concat(Wo.components).find(l=>l.selected_fields.filter(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)}).length>0))||void 0===_||null===(f=_.selected_fields)||void 0===f?void 0:f.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});let o=0;if(null===(h=fo.processModule)||void 0===h||null===(g=h.selectedComponent.payments)||void 0===g||!g.stripe_id)return Go(!1),fo.processModule.showDetail=!1,void p.h.dispatch((0,c.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));var y,M;if(!(+(null!==(y=null===l||void 0===l?void 0:l.value)&&void 0!==y?y:0)>0))return void p.h.dispatch((0,c.Xc)({show:!0,message:"No amount found",color:"red",spinner:!1,bottom:!0}));o=+(null!==(M=null===l||void 0===l?void 0:l.value)&&void 0!==M?M:0),"Cash"!==(null===e||void 0===e?void 0:e.value)&&(0,de.e_)({user_id:wo.id,id:(0,O.mR)(),total:o,product:"CR-".concat(null===Jo||void 0===Jo?void 0:Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;wo.wallet=+(+(null!==(e=null===wo||void 0===wo?void 0:wo.wallet)&&void 0!==e?e:0)+o)}})}go.start=!0,dt(!0),(0,u.C0)({component_id:Jo.id,index:0,group:99,value:l,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:e=>{dt(!1),Go(!1),p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))},error:()=>{},complete:()=>{}})},fieldIcon:e.icon,fieldLabel:e.field_name,placeholder:"Select status..."}))}return i.createElement(i.Fragment,null,i.createElement(k.Z,{light:!0,title:e.field_name,loading:nt,clicked:()=>{if("user"===e.options.action||"creator"===e.options.action){var l,o,i;const S="user"===e.options.action?wo:So.find(e=>{var l;return e.id===(null===(l=Jo.created_by)||void 0===l?void 0:l.id)});if(null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.credits){var n,d,a,s,r,v,_,f;const e=null===(n=Jo.component_fields)||void 0===n?void 0:n.find(e=>"Payments"===e.data_type_name&&(null===e||void 0===e?void 0:e.value));let l=null===(d=Wo.newStepComponents.concat(Wo.components).find(l=>l.selected_fields.filter(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)}).length>0))||void 0===d||null===(a=d.selected_fields)||void 0===a?void 0:a.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});var h;if(!l)l=null===(h=Jo.component_fields)||void 0===h?void 0:h.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});let o=0;if(void 0===(null===S||void 0===S?void 0:S.wallet)||0===(null===S||void 0===S?void 0:S.wallet))return p.h.dispatch((0,c.Xc)({show:!0,message:"You need to setup funds for your wallet",color:"red",spinner:!1,bottom:!0})),fo.processModule.showDetail=!1,void Go(!1);if(+(null!==(s=null===(r=l)||void 0===r?void 0:r.value)&&void 0!==s?s:0)>0&&"Cash"===(null===e||void 0===e?void 0:e.value)){var g,y,M,b;if((null!==(g=+(null===S||void 0===S?void 0:S.wallet))&&void 0!==g?g:0)<+(null===(y=l)||void 0===y?void 0:y.value))return p.h.dispatch((0,c.Xc)({show:!0,message:"Insufficient funds in wallet",color:"red",spinner:!1,bottom:!0})),fo.processModule.showDetail=!1,void Go(!1);o=null!==(M=null===(b=l)||void 0===b?void 0:b.value)&&void 0!==M?M:0}else if(null===(v=fo.processModule)||void 0===v||null===(_=v.selectedComponent)||void 0===_||null===(f=_.payments)||void 0===f||!f.stripe_id)return Go(!1),fo.processModule.showDetail=!1,void p.h.dispatch((0,c.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));"Cash"===(null===e||void 0===e?void 0:e.value)&&(0,de.e_)({user_id:wo.id,id:(0,O.mR)(),total:-o,product:"DB-".concat(null===Jo||void 0===Jo?void 0:Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;return S.wallet=+(+(null!==(e=null===S||void 0===S?void 0:S.wallet)&&void 0!==e?e:0)-o)},error:()=>p.h.dispatch((0,c.Xc)({show:!0,message:"Purchase error encountered",color:"red",spinner:!1,bottom:!0}))})}dt(!0),(0,u.C0)({component_id:Jo.id,index:0,group:99,value:S.id,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:e=>{(0,u.dn)(Jo.id,S.id).subscribe({next:e=>{dt(!1),Go(!1),p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))}})},error:()=>{},complete:()=>{}})}else"status"===e.options.action||"date"===e.options.action||e.options.action,dt(!1)},style:{backgroundColor:"green",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px",display:"user"===e.options.action&&null!==(o=Jo.component_fields)&&void 0!==o&&null!==(d=o.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==d&&d.value?"none":""}}),i.createElement(k.Z,{title:"Decline",light:!0,loading:nt,clicked:()=>{var e,l;Vo(!0),dt(!0);const o=Jo.component_fields.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});(0,u.KL)((0,t.Z)((0,t.Z)({},Jo),{},{selected_fields:o?Jo.component_fields.filter(e=>e.id!==o.id):Jo.component_fields,assigned_to:{id:""}}),Jo.id,null===(e=Jo.shared_users)||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.id),Jo.title,Jo.is_complete,null===(l=Jo.shared_positions)||void 0===l?void 0:l.map(e=>null===e||void 0===e?void 0:e.id)).subscribe({error:e=>{p.h.dispatch((0,c.Xc)({show:!0,message:"Errors found",color:"red"}))},next:e=>{p.h.dispatch((0,c.aT)(Jo.id)),dt(!1),Go(!1),p.h.dispatch((0,c.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))}})},style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px",display:"user"===e.options.action&&null!==(a=Jo.component_fields)&&void 0!==a&&null!==(s=a.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==s&&s.value?"none":""}}))}):[]).concat(tt?[]:[i.createElement(k.Z,{light:!A.tq,key:3,title:!A.tq&&"Print",icon:A.tq&&i.createElement(se.G,{icon:ae.wf8,style:{width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:A.tq?"green":"lightgray",display:A.tq?"none":""},clicked:()=>{it(!0)}})]).concat(tt?[i.createElement(N(),{key:4,trigger:()=>i.createElement("button",{style:{width:"100%",maxWidth:"220px",minWidth:"80px",display:A.tq?"none":""},className:n.singleButton},i.createElement(se.G,{icon:ae.wf8})),content:()=>Qt.current})]:[]).concat(gi&&yi?[i.createElement(k.Z,{light:!A.tq,key:5,title:!A.tq&&"Edit",icon:A.tq&&i.createElement(se.G,{icon:ae.Xcf,style:{width:"20px",height:"20px"}}),style:{backgroundColor:A.tq?"var(--app-color-blue)":"lightgray",width:"100%",maxWidth:"220px",minWidth:"80px"},clicked:()=>{var e,l,o,t,i,n;Go(!1),Vo(!0),fo.processModule.isUpdating=!0,(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.steps)||void 0===t||t.filter(e=>{var l;return null===e||void 0===e||null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>e.value=void 0))}));let d=[];G.Z(X.Z("group"))(null!==(i=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==i?i:[]).map(e=>{d=[...d,{id:e.component_blueprint_id,temp_id:e.id,selected_fields:$.Z(ee.Z("group",e.group))(Jo.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{var l,o,t,i,n,d;return(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.asReport)||!(null!==e&&void 0!==e&&null!==(i=e.options)&&void 0!==i&&i.asReport))&&(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))}).filter(e=>{e.selected_fields.filter(e=>{var l;const o=null===(l=Jo.component_fields)||void 0===l?void 0:l.find(l=>l.field_name===e.field_name);if(void 0!=o)e.value=o.value,e.group=o.group;else if("Record"===e.data_type_name){var t;const l=null===(t=Jo.component_fields)||void 0===t?void 0:t.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value,e.value=l.group)}})})}),Wo.components=d,Wo.items=JSON.parse(JSON.stringify(null!==(n=null===Jo||void 0===Jo?void 0:Jo.component_items)&&void 0!==n?n:[])),Wo.newStepComponents=[],go.start=!0,li()}})]:[]).concat(!gi||null===fo||void 0===fo||null===(bl=fo.processModule)||void 0===bl||null===(Sl=bl.module)||void 0===Sl||null===(Cl=Sl.options)||void 0===Cl||!Cl.canCancel||"New"!==Jo.status||null!==(xl=Jo.assigned_to)&&void 0!==xl&&xl.id?[]:[i.createElement(k.Z,{key:6,title:"Cancel",style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px"},clear:!0,clicked:()=>{(0,u.tE)(null===Jo||void 0===Jo?void 0:Jo.id,"Cancelled").pipe((0,m.P)()).subscribe({next:e=>{}})}})]).concat(tt||null===fo||void 0===fo||null===(El=fo.processModule)||void 0===El||null===(wl=El.module)||void 0===wl||null===(Zl=wl.options)||void 0===Zl||!Zl.canCancel||"New"!==Jo.status&&"Unassigned"!==Jo.status||null!==(kl=Jo.assigned_to)&&void 0!==kl&&kl.id?[]:[i.createElement(k.Z,{key:7,loading:nt,title:"Cancel Transaction",style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px"},clear:!0,clicked:()=>{dt(!0),(0,u.tE)(null===Jo||void 0===Jo?void 0:Jo.id,"Cancelled").pipe((0,m.P)()).subscribe({next:e=>{var l;if(dt(!1),null!==e&&void 0!==e&&null!==(l=e.data.payments)&&void 0!==l&&l.stripe_id){var o;const l=Math.abs(+(null===e||void 0===e||null===(o=e.data.payments)||void 0===o?void 0:o.stripe_price));(0,de.e_)({user_id:wo.id,id:(0,O.mR)(),total:l,product:"RF-".concat(Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;wo.wallet=+(+(null!==(e=null===wo||void 0===wo?void 0:wo.wallet)&&void 0!==e?e:0)+l),dt(!1),Go(!1)}})}else dt(!1),Go(!1),it(!1)}})}})]).concat(tt||!0!==(null===(Il=fo.processModule.module)||void 0===Il?void 0:Il.options.copyOutputs)||(null===Jo||void 0===Jo||null===(Nl=Jo.created_by)||void 0===Nl?void 0:Nl.id)!==wo.id?[]:[i.createElement(k.Z,{key:8,light:!A.tq,title:!A.tq&&"Copy",icon:A.tq&&i.createElement(se.G,{icon:ae.kZ_,style:{width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:A.tq?"orange":"lightgray",display:A.tq?"none":""},clicked:()=>{pt(!0)}})]).concat((null===Jo||void 0===Jo||null===(Pl=Jo.created_by)||void 0===Pl?void 0:Pl.id)===wo.id&&(null===Jo||void 0===Jo||null===(Dl=Jo.component_items)||void 0===Dl?void 0:Dl.length)>0&&!A.tq?[function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(l[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=fo.processModule.module)||void 0===e?void 0:e.name;return i.createElement(k.Z,{light:!A.tq,icon:i.createElement("img",{src:d.so}),style:{width:"100%",backgroundColor:"lightgray",maxWidth:"220px",minWidth:"80px"},clicked:()=>{var e,i,n;const d=null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(i=e.steps)||void 0===i?void 0:i.find(e=>e.component_blueprints.filter(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name))}).length>0),a=null===d||void 0===d||null===(n=d.component_blueprints)||void 0===n?void 0:n.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Transaction List"===e.data_type_name&&!0===e.visible).length)>0});if(a){var s,u,r,v;const e=null===fo||void 0===fo||null===(s=fo.processModule)||void 0===s||null===(u=s.steps)||void 0===u||null===(r=u.find(e=>e.component_blueprints.filter(e=>{var l;return null===(l=e.selected_fields)||void 0===l?void 0:l.find(e=>"Template"===e.data_type_name)}).length>0))||void 0===r||null===(v=r.component_blueprints)||void 0===v?void 0:v.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Template"===e.data_type_name&&!0===e.visible).length)>0});(0,Z._G)(Jo,a,e,o,l,fo,t)}else{var p;const e=o,i=te.utils.book_new(),n=te.utils.json_to_sheet([]);te.utils.sheet_add_json(n,l.map(l=>Object.assign({},...e.map(e=>({[e]:l[e]})))),{origin:"A2",skipHeader:!0}),te.utils.book_append_sheet(i,n,"".concat(null===(p=fo.processModule.module)||void 0===p?void 0:p.name)),(0,te.writeFile)(i,"".concat(t).concat((0,le.now)(),".xlsx"))}}})}(Jo.component_items,["item_code","quantity","value","alt_value"])]:[]).concat(!tt&&!0===(null===wo||void 0===wo?void 0:wo.is_admin)&&!A.tq&&(!(null!==mi&&void 0!==mi&&null!==(Ul=mi.options)&&void 0!==Ul&&Ul.control||null!==fo&&void 0!==fo&&null!==(Tl=fo.processModule)&&void 0!==Tl&&null!==(Ol=Tl.module)&&void 0!==Ol&&null!==(ql=Ol.options)&&void 0!==ql&&ql.close)||(null===Jo||void 0===Jo?void 0:Jo.status)!==(null===go||void 0===go||null===(Al=go.misc_info)||void 0===Al?void 0:Al.lock)&&!(null!==(Bl=null===(Rl=fo.processModule)||void 0===Rl||null===(Yl=Rl.module)||void 0===Yl||null===(Ll=Yl.options)||void 0===Ll?void 0:Ll.lock)&&void 0!==Bl?Bl:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)&&"Closed"!==(null===Jo||void 0===Jo?void 0:Jo.status))||(null===(Fl=Jo.created_by)||void 0===Fl?void 0:Fl.id)===(null===wo||void 0===wo?void 0:wo.id)&&0==(null===Jo||void 0===Jo?void 0:Jo.is_complete)?[i.createElement(k.Z,{key:11,icon:A.tq&&i.createElement(se.G,{icon:ae.$aW,style:{width:"20px",height:"20px"}}),title:!A.tq&&"Delete",style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:"#F71534"},clicked:()=>{var e,l,o;if(!0===(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.module)||void 0===l||null===(o=l.options)||void 0===o?void 0:o.isMaster)){const e=yo.filter(e=>e.module_id!==Jo.module_id).filter(e=>-1!=ho.filter(e=>{var l;return!0===(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.isMaster)}).map(e=>e.id).indexOf(e.module_id)),l=yo.filter(e=>-1!=ho.filter(e=>{var l;return 1!=(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.isMaster)}).map(e=>e.id).indexOf(e.module_id)),o=e.filter(e=>e.component_fields.filter(e=>-1!=Jo.component_fields.map(e=>e.value).indexOf(e.value)).length>0).length>0||l.filter(e=>e.component_items.filter(e=>-1!=Jo.component_fields.map(e=>e.value).indexOf(e.item_code)).length>0).length>0||l.filter(e=>e.component_fields.filter(e=>"output"!==e.data_type&&-1!=Jo.component_fields.map(e=>e.value).indexOf(e.value)).length>0).length>0;ft(o),rt(!o)}else rt(!0)}})]:[]);return i.createElement("div",{className:n.processStepHost},i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":A.tq?"true":"false"},1==(null===Vt||void 0===Vt?void 0:Vt.rank)&&i.createElement(U,{title:null===fo||void 0===fo||null===(Wl=fo.processModule)||void 0===Wl||null===(jl=Wl.module)||void 0===jl?void 0:jl.name,subtitle:A.tq?"":null===fo||void 0===fo||null===(zl=fo.processModule)||void 0===zl?void 0:zl.description,customStyle:{width:A.tq?"100%":"94%",minWidth:A.tq?"100px":"94%"},cardClicked:()=>{xo(null===fo||void 0===fo?void 0:fo.processModule),st(!at),at||(0,r.zJ)(null===fo||void 0===fo?void 0:fo.processModule.id).pipe((0,m.P)()).subscribe({next:e=>{p.h.dispatch((0,c.Xu)(e)),p.h.dispatch((0,c.an)([...Po.filter(l=>l.id!==e.id),e],1)),(0,u.d7)(O.KI,O.RI).pipe((0,m.P)()).subscribe({})}})}})),at&&1==(null===Vt||void 0===Vt?void 0:Vt.rank)&&i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":A.tq?"true":"false"},i.createElement(U,{description:"Steps:",customStyle:{width:A.tq?"100%":"94%",minWidth:A.tq?"100px":"94%"}},i.createElement(q.FZ,null,i.createElement(T.Z,null)))),Eo,i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":A.tq?"true":"false"},1===To&&void 0===(null===Vt||void 0===Vt?void 0:Vt.component_blueprints)?i.createElement("div",{className:n.centeredSpinner},i.createElement(s.$j,{size:80,type:"ThreeDots"})):(null===Vt||void 0===Vt||null===(Gl=Vt.component_blueprints)||void 0===Gl?void 0:Gl.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asModuleList)}).length)>0?null===Vt||void 0===Vt||null===(Xl=Vt.component_blueprints)||void 0===Xl?void 0:Xl.filter(e=>{var l,o,t;return 1==e.options.asModuleList&&(wo.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0||0==(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)||void 0===(null===(t=e.options)||void 0===t?void 0:t.showOnly))}).map((e,l)=>{var o,a,s;return i.createElement(i.Fragment,{key:l},i.createElement(y.default,{className:A.tq?n.listContainerMob:n.listContainer,isReport:bt,title:bt?"Reports":null===Vt||void 0===Vt?void 0:Vt.name,columns:(null===(o=yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))||void 0===o?void 0:o.filter(e=>{var l;return 0===(null===(l=e.component_fields)||void 0===l?void 0:l.length)}).length)>0?[fo.processModule.module.name]:A.tq?null!==e&&void 0!==e&&null!==(a=e.options)&&void 0!==a&&a.key?[fo.processModule.module.name,null===e||void 0===e||null===(s=e.options)||void 0===s?void 0:s.key]:[fo.processModule.module.name,"Status"]:[...new Set(bt?It.list:V.Z([K.Z(H.Z("index"))])(e.selected_fields.filter(e=>1==e.visible)).map(e=>{var l;return"Info"===e.data_type_name?null===(l=e.options)||void 0===l?void 0:l.list:e.field_name}).flat())].slice(0,A.tq?2:18),list:bt?Et:ai({com:e,list:e.selected_fields.filter(e=>"Info"===e.data_type_name).map(e=>{var l,o;return null!==(l=null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.key)&&void 0!==l?l:e.field_name}).concat(e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name))}),addClicked:()=>{ei(),Ho({})},onListItemClick:e=>{var l,o;if(bt)return;const t=yo.find(l=>l.id===e.id);if(0===(null===(l=t.component_fields)||void 0===l?void 0:l.length))return dt(!0),void(0,u.r6)(t.id).pipe((0,m.P)()).subscribe({next:e=>{Ho(e),Ko(e.is_complete),Go(!0),it(!1),dt(!1)},error:()=>{}});var i,n,d,a;if(Ho(t),Ko(t.is_complete),it(!1),null!==t&&void 0!==t&&null!==(o=t.assigned_to)&&void 0!==o&&o.id&&!So.find(e=>{var l;return e.id===(null===t||void 0===t||null===(l=t.assigned_to)||void 0===l?void 0:l.id)}))(0,ue.VG)(So.find(e=>{var l;return e.id===(null===(l=t.created_by)||void 0===l?void 0:l.id)})?[null===t||void 0===t||null===(i=t.assigned_to)||void 0===i?void 0:i.id]:[null===t||void 0===t||null===(n=t.assigned_to)||void 0===n?void 0:n.id,null===t||void 0===t||null===(d=t.created_by)||void 0===d?void 0:d.id]).pipe((0,m.P)()).subscribe({next:e=>{p.h.dispatch((0,c.NY)(So.concat(e))),Go(!0)}});else if(fo.processModule.user_id!==wo.id&&null!==(a=fo.processModule.module.options)&&void 0!==a&&a.skipDetail){var s,r,v,_,f,h;Go(!1),Vo(!0),fo.processModule.isUpdating=!0,(null===fo||void 0===fo||null===(s=fo.processModule)||void 0===s||null===(r=s.steps)||void 0===r?void 0:r.length)>0&&(null===fo||void 0===fo||null===(v=fo.processModule)||void 0===v||null===(_=v.steps)||void 0===_||_.filter(e=>{var l;return null===e||void 0===e||null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>e.value=void 0))}));let e=[];G.Z(X.Z("group"))(null!==(f=null===t||void 0===t?void 0:t.component_fields)&&void 0!==f?f:[]).map(l=>{e=[...e,{id:l.component_blueprint_id,temp_id:l.id,selected_fields:$.Z(ee.Z("group",l.group))(t.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{var l,o,t,i,n,d;return(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.asReport)||!(null!==e&&void 0!==e&&null!==(i=e.options)&&void 0!==i&&i.asReport))&&(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))}).filter(e=>{e.selected_fields.filter(e=>{const l=t.component_fields.find(l=>l.field_name===e.field_name);if(void 0!=l)e.value=l.value,e.group=l.group;else if("Record"===e.data_type_name){const l=t.component_fields.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value,e.value=l.group)}})})}),Wo.components=e,Wo.items=JSON.parse(JSON.stringify(null!==(h=null===t||void 0===t?void 0:t.component_items)&&void 0!==h?h:[])),Wo.newStepComponents=[],go.start=!0,li()}else Go(!0)},pages:fo.processModule.module.count,onPageClicked:e=>{const l=yo.filter(e=>e.module_id===fo.processModule.module.id);if(12345===e){var o;l.length<(null===(o=fo.processModule.module)||void 0===o?void 0:o.count)&&(0,R.vC)(fo.processModule.module,O.Qc,999999,1).pipe((0,_.q)(1)).subscribe({next:e=>{var l;dt(!1),fo.processModule.module.lastUpdate=0,fo.processModule.module.count=null!==(l=null===e||void 0===e?void 0:e.total)&&void 0!==l?l:0}})}else{var t,i;let o=Math.ceil((null!==(t=fo.processModule.module)&&void 0!==t&&t.count?+(null===(i=fo.processModule.module)||void 0===i?void 0:i.count):l.length)/O.ZP);A.tq&&o>7&&(o=7);const n=Math.ceil(l.length/O.ZP),d=e;d>n&&(dt(!0),bo.componentsByModule[fo.processModule.module.name]=0,(0,R.vC)(fo.processModule.module,O.Qc,d-n<=1?O.ZP:O.ZP*d,d-n<=1?d:1).pipe((0,_.q)(1)).subscribe({next:e=>{var l;dt(!1),bo.componentsByModule[fo.processModule.module.name]=(0,le.now)(),fo.processModule.module.lastUpdate=0,fo.processModule.module.count=null!==(l=null===e||void 0===e?void 0:e.total)&&void 0!==l?l:0}}))}}},i.createElement("div",null,i.createElement("div",{style:{display:"flex"}},Zt.length>0&&i.createElement(k.Z,{title:"Show all",clicked:()=>{xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),Nt((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})),wt(ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},style:{height:"30px",width:"140px"}}),Zt.map((e,l)=>i.createElement(k.Z,{className:n.customButton,icon:i.createElement("img",{src:d.C7,style:{height:"16px",width:"16px"}}),clicked:()=>{kt(Zt.filter(l=>l.value!==e.value)),ri(Zt.filter(l=>l.value!==e.value),ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},key:l,style:{height:"30px",width:"inherit"}},"".concat(0==l?"":e.operator," ").concat(e.label))),Zt.length>0&&i.createElement(k.Z,{title:"Apply",style:{height:"30px",width:"160px"},clicked:()=>{ri(Zt,ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},light:!0})),bt&&i.createElement("div",{style:{display:"flex"}},vi(),ui().length>0&&i.createElement(P.Z,{className:n.dropdownSelectComponent,items:ui(),onChange:e=>{Zt.map(e=>e.label).includes(e)||kt([...Zt,{label:e,value:e,type:"status",operator:It.operator}])},placeholder:"Status"}),bt&&i.createElement(P.Z,{className:n.dropdownSelectComponent,items:It.list.map(e=>({label:e,value:e})),onChange:e=>{Nt((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})),setTimeout(()=>Nt((0,t.Z)((0,t.Z)({},It),{},{filter:e})),10)},placeholder:"Filter by fields"}),1==bt&&void 0!==(null===It||void 0===It?void 0:It.filter)&&i.createElement(P.Z,{className:n.dropdownSelectComponentL,items:[...new Set(ai(It).map(e=>e[It.filter]))].map(e=>({label:e,value:e})),onChange:e=>{Zt.map(e=>e.value).includes(e)||kt([...Zt,{label:"".concat(It.filter,": ").concat(e),value:e,type:"fields",filter:It.filter,operator:It.operator}])},placeholder:"Field value"}),1==bt&&i.createElement(P.Z,{className:n.dropdownSelectComponent,items:So.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id})),onChange:e=>{if(!Zt.map(e=>e.label).includes(e)){const l=So.find(l=>l.id===e);kt([...Zt,{label:"".concat(l.first_name," ").concat(l.last_name),value:e,type:"user",operator:It.operator}])}},placeholder:"Created by"}))),i.createElement("div",{className:n.actionsContainer},!(null!==It&&void 0!==It&&It.title)&&bt&&i.createElement("label",{style:{padding:"20px 0px 20px 5px",fontSize:"12px"}},"OR"===It.operator?"Selecting OR will select all instances of selected value":"Selecting AND will only include instances of selected value"),bt?(null===It||void 0===It?void 0:It.title)&&ci(Et,It.list,It.title):i.createElement("div",{className:n.searchContainer},i.createElement(se.G,{icon:ae.wn1,style:{width:"25px",height:"25px",padding:"5px"}}),i.createElement("input",{placeholder:"Search",className:n.searchInput,onChange:e=>{var l,o,t;if("deleteContentBackward"===e.nativeEvent.inputType)xt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,yo,e.target.value));else if((null===(l=e.target.value)||void 0===l?void 0:l.length)>0){var i,n;xt(di(null===fo||void 0===fo||null===(i=fo.processModule)||void 0===i||null===(n=i.module)||void 0===n?void 0:n.id,Ct,e.target.value))}else 0==e.target.value.length&&xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))}})),bt&&pi(),i.createElement("div",{style:{display:bt?"none":"flex",alignSelf:"flex-end"}},!("trial_ended"===go.status||"inactive"===go.status||"free"===go.status||"on_trial"===go.status)&&si(),"on_trial"===go.status&&yo.filter(e=>e.module_id===fo.processModule.module.id&&oe()(new Date(e.created_date)).format("DDMMYYYY")===oe()(new Date).format("DDMMYYYY")).length<5&&si(),"free"===go.status&&yo.filter(e=>oe()(new Date(e.created_date)).format("DDMMYYYY")===oe()(new Date).format("DDMMYYYY")).length<3&&si(),!A.tq&&pi(),!A.tq&&ci(ai({list:e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name)}),e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name)),i.createElement(k.Z,{light:!0,clicked:()=>{dt(!0);const e=ho.find(e=>e.id===fo.processModule.module_id);bo.componentsByModule[e.name]=0,(0,R.vC)(e,O.Qc,O.R6,1).pipe((0,_.q)(1)).subscribe({next:l=>{var o;const t=null!==l&&void 0!==l&&l.data?null===l||void 0===l?void 0:l.data:l;p.h.dispatch((0,c.mK)(Q.Z(H.Z("created_date"),[...yo.filter(e=>e.module_id!==fo.processModule.module_id),...t]),O.KI,Io.map(e=>e.fields).flat(1))),bo.componentsByModule[e.name]=(0,le.now)(),e.lastUpdate=(0,le.now)(),e.count=null!==(o=null===l||void 0===l?void 0:l.total)&&void 0!==o?o:0,dt(!1)},complete:()=>{},error:()=>dt(!1)})},icon:i.createElement("img",{src:d.Fd}),loading:nt,message:"Fetching ".concat(fo.processModule.module.name,"...")})))))}):i.createElement("div",{className:n.listContainer,"app-variant-is-mobile":A.tq?"true":"false"},i.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},i.createElement("p",{className:n.stepTitleSmaller},null===Vt||void 0===Vt?void 0:Vt.name),i.createElement(k.Z,{clear:!0,clicked:()=>{var l,o,t;dt(!0),null===(l=fo.processModule.module)||void 0===l||null===(o=l.options)||void 0===o||null===(t=o.supporting)||void 0===t||t.filter((l,o)=>{var t,i,n;dt(!0),(0,R.vC)({id:l,name:null!==(t="".concat(null===ho||void 0===ho||null===(i=ho.find(e=>e.id===l))||void 0===i?void 0:i.name).concat(o))&&void 0!==t?t:"".concat(null===(n=e)||void 0===n?void 0:n.name).concat(o)},O.Qc,O.R6,1).pipe((0,_.q)(1)).subscribe({next:e=>{var l,t,i,n;(null===(l=fo.processModule.module)||void 0===l||null===(t=l.options)||void 0===t||null===(i=t.supporting)||void 0===i?void 0:i.length)==o+1&&(dt(!1),li(null===(n=fo.processModule.steps[fo.processModule.stepIndex-1])||void 0===n?void 0:n.id))},error:()=>dt(!1)})})},icon:i.createElement("img",{src:d.Fd}),loading:nt})),i.createElement("br",null),i.createElement("label",{className:n.stepGuidanceSmaller},null===Vt||void 0===Vt?void 0:Vt.guidance),Ro&&i.createElement(E.Z,{message:Ro,onClick:()=>Yo("")}),i.createElement(fe,{nextButtonClicked:Lo,step:Vt,setIsMandatoryError:Bo,isMandatoryError:Ao,begunModule:fo,companyData:go,blueprints:Io,components:yo,products:Co,authenticatedUser:wo,isEditing:Mo,companyUsersArray:So,usersArray:Pt,setUsers:et,setPositions:ot,setIsCompleted:Ko,selectedComponent:Jo,goToNextStep:li,companyPositionsArray:Zo,cart:ko,allModules:ho,editMode:Ot},i.createElement("div",{className:n.menuRightButtons}),(()=>{var e,l,o,t,a,s,u,r,v,m,_;return i.createElement("div",{className:n.menuAccordionButtons},fo.processModule.stepIndex>0&&i.createElement(k.Z,{title:"Cancel",light:!0,clicked:()=>{Wo.components.length>0||Wo.newStepComponents.length>0?Ft(!0):(fo.processModule.back_array=[],xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),li(fo.processModule.steps[0].id),qt(!1))}}),fo.processModule.stepIndex>0&&i.createElement(k.Z,{title:"Back",light:!0,style:{width:"80px"},clicked:()=>{var e,l,o;if(1==fo.processModule.stepIndex&&xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),1==(null===Vt||void 0===Vt||null===(e=Vt.options)||void 0===e?void 0:e.deleteOnBack)&&Vt.component_blueprints.filter(e=>e.selected_fields.filter(e=>"output"!==e.data_type).map(e=>{e.value=void 0})),(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.back_array)||void 0===o?void 0:o.length)>0){var t;const e=null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t?void 0:t.back_array.pop();e&&li(e)}else{var i;li(null===(i=fo.processModule.steps[fo.processModule.stepIndex-1])||void 0===i?void 0:i.id)}}}),!0===(null===Vt||void 0===Vt?void 0:Vt.is_end)&&(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.module)||void 0===l||null===(o=l.options)||void 0===o?void 0:o.single)&&Xo&&(null===(t=Jo.created_by)||void 0===t?void 0:t.id)===(null===wo||void 0===wo?void 0:wo.id)&&!0===(null===wo||void 0===wo?void 0:wo.is_admin)&&i.createElement(k.Z,{clear:!0,title:"Delete",loading:nt,style:{marginLeft:"0px",backgroundColor:"red",color:"white"},clicked:()=>rt(!0)}),!0===(null===Vt||void 0===Vt?void 0:Vt.is_end)?i.createElement(k.Z,{disabled:!1===(null===go||void 0===go?void 0:go.start),title:Xo?"Update":Qo&&null!==(a=null===fo||void 0===fo||null===(s=fo.processModule)||void 0===s||null===(u=s.module)||void 0===u||null===(r=u.options)||void 0===r?void 0:r.save)&&void 0!==a?a:"Save",loading:nt,style:{marginLeft:"0px",display:null!==fo&&void 0!==fo&&null!==(v=fo.processModule)&&void 0!==v&&null!==(m=v.module)&&void 0!==m&&null!==(_=m.options)&&void 0!==_&&_.nosave?"none":Wo.components.length>0||Wo.newStepComponents.length>0?"":"none"},clicked:()=>{var e,l,o,t,i,n;return Ot?Yo("Saving is not allowed in Edit Mode"):1==(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.module)||void 0===l||null===(o=l.options)||void 0===o?void 0:o.emailOutputs)&&1==(null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t||null===(i=t.module)||void 0===i||null===(n=i.options)||void 0===n?void 0:n.selectiveEmail)&&Qo?mt(!0):ti()}}):i.createElement(k.Z,{disabled:!1===(null===go||void 0===go?void 0:go.start),title:"Next",style:{width:"80px"},clicked:()=>{var e,l,o,t,i,n,d,a,s;Array.isArray(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e?void 0:e.back_array)||(fo.processModule.back_array=[]),null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||l.back_array.push(null===Wo||void 0===Wo||null===(o=Wo.currentStep)||void 0===o?void 0:o.id);const u=null===(t=Vt.component_blueprints.find(e=>e.selected_fields.filter(e=>{var l,o;return"Dropdown"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)&&"decision"===(null===(o=e.options)||void 0===o?void 0:o.type)}).length>0))||void 0===t||null===(i=t.selected_fields)||void 0===i?void 0:i.find(e=>{var l;return"Dropdown"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)}),r=null===(n=Vt.component_blueprints.find(e=>e.selected_fields.filter(e=>{var l;return"Value Button"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)}).length>0))||void 0===n||null===(d=n.selected_fields)||void 0===d?void 0:d.filter(e=>{var l;return"Value Button"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)});var v,m,_,f,h;if(null!==u&&void 0!==u&&null!==(a=u.options)&&void 0!==a&&a.jump1&&null!==u&&void 0!==u&&null!==(s=u.options)&&void 0!==s&&s.jump2)if(0==(null===u||void 0===u||null===(v=u.options)||void 0===v?void 0:v.list.indexOf(null===u||void 0===u?void 0:u.value)))$t(null===(_=Po.find(e=>{var l;return e.id===(null===u||void 0===u||null===(l=u.options)||void 0===l?void 0:l.process)}))||void 0===_||null===(f=_.steps)||void 0===f||null===(h=f.find(e=>e.id===(null===u||void 0===u?void 0:u.options.jump1)))||void 0===h?void 0:h.id);else if(1==(null===u||void 0===u||null===(m=u.options)||void 0===m?void 0:m.list.indexOf(null===u||void 0===u?void 0:u.value))){var g,y,M;$t(null===(g=Po.find(e=>{var l;return e.id===(null===u||void 0===u||null===(l=u.options)||void 0===l?void 0:l.process)}))||void 0===g||null===(y=g.steps)||void 0===y||null===(M=y.find(e=>e.id===(null===u||void 0===u?void 0:u.options.jump2)))||void 0===M?void 0:M.id)}else{var b;null===fo||void 0===fo||null===(b=fo.processModule)||void 0===b||b.back_array.pop(),p.h.dispatch((0,c.Xc)({show:!0,message:"Please select a value for ".concat(null===u||void 0===u?void 0:u.field_name),color:"red",bottom:!1}))}else if((null===r||void 0===r?void 0:r.length)>0){const e=r.filter(e=>void 0!==e.value);var S,C,x,E,w;if(1==e.length)$t(null===(S=Po.find(l=>{var o,t;return l.id===(null===(o=e[0])||void 0===o||null===(t=o.options)||void 0===t?void 0:t.process)}))||void 0===S||null===(C=S.steps)||void 0===C||null===(x=C.find(l=>{var o;return l.id===(null===(o=e[0])||void 0===o?void 0:o.options.jump1)}))||void 0===x?void 0:x.id);else null===fo||void 0===fo||null===(E=fo.processModule)||void 0===E||null===(w=E.back_array)||void 0===w||w.pop(),p.h.dispatch((0,c.Xc)({show:!0,message:"A selection is required",color:"red",bottom:!1})),window.scrollTo({top:0,behavior:"smooth"})}else if((null===Vt||void 0===Vt?void 0:Vt.next_steps.length)>1||Jt.length>1||Ht.length>1)qo(!Oo);else if(1===Vt.next_steps.length){var Z;$t(null===Vt||void 0===Vt||null===(Z=Vt.next_steps[0])||void 0===Z?void 0:Z.id)}else{var k;$t(null===(k=fo.processModule.steps[fo.processModule.steps.findIndex(e=>e.id===Vt.id)+1])||void 0===k?void 0:k.id)}}}),Oo&&i.createElement("div",{className:n.goToNextStep},null===Vt||void 0===Vt?void 0:Vt.next_steps.map((e,l)=>i.createElement("div",{key:l,onClick:()=>$t(e.id),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.c6})),i.createElement("p",null,null===e||void 0===e?void 0:e.name))),null===Jt||void 0===Jt?void 0:Jt.map((e,l)=>i.createElement("div",{key:l,onClick:()=>$t(e.id),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.th})),i.createElement("p",null,null===e||void 0===e?void 0:e.name))),null===Ht||void 0===Ht?void 0:Ht.map((e,l)=>i.createElement("div",{key:l,onClick:()=>(e=>{p.h.dispatch((0,c.pU)(e)),qo(!1)})(e),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.IR})),i.createElement("p",null,null===e||void 0===e?void 0:e.name)))))})())),(null===fo||void 0===fo||null===(Vl=fo.processModule)||void 0===Vl||null===(Jl=Vl.module)||void 0===Jl||null===(Hl=Jl.options)||void 0===Hl?void 0:Hl.ads)&&Wt&&0==(null===Vt||void 0===Vt||null===(Ql=Vt.component_blueprints)||void 0===Ql?void 0:Ql.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asModuleList)}).length)&&i.createElement("div",{style:{textAlign:"center"}},(e=>{if(e){const l=V.Z([J.Z(H.Z("created_date"))])(yo.filter(l=>l.module_id===e.id)).filter(e=>{var l;return(null===(l=e.component_fields)||void 0===l?void 0:l.filter(e=>{var l,o,t,i,n;return"Status"===e.data_type_name&&!((null!==(l=null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.lock)&&void 0!==l?l:"").split(",").includes(e.value)||"Closed"===e.value||"Cancelled"===e.value||"Hide"===e.value||e.value===(null===(n=go.misc_info)||void 0===n?void 0:n.lock))}).length)>0}).map((e,l)=>{var o,t,d,a;const s=e.component_fields.find(e=>{var l,o,t;return"Link"===e.data_type_name&&((null!==(l=null===e||void 0===e?void 0:e.value)&&void 0!==l?l:"").includes("jpg")||(null!==(o=null===e||void 0===e?void 0:e.value)&&void 0!==o?o:"").includes("png")||(null!==(t=null===e||void 0===e?void 0:e.value)&&void 0!==t?t:"").includes("pdf"))});return i.createElement("div",{key:l,className:n.imageCard,onClick:()=>{}},s&&(null!==(o="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==o&&o.includes("jpg")||null!==(t="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==t&&t.includes("jpeg")||null!==(d="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==d&&d.includes("png")||null!==(a="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==a&&a.includes("pdf"))&&null!==s&&void 0!==s&&s.value.includes("pdf")?i.createElement("embed",{src:"".concat(null===s||void 0===s?void 0:s.value,"#toolbar=0&navpanes=0&scrollbar=0&zoom=100%"),width:"1000px",height:"1000px"}):i.createElement("img",{alt:"lg",src:null===s||void 0===s?void 0:s.value,style:{objectFit:"contain",height:"100vh",borderRadius:"5px"}}))});return(null===l||void 0===l?void 0:l.length)>0&&i.createElement(s.U7,{isOpen:Wt,onClose:()=>{localStorage.setItem("showAdsDate",(0,le.now)()),jt(!1)},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:"60%",minWidth:"600px",backgroundColor:"var(--app-color-gray-lightest)"}},i.createElement("div",{className:n.center,style:{display:(null===l||void 0===l?void 0:l.length)>0?"":"none",flexDirection:"column"}},(null===l||void 0===l?void 0:l.length)>1?i.createElement(ce.tq,{slidesPerView:"auto",centeredSlides:!0,spaceBetween:200,initialSlide:1,pagination:{clickable:!0,dynamicBullets:!0},autoplay:{delay:1e4,disableOnInteraction:!0},modules:[pe.pt,pe.tl],className:"mySwiper"},(null===l||void 0===l?void 0:l.length)>0&&l.map((e,l)=>i.createElement(ce.o5,{key:l,className:n.swiperslide},e))):l),i.createElement(s.pd,{title:"Do not show popup again?",style:{margin:"0px 20% 20px 20%",width:"auto",backgroundColor:"var(--app-color-gray-lightest)",padding:"10px 50px 10px 50px"},value:!Wt,toggleSelected:e=>{localStorage.setItem("showAdsDate",(0,le.now)()),localStorage.setItem("showAds",!e),jt(!1)}}))}return i.createElement(i.Fragment,null)})(ho.find(e=>{var l,o,t;return e.id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o||null===(t=o.options)||void 0===t?void 0:t.ads)}))),Lt&&i.createElement(ve.Z,{openModal:Lt,setOpenModal:Ft,dialogHandler:()=>{fo.processModule.back_array=[],xt(yo.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),li(fo.processModule.steps[0].id),qt(!1),Ft(!1)},title:"You have unsaved items. Are you sure you want to cancel?",proceedTitle:"Yes",cancelTitle:"No, return back",loading:nt}),Rt&&fo.processModule.stepIndex>0&&i.createElement(s.U7,{isOpen:Rt,onClose:()=>Yt(!1),backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"40%"}},i.createElement("div",{style:{padding:"30px"}},i.createElement("p",{className:n.deleteText},"There were unsaved data for ".concat(Jo.title,". Do you want to restore them?")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(k.Z,{title:"Yes, restore",clicked:()=>{p.h.dispatch((0,c.Xc)({show:!0,message:"Reverting to saved data from the cache. Press Save to permanently save these records. Cancel to revert back",color:"red",spinner:!1,bottom:!0})),Wo.items=JSON.parse(localStorage.getItem("items")),Wo.newStepComponents=JSON.parse(localStorage.getItem("newStepComponents")),localStorage.removeItem("transaction"),Yt(!1)}}),i.createElement(k.Z,{title:"No, use the current data as is",light:!0,clicked:()=>{localStorage.removeItem("transaction"),Yt(!1)}})))),ut&&i.createElement(s.U7,{isOpen:u.v7,onClose:()=>{},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Are you sure you want to delete ".concat(Jo.title,"?")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(k.Z,{title:"Yes, delete",style:{backgroundColor:"red"},clicked:()=>{gt(!0),(0,u.v7)(Jo.id).pipe((0,m.P)()).subscribe({next:()=>{var e,l,o;gt(!1),Go(!1),rt(!1);var t;(Jo.component_fields.filter(e=>("Image"===e.data_type_name||"Upload"===e.data_type_name)&&e.value).forEach(e=>{const l=null===e||void 0===e?void 0:e.value.indexOf("/files/"),o=null===e||void 0===e?void 0:e.value.substring(l+1);(0,u.cv)(o).subscribe({})}),null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.single)&&(localStorage.removeItem(null===(t=fo.processModule)||void 0===t?void 0:t.module.id),Xt("/dashboard"))},complete:()=>{},error:()=>{gt(!1),rt(!1)}})},loading:ht}),i.createElement(k.Z,{title:"No",light:!0,clicked:()=>rt(!1)})))),vt&&i.createElement(s.U7,{isOpen:vt,onClose:()=>{},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Are you sure you want to copy ".concat(Jo.title,"? This will create a new copy")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(k.Z,{title:"Yes, copy",clicked:()=>{var e;Go(!1),pt(!1),ei();let l=[];G.Z(X.Z("group"))(null!==(e=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==e?e:[]).map(e=>{l=[...l,{id:e.component_blueprint_id,temp_id:e.id,selected_fields:$.Z(ee.Z("group",e.group))(Jo.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{e.selected_fields.filter(e=>{var l;const o=null===(l=Jo.component_fields)||void 0===l?void 0:l.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id);if(void 0!=o)"ID"===e.data_type_name||"Status"===e.data_type_name?e.value=void 0:e.value=o.value;else if("Record"===e.data_type_name){var t;const l=null===(t=Jo.component_fields)||void 0===t?void 0:t.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value)}})})}),jo({action:f._U.addModuleComponents,value:l}),jo({action:f._U.setModuleItems,value:Jo.component_items}),Vo(!1),fo.processModule.isUpdating=!1,Ho({})}}),i.createElement(k.Z,{title:"No",light:!0,clicked:()=>pt(!1)})))),_t&&i.createElement(s.U7,{isOpen:_t,onClose:()=>{},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Cannot delete ".concat(Jo.title,". Some transactions and master data are using this item")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(k.Z,{title:"Close",light:!0,clicked:()=>ft(!1)}))))),At&&i.createElement(s.U7,{isOpen:At,onClose:()=>{},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"80%"}},i.createElement(ie.default,{hasCloseIcon:!0,label:null===fo||void 0===fo||null===(Kl=fo.processModule)||void 0===Kl||null===($l=Kl.module)||void 0===$l?void 0:$l.name,withBack:!1,paymentPath:"begin-module",onClose:()=>Bt(!1),companyData:go,subscriptionInfo:{user_id:wo.id,ref:Wo.id,plan_price:null!==(eo=null===Wo||void 0===Wo?void 0:Wo.plan)&&void 0!==eo?eo:0,currency:null!==(lo=null===Wo||void 0===Wo?void 0:Wo.currency)&&void 0!==lo?lo:"PHP",plan:"CC-".concat(Wo.id),total:null!==(oo=+(null===Wo||void 0===Wo?void 0:Wo.total))&&void 0!==oo?oo:0,billable_users:[wo],duration:0,dlabel:Wo.id},onError:e=>{Yo(e),Bo(!0),Bt(!1),p.h.dispatch((0,c.Xc)({show:!0,message:"Transaction was created but the selected payment mode encountered an issue. Please select another payment option. You may also manually attach your proof of payment",color:"red",bottom:!0})),p.h.dispatch((0,c.RV)({})),oi()}})),ct&&i.createElement(s.U7,{isOpen:ct,onClose:()=>mt(!1),backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"15%"}},i.createElement("div",null,i.createElement(s.jL,{ungrouped:!0,title:"nonmanager"===wo.user_type?"Type an email address to send copy of this transaction (optional)":"Select users to email this transaction (Optional)",columned:!0,withAckButton:!1},"nonmanager"===wo.user_type?i.createElement("input",{placeholder:"Use comma, no space, for multiple email addresses",className:n.emailInput,onChange:e=>{new RegExp(/^([a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)(([, ]+[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])\.([a-z0-9]([a-z0-9-]*[a-z0-9]))*)?)*$/).test(e.target.value)&&Tt(e.target.value.split(","))}}):i.createElement(B.Cm,{id:"Users",tagEmplacement:"inlined",searchable:!1,items:Pt.filter(e=>{var l;return e.department===(null===(l=wo.departments[0])||void 0===l?void 0:l.name)}),groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:[],className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?Tt(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.user.email)):Tt([])}})),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(k.Z,{title:"Back",light:!0,clicked:()=>mt(!1)}),i.createElement(k.Z,{disabled:!1===(null===go||void 0===go?void 0:go.start),title:Xo?"Update":Qo&&null!==(to=null===fo||void 0===fo||null===(io=fo.processModule)||void 0===io||null===(no=io.module)||void 0===no||null===(ao=no.options)||void 0===ao?void 0:ao.save)&&void 0!==to?to:"Save",loading:nt,style:{marginLeft:"0px"},clicked:()=>{mt(!1),ti()}})))),zo&&0==(null===fo||void 0===fo||null===(so=fo.processModule)||void 0===so?void 0:so.stepIndex)&&i.createElement(s.U7,{isOpen:zo,onClose:()=>Go(!1),hasCloseIcon:!!A.tq,backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:"100%",height:"auto",minWidth:A.tq?"100%":"1000px",backgroundColor:A.tq?"":"transparent"}},i.createElement("div",{"app-variant-is-mobile":A.tq?"true":"false",style:{display:"flex",justifyContent:"center",flexDirection:"column"}},i.createElement(ge,{ref:Qt,begunModule:fo,allModules:ho,companyData:go,components:yo,selectedComponent:Jo,companyUsersArray:So,print:tt,step:d.Nb,companyPositionsArray:Zo,authenticatedUser:wo,setIsOpen:Go,setSelectedComponent:Ho},(null===Jo||void 0===Jo||null===(uo=Jo.component_fields)||void 0===uo?void 0:uo.length)>0&&i.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",padding:tt?"0 30%":"0 15%"}},Mi)))),yt&&i.createElement(s.U7,{isOpen:yt,hasCloseIcon:!0,onClose:()=>No?Xt("/"):Mt(!1),backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:A.tq?"100%":"30%",height:"auto"}},i.createElement("div",{style:{textAlign:"center",padding:"0 20px"}},i.createElement("p",{className:n.modalTitle},null===(ro=fo.processModule.module)||void 0===ro?void 0:ro.name),i.createElement("p",{className:n.modalSubTitle},null!==(vo=null===fo||void 0===fo||null===(po=fo.processModule)||void 0===po||null===(co=po.module)||void 0===co||null===(mo=co.options)||void 0===mo?void 0:mo.message)&&void 0!==vo?vo:"Transaction saved"))))})}}]);
//# sourceMappingURL=4845.e53f1fb2.chunk.js.map