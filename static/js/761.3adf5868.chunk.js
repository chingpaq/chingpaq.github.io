"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[761],{60761:(e,t,l)=>{l.d(t,{Z:()=>z});var n=l(1413),a=l(67861),o=l(39518),s=l(11577),i=l(93389),d=l(88374);const r="ProcessStepsChart_host__Ubvna",p="ProcessStepsChart_target__lLbWe",c="ProcessStepsChart_startContainer__1AZuF",u="ProcessStepsChart_placeholderContainer__HI-Ue",v="ProcessStepsChart_paragraph__D9Hr2",m="ProcessStepsChart_tree__uqAbd",f="ProcessStepsChart_step__1kNXi";var h=l(49465),g=l(29937),E=l(71265),b=l(14170),_=l(94099),y=l(9204),w=l(80121),Z=l(28550),S=l(88846),k=l(62169),A=l(84634),C=l(30401),N=l(62498),x=l(19194),P=l(49893);l(67122);const F=e=>{var t,l;return a.createElement("aside",null,a.createElement("div",{className:"title"},null!==(t=null===e||void 0===e?void 0:e.title)&&void 0!==t?t:"Workflow"),a.createElement("div",{className:"subtitle"},null!==(l=null===e||void 0===e?void 0:e.subtitle)&&void 0!==l?l:"Hello world"),a.createElement("div",{className:"description"},"Drag box to the right pane to add a new step."),a.createElement("br",null),a.createElement("div",{className:"dndnode input",onDragStart:e=>((e,t)=>{e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.effectAllowed="move"})(e,"input"),draggable:!0},"New Step"),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("div",{className:"description"},"You can connect a step to another step by dragging the handles of the box bottom on top of the handle of the target step. A plus sign should appear. A saved step message will appear if the connection is allowed."),a.createElement("br",null),a.createElement("div",{className:"description"},"To rearrange the positions of the step in the layout, make sure to unlock the lower left lock button. Drag the step to your desired location."),a.createElement("br",null),a.createElement("div",{className:"description"},"To delete a connection, click the line(or its label), then press delete (or backspace for some keyboards) The line should disappear and a saved step message should appear."))};var O=l(12075),D=l(52902),T=l(67861);const R=[],j=e=>{const t=[],l=Object.keys(e).length,n=window.innerHeight/(l+1),a=window.innerWidth/3;let o=1;for(const _ in e)if(Object.hasOwnProperty.call(e,_)){var s,i,d,r,p,c,u,v,m,f,h,g,E,b;const l=e[_],y={y:null!==(s=l.step)&&void 0!==s&&null!==(i=s.options)&&void 0!==i&&null!==(d=i.layout)&&void 0!==d&&d.y?null===(r=l.step)||void 0===r||null===(p=r.options)||void 0===p||null===(c=p.layout)||void 0===c?void 0:c.y:1==o?0:n*o-1,x:null!==(u=l.step)&&void 0!==u&&null!==(v=u.options)&&void 0!==v&&null!==(m=v.layout)&&void 0!==m&&m.x?null===(f=l.step)||void 0===f||null===(h=f.options)||void 0===h||null===(g=h.layout)||void 0===g?void 0:g.x:(null===(E=l.step)||void 0===E||null===(b=E.parent_steps)||void 0===b?void 0:b.length)>1?a+400:a};o++,t.push({id:_,type:1==l.step.is_start?"output":1==l.step.is_end?"input":l.childOf?"default":"input",data:{label:l.label,step:l.step},position:y,sourcePosition:"top",targetPosition:"bottom"})}return t},W=e=>{const t=[];for(const l in e)if(Object.hasOwnProperty.call(e,l)){const n=e[l];n.childOf&&n.childOf.filter(e=>{t.push({id:"edge-".concat(l,"-").concat(e.id),source:l,target:e.id,type:"smoothstep",label:"".concat(e.name," \u2b95 ").concat(n.step.name)})})}return t};let $=0;const z=(0,o.$j)(e=>{const{selectedProcess:t,companyProcesses:l,workflowTemplates:n}=e.flowReducer;return{selectedProcess:t,companyProcesses:l,workflowTemplates:n}},e=>({onSetSelectedProStep:t=>e((0,d.Sc)(t))}))(e=>{const t=(0,E.Z)(),{selectedProcess:l,onEditStep:o,companyProcesses:d,workflowTemplates:z,updateParent:B=()=>{},edit:H=!1,updateStep:I=()=>{}}=e,[X,q]=(0,g._M)(),[G,L]=(0,a.useState)(!1),[M,U]=(0,a.useState)(H),[V]=(0,a.useState)(!1),[Y]=(0,a.useState)(!0),J=(0,a.useRef)(null),[K,Q]=(0,a.useState)(null),[ee,te]=(0,a.useState)(R);(0,a.useEffect)(()=>{var e,t,l;const n=_.Z(null===X||void 0===X?void 0:X.steps.concat(0==(null===X||void 0===X||null===(e=X.steps)||void 0===e?void 0:e.length)||(null===X||void 0===X||null===(t=X.steps)||void 0===t?void 0:t.filter(e=>!0===e.is_end).length)>0?[]:[{name:"",id:"New",new:!0,rank:0,parent_steps:[0==(null===X||void 0===X?void 0:X.steps.length)?[]:null===X||void 0===X?void 0:X.steps[(null===X||void 0===X||null===(l=X.steps)||void 0===l?void 0:l.length)-1]]}]).map(e=>{var t,l;return{[null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:"New"]:{label:""===e.name?"New Step":T.createElement("div",null,T.createElement("div",null,"".concat(e.is_start?"(Start)":""," ")),T.createElement("div",{style:{fontSize:"16px"}},"".concat(e.name)),T.createElement("div",null,"".concat(e.is_end?"(End)":""," "))),childrenOf:e.parent_steps.length>0?e.parent_steps[0].id:null,childOf:null!==(l=null===e||void 0===e?void 0:e.parent_steps)&&void 0!==l?l:[],step:e}}}));te([...j(n),...W(n)])},[null===X||void 0===X?void 0:X.steps]);(0,a.useEffect)(()=>{if(""!==l.name&&""!==l.id){var e;let n=d.find(e=>e.id===l.id);if(n||(n=z.find(e=>e.id===l.id)),n&&(null===(e=n)||void 0===e?void 0:e.steps.length)>0){const e=e=>Z.Z("_uuid",(0,h.mR)(),e),t=S.Z(k.Z(A.Z("rank")),y.Z(C.Z(N.Z("component_blueprints"),y.Z(e))))(n.steps);q({type:g.Cb.setAllSteps,value:t})}else L(!0),(0,i.zJ)(l.id).pipe((0,s.P)()).subscribe({next:e=>{var l;if((null===e||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0){const l=e=>Z.Z("_uuid",(0,h.mR)(),e),n=S.Z(k.Z(A.Z("rank")),y.Z(C.Z(N.Z("component_blueprints"),y.Z(l))))(e.steps);q({type:g.Cb.setAllSteps,value:n}),t()&&L(!1)}else L(!1)},error:e=>{t()&&L(!1)}})}},[l]);const le=e=>{var l,a,d;const{step:r}=e;return T.createElement(x.O,{label:T.createElement("div",{className:p,style:{display:""},onClick:()=>{var e;q({type:g.Cb.setSelectedStep,value:(0,n.Z)((0,n.Z)({},r),{},{parent_steps:y.Z(w.Z(["id","name","rank"]))(null!==(e=null===r||void 0===r?void 0:r.parent_steps)&&void 0!==e?e:[])})}),o()}},T.createElement("div",{className:c},T.createElement("div",{className:f,"app-card-type":"start"},T.createElement("p",{className:v},null===r||void 0===r?void 0:r.name))))},(null===r||void 0===r?void 0:r.next_steps)&&(null===r||void 0===r||null===(l=r.next_steps)||void 0===l?void 0:l.map((e,t)=>T.createElement(le,{key:t,step:null===X||void 0===X?void 0:X.steps.find(t=>t.id===e.id)}))),(null===r||void 0===r?void 0:r.pathway_steps)&&(null===r||void 0===r||null===(a=r.pathway_steps)||void 0===a?void 0:a.map((e,t)=>T.createElement(x.O,{key:t,label:T.createElement("div",{className:m},e.name)}))),(null===r||void 0===r?void 0:r.pathway_processes)&&(null===r||void 0===r||null===(d=r.pathway_processes)||void 0===d?void 0:d.map((e,l)=>T.createElement(x.O,{key:l,label:T.createElement("div",{className:m,onClick:()=>{L(!0),(0,i.hI)({processId:e.id}).pipe((0,s.P)()).subscribe({next:e=>{const l=S.Z(k.Z(A.Z("rank")),y.Z(C.Z(N.Z("component_blueprints"),y.Z(e=>Z.Z("_uuid",(0,h.mR)(),e)))))(e);q({type:g.Cb.setAllSteps,value:l}),t()&&L(!1)},error:e=>{t()&&L(!1)}})}},"Process: ".concat(e.name))}))),!0===(null===r||void 0===r?void 0:r.is_end)&&0==(null===X||void 0===X?void 0:X.steps.filter(e=>{var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)}).length)&&T.createElement(x.O,{label:T.createElement("div",{className:m},"End Step")}))};return T.createElement("div",null,G&&""!==l.name&&""!==l.id&&T.createElement("div",{className:u,style:{display:""}},T.createElement(b.$j,{size:80,type:"ThreeDots"})),M&&T.createElement("div",{className:"dndflow"},T.createElement(P.tV,null,T.createElement("div",{className:"reactflow-wrapper",ref:J},T.createElement(P.ZP,{elements:ee,nodesDraggable:!1,onConnectStart:(e,t)=>{},onConnect:e=>{if(new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e.source)||new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e.target)){const t=X.steps.find(t=>t.id===e.target);if(t&&1==t.is_end)return;B(e.source,e.target,!0),te(t=>(0,P.Z_)(e,t))}},onElementsRemove:e=>{var t;if((null===e||void 0===e?void 0:e.length)>0)if(null!==(t=e[0])&&void 0!==t&&t.id.includes("edge"))new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e[0].source)&&new RegExp(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/).test(e[0].target)&&B(e[0].source,e[0].target,!1);else{const t=e.find(e=>!e.id.includes("edge"));var l;if(t)q({type:g.Cb.setSelectedStep,value:(0,n.Z)((0,n.Z)({},t.data.step),{},{parent_steps:y.Z(w.Z(["id","name","rank"]))(null!==(l=null===t||void 0===t?void 0:t.data.step.parent_steps)&&void 0!==l?l:[])})}),o()}te(t=>(0,P.d0)(e,t))},onLoad:e=>{Q(e),setTimeout(e.fitView)},onDrop:e=>{e.preventDefault();const t=J.current.getBoundingClientRect(),n=e.dataTransfer.getData("application/reactflow"),a=K.project({x:e.clientX-t.left,y:e.clientY-t.top}),s={id:"dndnode_".concat($++),type:n,position:a,sourcePosition:"top",targetPosition:"bottom",data:{label:"New Step ".concat(n),step:{name:"",new:!0}}};q({type:g.Cb.addNewStep,value:l.id}),te(e=>e.concat(s)),o()},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},paneMoveable:V,panOnScroll:Y,snapToGrid:!0,onNodeDragStop:(e,t)=>{var l,a,o;q({type:g.Cb.setSelectedStep,value:(0,n.Z)((0,n.Z)({},t.step),{},{layout:null===t||void 0===t?void 0:t.position})}),I((0,n.Z)((0,n.Z)({},null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.step),{},{options:(0,n.Z)((0,n.Z)({},null===t||void 0===t||null===(a=t.data)||void 0===a||null===(o=a.step)||void 0===o?void 0:o.options),{},{layout:t.position})}))},onNodeDoubleClick:(e,t)=>{var a,s,i,d,r;1==(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(s=a.step)||void 0===s?void 0:s.new)?q({type:g.Cb.addNewStep,value:l.id}):q({type:g.Cb.setSelectedStep,value:(0,n.Z)((0,n.Z)({},t.data.step),{},{parent_steps:y.Z(w.Z(["id","name","rank"]))(null!==(i=null===t||void 0===t||null===(d=t.data)||void 0===d||null===(r=d.step)||void 0===r?void 0:r.parent_steps)&&void 0!==i?i:[]),layout:null===t||void 0===t?void 0:t.position})});o()}},T.createElement(P.ZX,null),T.createElement(P.Aq,{variant:"lines"}))),T.createElement(F,{title:l.name,subtitle:l.description}))),T.createElement("div",{className:r,"app-is-preview":"false",style:{display:(null===X||void 0===X?void 0:X.steps.length)>0&&!M?"":"none"}},!G&&(null===X||void 0===X?void 0:X.steps.length)>0&&T.createElement("div",null,T.createElement(x.m,{lineWidth:"2px",lineColor:"green",lineBorderRadius:"10px",label:T.createElement("div",{className:m,style:{fontSize:"26px",padding:"30px 10px",display:(null===X||void 0===X?void 0:X.steps.length)>0?"":"none",maxWidth:"50%"}},l.name,T.createElement("p",null,l.description))},(null===X||void 0===X?void 0:X.steps.length)>0&&T.createElement(le,{step:null===X||void 0===X?void 0:X.steps.find(e=>1===e.rank)})),T.createElement(x.m,{lineWidth:"0px",lineColor:"transparent"},(null===X||void 0===X?void 0:X.steps.length)>0&&(null===X||void 0===X?void 0:X.steps.filter(e=>{var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)}).length)>0&&T.createElement(le,{step:null===X||void 0===X?void 0:X.steps.find(e=>{var t;return 1!==e.rank&&0==(null===e||void 0===e||null===(t=e.parent_steps)||void 0===t?void 0:t.length)})})))),(null===X||void 0===X?void 0:X.steps.length)>0>0&&o&&T.createElement("div",{style:{float:"right"}},T.createElement(b.zx,{icon:T.createElement(O.G,{style:{width:"20px",height:"20px"},icon:M?D.IE:D.Bkj}),light:!0,title:M?"Chart":"Builder",clicked:()=>{U(!M)}})))})}}]);
//# sourceMappingURL=761.3adf5868.chunk.js.map