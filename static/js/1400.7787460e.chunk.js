"use strict";(self.webpackChunkflowhero=self.webpackChunkflowhero||[]).push([[1400],{32422:(e,l,o)=>{o.d(l,{rr:()=>Fe,ZP:()=>We});var t=o(1413),i=o(67861);const n={processStepHost:"ModuleStep_processStepHost__fdU12",listContainer:"ModuleStep_listContainer__+T0XF",listContainerMob:"ModuleStep_listContainerMob__7T+-i",detailContainer:"ModuleStep_detailContainer__EFIwE",centeredCardMargin:"ModuleStep_centeredCardMargin__eYosE",centeredSpinner:"ModuleStep_centeredSpinner__sOFdo",emptyElementsSection:"ModuleStep_emptyElementsSection__ehjx-",stepCounter:"ModuleStep_stepCounter__mD22I",clockIcon:"ModuleStep_clockIcon__TY0er",stepTitle:"ModuleStep_stepTitle__f9SxJ",stepTitleSmaller:"ModuleStep_stepTitleSmaller__Ng9ym",stepGuidance:"ModuleStep_stepGuidance__aWqq0",stepGuidanceSmaller:"ModuleStep_stepGuidanceSmaller__IKIF+",inputContainer:"ModuleStep_inputContainer__s9qZ2",selectInput:"ModuleStep_selectInput__LcokN",multiselectWithSearch:"ModuleStep_multiselectWithSearch__qMOzq",smoMultiselectParent:"ModuleStep_smoMultiselectParent__Pweb-",selectMenuItem:"ModuleStep_selectMenuItem__i73KN",inputClassName:"ModuleStep_inputClassName__VI3pY",toggleMenuInputButton:"ModuleStep_toggleMenuInputButton__gcFHY",goToNextStep:"ModuleStep_goToNextStep__ePl+k",nextStepsContainer:"ModuleStep_nextStepsContainer__zcpA0",nextStepImageContainer:"ModuleStep_nextStepImageContainer__55MGd",nextStepWrapper:"ModuleStep_nextStepWrapper__ZtiNA",headerContainer:"ModuleStep_headerContainer__4kozo",content:"ModuleStep_content__ClnRX","react-grid-layout":"ModuleStep_react-grid-layout__21OCf",layoutJSON:"ModuleStep_layoutJSON__tFPI9",columns:"ModuleStep_columns__dPw3m","react-grid-item":"ModuleStep_react-grid-item__tFcr7","react-grid-placeholder":"ModuleStep_react-grid-placeholder__canbf",resizing:"ModuleStep_resizing__xUUDG",static:"ModuleStep_static__IPrAy",text:"ModuleStep_text__MzRSh",minMax:"ModuleStep_minMax__SkZxD",add:"ModuleStep_add__aOZYV","react-grid-dragHandleExample":"ModuleStep_react-grid-dragHandleExample__iEu5W",cssTransforms:"ModuleStep_cssTransforms__aN9IT","react-draggable-dragging":"ModuleStep_react-draggable-dragging__epzS0","react-resizable-handle":"ModuleStep_react-resizable-handle__XaFka",singleButton:"ModuleStep_singleButton__+BXaC",menuRightButtons:"ModuleStep_menuRightButtons__r-OPw",menuButtons:"ModuleStep_menuButtons__TsY6r",menuAccordionButtons:"ModuleStep_menuAccordionButtons__4QNWj",detailLabel:"ModuleStep_detailLabel__hVTU1",subLabel:"ModuleStep_subLabel__6PFJJ",modalHeaderTitle:"ModuleStep_modalHeaderTitle__hDlRr",p:"ModuleStep_p__njhI7",accordionContainer:"ModuleStep_accordionContainer__oW7nH",itemsTable:"ModuleStep_itemsTable__ttZKV",sharesTable:"ModuleStep_sharesTable__Gy1CG",peoplePositionsSelect:"ModuleStep_peoplePositionsSelect__jXRrK",peoplePositionsSelectInput:"ModuleStep_peoplePositionsSelectInput__NSg8e",peoplePositionsSelectMenuOverlay:"ModuleStep_peoplePositionsSelectMenuOverlay__S0xqm",peoplePositionsSelectMenuOverlayItem:"ModuleStep_peoplePositionsSelectMenuOverlayItem__Vuo-D",deleteText:"ModuleStep_deleteText__XIVyR",deleteButton:"ModuleStep_deleteButton__PhwaV",searchContainer:"ModuleStep_searchContainer__s1Y37",searchInput:"ModuleStep_searchInput__XukKm",emailInput:"ModuleStep_emailInput__sTwU9",actionsContainer:"ModuleStep_actionsContainer__jWMeW",detailButton:"ModuleStep_detailButton__w7F3v",detailButtonTitleContainer:"ModuleStep_detailButtonTitleContainer__8ffTu",fetchingLatestP:"ModuleStep_fetchingLatestP__gnf89",modalTitle:"ModuleStep_modalTitle__T4SaB",modalSubTitle:"ModuleStep_modalSubTitle__SIFKS",dropdownSelectComponent:"ModuleStep_dropdownSelectComponent__L66Sz",dropdownSelectComponentL:"ModuleStep_dropdownSelectComponentL__wOEsz",dropdownSelectOperation:"ModuleStep_dropdownSelectOperation__DEwuW",dropdownSelectReport:"ModuleStep_dropdownSelectReport__g2+2D",cardTitle:"ModuleStep_cardTitle__h24lD",customButton:"ModuleStep_customButton__sVkp5",fieldTypeInput:"ModuleStep_fieldTypeInput__q1+bw",fieldRowContainer:"ModuleStep_fieldRowContainer__5hIbd",templateInformation:"ModuleStep_templateInformation__UjdWL",emulatedFlexGap:"ModuleStep_emulatedFlexGap__yE15Q","mobile-navbar":"ModuleStep_mobile-navbar__P0z8E","mobile-navbar-close":"ModuleStep_mobile-navbar-close__5fZ-y","hamb-icon":"ModuleStep_hamb-icon__lSxYR","open-nav":"ModuleStep_open-nav__39a-n",description:"ModuleStep_description__GUBFo",tableHostSimple:"ModuleStep_tableHostSimple__VmM5x",imageCard:"ModuleStep_imageCard__HGrB9",imageColumn:"ModuleStep_imageColumn__IBD9y",imageLogoPrint:"ModuleStep_imageLogoPrint__I5-r0",title:"ModuleStep_title__whugX",statusBox:"ModuleStep_statusBox__qcpUN",checkboxLabelClass:"ModuleStep_checkboxLabelClass__h93jt"};var d=o(85692),a=o(39518),s=o(48929),u=o(6073),r=o(93389),v=o(34710),c=o(88827),p=o(88374),m=o(11577),_=o(10103),f=o(88550),y=o(49119),h=o(79633),g=o(73500),b=o(47144),M=o.n(b),E=o(27436),C=(o(68140),o(12308)),w=o(35606),x=o(13397),S=o(98032),k=o(79544),Z=o(97606),I=o(8284),D=o(4292),N=o(25403),P=o(74369),T=o(50981),O=o.n(T),q=o(27426),U=o(32562),A=o(12075),Y=o(52902),B=o(49465),L=o(60534),R=o(41756),j=o.n(R);o(16207);const F="StaticAccordionModule_section__E+rSn",W="StaticAccordionModule_accordionContainer__6xeqD",z="StaticAccordionModule_active__39RQh",V="StaticAccordionModule_iconsContainer__YbQ+l",G="StaticAccordionModule_content__-a1q1",X="StaticAccordionModule_fieldTypeInput__78Qbk",J="StaticAccordionModule_fieldTypeTextarea__RF3xI",H="StaticAccordionModule_emulatedFlexGap__F5FQC",Q="StaticAccordionModule_cardTitle__lJnSQ",K="StaticAccordionModule_filtersContainer__oSB5G",$="StaticAccordionModule_actionsContainer__WXbu6",ee="StaticAccordionModule_avatarContentContainer__Kd+Dg",le="StaticAccordionModule_avatarUrlImg__6oG4I",oe="StaticAccordionModule_itemsContainerMob__+BERB";var te=o(48963),ie=o(23280);const ne=(0,i.memo)(e=>{var l,o;const{component:n,components:d,companyData:v,allComponents:_,companyUsersArray:y,selectedComponent:b,setIsOpen:M}=e,{allModules:E,allTasks:P,companyPositionsArray:R,map:F,begunModule:z}=(0,a.v9)(e=>e.flowReducer),[G,Q]=(0,f.pQ)(),[ee,le]=(0,i.useState)(!1),ne=(0,ie.s0)(),de=(null===n||void 0===n||null===(l=n.selected_fields)||void 0===l?void 0:l.length)>0&&w.Z([x.Z(S.Z("index"))])(null===n||void 0===n||null===(o=n.selected_fields)||void 0===o?void 0:o.filter(e=>!0!==e.value||void 0!==(null===e||void 0===e?void 0:e.value)||"Transaction List"===(null===e||void 0===e?void 0:e.data_type_name))).map((e,l)=>{var o,a,x,H,ie;let de=null===(o=b.component_fields.find(l=>l.field_name===(null===e||void 0===e?void 0:e.field_name)&&l.data_type_name===(null===e||void 0===e?void 0:e.data_type_name)))||void 0===o?void 0:o.value;const ae="48%";if((null===e||void 0===e||null===(a=e.options)||void 0===a||null===(x=a.list)||void 0===x?void 0:x.length)>0&&(null===e||void 0===e||null===(H=e.options)||void 0===H||null===(ie=H.component_id)||void 0===ie?void 0:ie.length)>0&&("Step List"===(null===e||void 0===e?void 0:e.data_type_name)||"Component List"===(null===e||void 0===e?void 0:e.data_type_name)))return i.createElement("div",{key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{width:"100%"}},i.createElement(C.default,{columns:e.options.list,list:(me=e.options,d.filter(e=>e.id===me.component_id).map(e=>null===me||void 0===me?void 0:me.list.reduce((l,o)=>(0,t.Z)((0,t.Z)({},l),{},{[o]:e.selected_fields.find(e=>e.field_name===o).value}),{})))}));if("output"===e.data_type&&"Formula"!==e.data_type_name&&"Item Formula"!==e.data_type_name&&"Record"!==e.data_type_name&&"Filters"!==e.data_type_name)return null;if("Info"===e.data_type_name)return null;if("Transaction List"===e.data_type_name)return null;if("URL"===e.data_type_name)return null;if("Ratings"===e.data_type_name)return null;if("Rewards"===e.data_type_name)return null;if("Map"===e.data_type_name){var se,ue;const o=JSON.parse(de||(null!==(se=null===e||void 0===e?void 0:e.value)&&void 0!==se?se:"{}"));var re;if(null!==o&&void 0!==o&&null!==(ue=o.routes)&&void 0!==ue&&ue.DRIVE)F.routes={DRIVE:o.routes.DRIVE},F.pins=null!==(re=null===o||void 0===o?void 0:o.pins)&&void 0!==re?re:[];else null!==o&&void 0!==o&&o.pins&&(F.pins=null===o||void 0===o?void 0:o.pins,F.routes={DRIVE:[]});return i.createElement("div",{key:"".concat(null===e||void 0===e?void 0:e.id).concat(l)})}if("Lookup"===e.data_type_name)return null;if("Calendar"===e.data_type_name)return null;if("Summary"===e.data_type_name)return null;var ve,ce,pe,me;if("ID"===e.data_type_name)return i.createElement(h.D,{key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),width:g.tq?"100%":ae,fieldLabel:null!==(ve=null===e||void 0===e||null===(ce=e.options)||void 0===ce?void 0:ce.label)&&void 0!==ve?ve:e.field_name,style:{border:"0"},fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},i.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},type:e.data_type,onChange:()=>{},autoComplete:"none",value:null!==(pe=de)&&void 0!==pe?pe:null===e||void 0===e?void 0:e.value,className:X,name:e.field_name}));{var _e,fe,ye,he,ge,be,Me,Ee,Ce,we,xe,Se,ke,Ze,Ie,De,Ne;const o=null===n||void 0===n||null===(_e=n.selected_fields)||void 0===_e?void 0:_e.find(e=>"Info"===e.data_type_name&&!0===e.visible);if(o){const l=_.find(e=>(null===e||void 0===e?void 0:e.component_fields.filter(e=>e.component_blueprint_id===o.options.component_id&&e.value===de).length)>0);var Pe,Te;if(l)return null===o||void 0===o||null===(Pe=o.options)||void 0===Pe||null===(Te=Pe.list)||void 0===Te?void 0:Te.map((o,t)=>{var n,d;const a=null!==(n=null===(d=l.component_fields.find(e=>e.field_name===o))||void 0===d?void 0:d.value)&&void 0!==n?n:"";return null!==a&&void 0!==a&&a.includes("jpg")||null!==a&&void 0!==a&&a.includes("jpeg")||null!==a&&void 0!==a&&a.includes("png")?i.createElement(h.D,{width:g.tq?"100%":ae,style:{border:"0"},key:100+t,isProcess:!0,visible:e.visible&&(null===b||void 0===b?void 0:b.show),mandatory:!1,error:e.errors,fieldLabel:"Additional Information",customIconBgColor:"white"},i.createElement("div",{className:W,onClick:()=>window.open(de,"_blank"),style:{backgroundColor:"transparent",border:"none"}},i.createElement("img",{alt:"lg",onError:e=>e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg",src:a,style:{width:"100%",height:"100%",cursor:"pointer"}}))):i.createElement(h.D,{enabled:!1,width:g.tq?"100%":ae,key:100+t,style:{border:"0"},fieldLabel:o,fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors},a.length>55?i.createElement("textarea",{className:J,type:e.data_type,value:a,onFocus:()=>{},autoComplete:"none",onChange:e=>{},readOnly:!0,style:{backgroundColor:"rgba(234, 231, 231, 0.91)",height:"auto",padding:"10px"}}):i.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},autoComplete:"none",value:a,className:X,name:e.field_name}))})}if("Pin"===e.data_type_name&&de){var Oe,qe,Ue,Ae,Ye,Be,Le,Re,je,Fe,We;const o=JSON.parse(de);return i.createElement(h.D,{enabled:!1,width:g.tq?"100%":"92%",key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(Oe=null===e||void 0===e||null===(qe=e.options)||void 0===qe?void 0:qe.label)&&void 0!==Oe?Oe:e.field_name,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors},i.createElement("div",{style:{width:"inherit",pointerEvents:"none"}},i.createElement(q.Z,{zoom:null===e||void 0===e||null===(Ue=e.options)||void 0===Ue?void 0:Ue.zoom,mapkey:null===(Ae=v.misc_info)||void 0===Ae?void 0:Ae.map,pins:null!==o&&void 0!==o&&o.realtime?null!==o&&void 0!==o&&null!==(Ye=o.destination)&&void 0!==Ye&&Ye.address?[(0,t.Z)((0,t.Z)({},o.destination),{},{type:"destination"}),(0,t.Z)((0,t.Z)({},o.source),{},{type:"source"}),(0,t.Z)((0,t.Z)({},o.realtime),{},{type:"realtime"})]:[(0,t.Z)((0,t.Z)({},o.source),{},{type:"source"}),(0,t.Z)((0,t.Z)({},o.realtime),{},{type:"realtime"})]:null!==o&&void 0!==o&&null!==(Be=o.destination)&&void 0!==Be&&Be.address?[(0,t.Z)((0,t.Z)({},o.destination),{},{type:"destination"}),(0,t.Z)((0,t.Z)({},o.source),{},{type:"source"})]:[(0,t.Z)((0,t.Z)({},o.source),{},{type:"source"})]}),i.createElement("div",{className:K,style:{color:"var(--app-color-gray-dark)",height:"inherit",width:"100%",display:null!==e&&void 0!==e&&e.visible?"":"none"}},i.createElement("div",{className:$,style:{fontSize:"12px"}},(null===o||void 0===o||null===(Le=o.destination)||void 0===Le?void 0:Le.address)&&i.createElement("div",{style:{width:"100px",fontWeight:"bold",fontSize:"14px"}},"From",":"),i.createElement("div",{style:{fontWeight:"bold"}},o.source.address),!(null!==o&&void 0!==o&&null!==(Re=o.destination)&&void 0!==Re&&Re.address)&&i.createElement(A.G,{icon:Y.opg,style:{color:"green",height:"20px",width:"20px"}})),(null===o||void 0===o||null===(je=o.destination)||void 0===je?void 0:je.address)&&i.createElement("hr",{style:{borderTop:"0.5px solid #D2D2D2"}}),(null===o||void 0===o||null===(Fe=o.destination)||void 0===Fe?void 0:Fe.address)&&i.createElement("div",{className:$,style:{fontSize:"12px"}},i.createElement("div",{style:{width:"100px",fontWeight:"bold"}},"To",":"),i.createElement("div",{style:{fontWeight:"bold"}},null===o||void 0===o||null===(We=o.destination)||void 0===We?void 0:We.address)))))}if("Action Button"===(null===e||void 0===e?void 0:e.data_type_name)&&(null===e||void 0===e||null===(fe=e.options)||void 0===fe||null===(ye=fe.action)||void 0===ye?void 0:ye.length)>0){var ze,Ve,Ge,Xe,Je;const o=null===y||void 0===y?void 0:y.find(e=>e.id===de);return i.createElement(h.D,{width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},isProcess:!0,fieldLabel:null!==(ze=e.options)&&void 0!==ze&&ze.notes?null===(Ve=e.options)||void 0===Ve?void 0:Ve.notes:null!==(Ge=null===e||void 0===e||null===(Xe=e.options)||void 0===Xe?void 0:Xe.label)&&void 0!==Ge?Ge:e.field_name,enabled:!1,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors},"user"===e.options.action&&i.createElement("input",{style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:o?"".concat(null===o||void 0===o?void 0:o.first_name," ").concat(null===o||void 0===o?void 0:o.last_name):null!==(Je=null===e||void 0===e?void 0:e.value)&&void 0!==Je?Je:"",className:X,name:e.field_name}))}var He,Qe,Ke,$e,el,ll,ol,tl,il,nl,dl,al,sl,ul,rl,vl,cl,pl,ml,_l,fl,yl,hl,gl,bl,Ml,El,Cl,wl,xl,Sl,kl;if("Link"===e.data_type_name||"Image"===e.data_type_name)return i.createElement(h.D,{fieldLabel:null!==(He=e.options)&&void 0!==He&&He.notes?null===(Qe=e.options)||void 0===Qe?void 0:Qe.notes:null!==(Ke=null===e||void 0===e||null===($e=e.options)||void 0===$e?void 0:$e.label)&&void 0!==Ke?Ke:e.field_name,width:"100%",style:{border:"0"},key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors,customIconBgColor:"white"},null!==(el=de)&&void 0!==el&&el.includes("jpg")||null!==(ll=de)&&void 0!==ll&&ll.includes("jpeg")||null!==(ol=de)&&void 0!==ol&&ol.includes("png")||null!==e&&void 0!==e&&null!==(tl=e.options)&&void 0!==tl&&tl.image?i.createElement("img",{alt:"lg",onError:e=>e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg",src:null!==(il=de)&&void 0!==il?il:"https://i.quotev.com/b2gtjqawaaaa.jpg",style:{width:"100%",height:"100%",cursor:"pointer"},onClick:()=>navigator.clipboard.writeText(de)}):null!==(nl=de)&&void 0!==nl&&nl.includes("pdf")?i.createElement("div",{className:W,onClick:()=>window.open(de,"_blank")},i.createElement("embed",{onClick:()=>window.open(de,"_blank"),src:"".concat(de,"#toolbar=0&navpanes=0&scrollbar=0"),width:"400px",height:"500px"})):de?i.createElement("div",{style:{width:"inherit",textDecoration:"underline",textAlign:"center",cursor:"pointer"},onClick:()=>window.open(de,"_blank")},"Link"):i.createElement("div",null));if("Freehand"===e.data_type_name)return i.createElement(h.D,{width:g.tq?"100%":ae,style:{border:"0"},key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white"},i.createElement("div",{className:W,onClick:()=>window.open(de,"_blank")},i.createElement("img",{alt:"lg",onError:e=>e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg",src:null!==(dl=de)&&void 0!==dl?dl:"https://i.quotev.com/b2gtjqawaaaa.jpg",style:{width:"100%",height:"100%",cursor:"pointer"}})));if("Checkbox"===e.data_type_name)return i.createElement(h.D,{width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(al=e.options.value)&&void 0!==al?al:null!==(sl=null===e||void 0===e||null===(ul=e.options)||void 0===ul?void 0:ul.label)&&void 0!==sl?sl:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},i.createElement("input",{style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:void 0===de?"":1==de?"Yes":"No",className:X,name:e.field_name}));if("YesNo"===e.data_type_name)return i.createElement(h.D,{width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0.5px dashed gray",padding:"10px"},fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},i.createElement("div",{style:{display:"flex",justifyContent:"space-between",margin:"20px 0px"}},i.createElement("input",{id:"check-23",type:"checkbox",readOnly:!0,checked:!!de}),i.createElement("label",null,e.field_name)));if("Upload"===e.data_type_name)return i.createElement(h.D,{key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),fieldLabel:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:void 0!==de||(null===(rl=de)||void 0===rl?void 0:rl.length)>0,mandatory:!1,error:e.errors,customIconBgColor:"white",style:{border:"0",marginRight:"10px"}},i.createElement("a",{key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),href:de,download:"Example-PDF-document",target:"_blank",rel:"noreferrer"},i.createElement(s.zx,{clear:!0,title:"Download File"})));if("Status"===e.data_type_name)return i.createElement(h.D,{width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(vl=null===e||void 0===e||null===(cl=e.options)||void 0===cl?void 0:cl.label)&&void 0!==vl?vl:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:void 0!==(null===e||void 0===e?void 0:e.value)||e.visible,mandatory:!1,error:e.errors,customIconBgColor:"white",enabled:!1},i.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:null!==(pl=null===b||void 0===b?void 0:b.status)&&void 0!==pl?pl:null!==(ml=null!==(_l=null===e||void 0===e?void 0:e.value)&&void 0!==_l?_l:de)&&void 0!==ml?ml:"",className:X,name:e.field_name}));if("Dropdown"===e.data_type_name)if("modules"===e.options)de=null===(fl=E.find(e=>e.id===de))||void 0===fl?void 0:fl.name;if("Positions"===e.data_type_name)de=null===R||void 0===R||null===(yl=R.find(e=>e.value===de))||void 0===yl?void 0:yl.label;if("People"===e.data_type_name)if(e.options.calendar){var Zl;let o={};try{var Il,Dl;o=JSON.parse(null!==(Il=de)&&void 0!==Il?Il:null!==(Dl=null===e||void 0===e?void 0:e.value)&&void 0!==Dl?Dl:JSON.stringify({}))}catch(Gl){}const t=y.find(e=>{var l;return e.id===(null===(l=o)||void 0===l?void 0:l.user)});if(de=t?"".concat(t.first_name," ").concat(t.last_name):"",null!==(Zl=o)&&void 0!==Zl&&Zl.task){var Nl,Pl,Tl;const t=P.find(e=>e.id===o.task);return i.createElement(h.D,{enabled:!1,width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(Nl=null===e||void 0===e||null===(Pl=e.options)||void 0===Pl?void 0:Pl.label)&&void 0!==Nl?Nl:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors},i.createElement("div",{style:{display:"flex",flexDirection:"column",width:"inherit"}},i.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:de,readOnly:!0,className:X,name:e.field_name}),t&&i.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:null===t||void 0===t?void 0:t.name,readOnly:!0,className:X,name:e.field_name}),t&&i.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:O()(new Date(null===t||void 0===t||null===(Tl=t.add_info)||void 0===Tl?void 0:Tl.start)).format("DD MMM YYYY h:mm a"),readOnly:!0,className:X,name:e.field_name}),(null===t||void 0===t?void 0:t.status)&&i.createElement("input",{style:{pointerEvents:"none"},autoComplete:"none",value:null===t||void 0===t?void 0:t.status,readOnly:!0,className:X,name:e.field_name})))}}else if(!de){const l=y.find(l=>l.id===e.value);de=l?"".concat(l.first_name," ").concat(l.last_name):""}if("Video"===e.data_type_name&&(null===b||void 0===b?void 0:b.status)===(null!==(he=null===e||void 0===e||null===(ge=e.options)||void 0===ge?void 0:ge.status)&&void 0!==he?he:"New"))if((null!==e&&void 0!==e&&e.value||de)&&O()(null!==(hl=null===e||void 0===e?void 0:e.value)&&void 0!==hl?hl:de)<=(0,T.now)()&&(0,T.now)()<O()(null!==(gl=null===e||void 0===e?void 0:e.value)&&void 0!==gl?gl:de).add("minutes",+(null!==(bl=null===e||void 0===e||null===(Ml=e.options)||void 0===Ml?void 0:Ml.expiry)&&void 0!==bl?bl:30)))return i.createElement(h.D,{width:"100%",key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"1px dashed gray"},fieldLabel:null!==(El=null===e||void 0===e||null===(Cl=e.options)||void 0===Cl?void 0:Cl.label)&&void 0!==El?El:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors},i.createElement("div",{className:$,style:{display:"flex",justifyContent:"center",fontSize:"12px"}},i.createElement(U.Z,{payload:{name:b.id}})));if("Module"===e.data_type_name&&null!==e&&void 0!==e&&null!==(be=e.options)&&void 0!==be&&be.detail&&null!==e&&void 0!==e&&e.visible){var Ol,ql,Ul,Al,Yl,Bl,Ll,Rl,jl,Fl,Wl;const o=E.find(l=>l.id===e.options.module_id),n=w.Z([k.Z(S.Z("created_date"))])(_.filter(e=>e.module_id===o.id)).filter(l=>{var o;const t=null===(o=b.component_fields.find(l=>{var o;return l.field_name===(null===(o=e.options)||void 0===o?void 0:o.key)}))||void 0===o?void 0:o.value;return l.component_fields.find(l=>{var o;return l.value===t&&l.field_name===(null===(o=e.options)||void 0===o?void 0:o.key)})}).map(e=>({id:e.id,Transaction:e.title,"Date Created":"".concat(O()(new Date(e.created_date)).format("DD MMM YYYY h:mm a")),Status:e.status}));return i.createElement("div",{className:V,style:{display:"flex",flexDirection:"column",alignItems:"center",alignContent:"space-between",justifyContent:"center",width:"100%",margin:"40px 0"}},!((null===b||void 0===b?void 0:b.status)===(null!==(Ol=null===z||void 0===z||null===(ql=z.processModule)||void 0===ql||null===(Ul=ql.module)||void 0===Ul||null===(Al=Ul.options)||void 0===Al?void 0:Al.lock)&&void 0!==Ol?Ol:null===v||void 0===v||null===(Yl=v.misc_info)||void 0===Yl?void 0:Yl.lock)||(null===b||void 0===b?void 0:b.status)===(null!==(Bl=null===o||void 0===o||null===(Ll=o.options)||void 0===Ll?void 0:Ll.lock)&&void 0!==Bl?Bl:null===v||void 0===v||null===(Rl=v.misc_info)||void 0===Rl?void 0:Rl.lock))&&i.createElement(s.zx,{style:{backgroundColor:"var(--app-color-blue)",width:"30%"},title:null===e||void 0===e?void 0:e.field_name,message:"Preparing ".concat(o.name," entry..."),loading:ee,clicked:()=>{le(!0),(0,r.zJ)(o.procedure.id).pipe((0,m.P)()).subscribe({next:l=>{var o;if(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.cmp){var i,n,d;const o=null===l||void 0===l||null===(i=l.steps)||void 0===i?void 0:i.find(e=>e.component_blueprints.filter(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name))}).length>0),s=null===o||void 0===o||null===(n=o.component_blueprints)||void 0===n?void 0:n.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Transaction List"===e.data_type_name&&!0===e.visible).length)>0}),r=null===s||void 0===s||null===(d=s.selected_fields)||void 0===d?void 0:d.filter(e=>{var l;return null===(l=e.options)||void 0===l?void 0:l.mapToItem}).reduce((e,l)=>{const o=Z.Z(I.Z("field_name",l.field_name),D.Z(N.Z("selected_fields",G.components.concat(G.newStepComponents))));var i;return o&&(null===o||void 0===o?void 0:o.data_type_name)===l.data_type_name?(0,t.Z)((0,t.Z)({},e),{},{[null===(i=l.options)||void 0===i?void 0:i.mapToItem]:o.value}):e},{});var a;if(Object.values(r).length>0)(0,u.r6)(null===e||void 0===e||null===(a=e.options)||void 0===a?void 0:a.cmp).pipe((0,m.P)()).subscribe({next:l=>{var o,i;(0,u.np)((0,t.Z)((0,t.Z)({},r),{},{index:null===(o=l.component_items)||void 0===o?void 0:o.length,id:(0,B.mR)()}),null===e||void 0===e||null===(i=e.options)||void 0===i?void 0:i.cmp).pipe((0,m.P)()).subscribe({next:e=>{le(!1),c.h.dispatch((0,p.Xc)({show:!0,message:"Success, an item was added."})),M(!1)},error:()=>{}})},error:()=>{}});else le(!1)}else le(!1),G.components=[],G.newStepsComponent=[],e.options.fields.filter(e=>{var o,t;const i=null===(o=b.component_fields.find(l=>l.field_name===e))||void 0===o?void 0:o.value;null===(t=l.steps)||void 0===t||t.forEach(l=>{var o;null===l||void 0===l||null===(o=l.component_blueprints)||void 0===o||o.filter(e=>{var l;return!(null!==(l=e.options)&&void 0!==l&&l.asModuleList)}).forEach(l=>{const o=l.selected_fields.find(l=>l.field_name===e&&1==l.visible);o&&(o.value=i)}),l.component_blueprints.find(l=>l.selected_fields.filter(l=>l.field_name===e).length>0)&&Q({action:f._U.addNewComponent,value:l.component_blueprints.filter(l=>l.selected_fields.filter(l=>l.field_name===e).length>0)})})}),c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},l),{},{completeSteps:l.steps,steps:l.steps,stepIndex:1,module_id:e.options.module_id,module:E.find(l=>l.id===e.options.module_id)}))),Q({action:f._U.setCurrentStep,value:l.steps[1]}),Q({action:f._U.setModuleItems,value:[]}),M(!1),c.h.dispatch((0,p.IW)(!1)),ne("/begin-module")}})}}),(null===e||void 0===e||null===(jl=e.options)||void 0===jl?void 0:jl.showL)&&(null===n||void 0===n?void 0:n.length)>0&&i.createElement(h.D,{fieldLabel:null!==(Fl=null===e||void 0===e||null===(Wl=e.options)||void 0===Wl?void 0:Wl.label)&&void 0!==Fl?Fl:e.field_name,width:"100%",key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),fieldIcon:e.icon,isProcess:!0,visible:e.visible,mandatory:!1,error:e.errors},i.createElement("br",null),i.createElement(L.Z,{style:{width:"100%",marginBottom:"20px"},tableHostSimple:g.tq?oe:te.Z.itemsContainer_ii,withColumns:!1,columns:["Transaction","Date Created","Status"],list:n})))}if("Module"===e.data_type_name)return null;if("Details"===e.data_type_name&&null!==e&&void 0!==e&&null!==(Me=e.options)&&void 0!==Me&&Me.key&&(null===(Ee=e.options)||void 0===Ee||null===(Ce=Ee.fields)||void 0===Ce?void 0:Ce.length)>0){var zl,Vl;const l=_.find(l=>l.module_id===e.options.module_id&&l.component_fields.find(l=>{var o,t;return l.field_name===e.options.key&&l.value===(null===b||void 0===b||null===(o=b.component_fields)||void 0===o||null===(t=o.find(l=>l.field_name===e.options.key&&l.value))||void 0===t?void 0:t.value)}));de=null===l||void 0===l||null===(zl=l.component_fields)||void 0===zl||null===(Vl=zl.find(l=>{var o;return l.field_name===(null===(o=e.options)||void 0===o?void 0:o.fields[0])}))||void 0===Vl?void 0:Vl.value}return"Clock"===e.data_type_name&&(de=O()(new Date(+de)).format("DD MMM YYYY h:mm a")),"Long Text"===e.data_type_name&&null!==(we=e.options)&&void 0!==we&&we.rich?i.createElement(h.D,{enabled:!1,width:g.tq?"100%":"".concat(+(null!==(wl=null===e||void 0===e||null===(xl=e.options)||void 0===xl?void 0:xl.width)&&void 0!==wl?wl:"50")>51?"97":"48","%"),key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(Sl=null===e||void 0===e||null===(kl=e.options)||void 0===kl?void 0:kl.label)&&void 0!==Sl?Sl:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors},i.createElement(j(),{modules:{toolbar:!1},style:{fontFamily:"var(--app-text-main-font)"},readOnly:!0,defaultValue:de,theme:"snow"})):i.createElement(h.D,{enabled:!1,width:g.tq?"100%":ae,key:"".concat(null===e||void 0===e?void 0:e.id).concat(l),style:{border:"0"},fieldLabel:null!==(xe=null===e||void 0===e||null===(Se=e.options)||void 0===Se?void 0:Se.label)&&void 0!==xe?xe:e.field_name,fieldIcon:e.icon,isProcess:!0,visible:!!e.visible&&((null===b||void 0===b?void 0:b.show)||(null===e||void 0===e?void 0:e.value)||de),mandatory:!1,error:e.errors},(null===(ke=de)||void 0===ke?void 0:ke.length)>50&&!g.tq||(null===(Ze=de)||void 0===Ze?void 0:Ze.length)>20&&g.tq&&"Date"!==e.data_type_name?i.createElement("textarea",{readOnly:!0,className:J,style:{padding:"10px",pointerEvents:"none"},onFocus:()=>{},required:!0,value:null===de||void 0===de?"Date"===e.data_type_name||"Video"===e.data_type_name?O()(new Date(null===e||void 0===e?void 0:e.value)).format("DD MMM YYYY"):null===e||void 0===e?void 0:e.value:"Date"===e.data_type_name||"Video"===e.data_type_name?O()(new Date(de)).format("DD MMM YYYY"):de,onChange:e=>{}}):i.createElement("input",{readOnly:!0,style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:null===de||void 0===de?null===e||void 0===e?void 0:e.value:"Dropdown"===e.data_type_name&&"modules"===(null===(Ie=e.options)||void 0===Ie?void 0:Ie.type)?null===(De=E.find(l=>l.id===e.value))||void 0===De?void 0:De.name:"Date"===e.data_type_name||"Video"===e.data_type_name?"Invalid date"===O()(new Date(de)).format("DD MMM YYYY")?"":O()(new Date(de)).format(null!==e&&void 0!==e&&null!==(Ne=e.options)&&void 0!==Ne&&Ne.time?"DD MMM YYYY h:mm a":"MMMM DD, YYYY"):de,className:X,name:e.field_name}))}});return i.createElement("div",{className:H,style:{width:g.tq?"100%":""}},de)}),de=e=>{var l,o,t,n,d;const{component:s,blueprintIndex:u,companyData:r,components:v,allComponents:c,companyUsersArray:p,selectedComponent:m,setIsOpen:_}=e,[y,h]=(0,f.pQ)(),{authenticatedUser:b}=(0,a.v9)(e=>e.authReducer),[C]=(0,i.useState)(z),[w]=(0,i.useState)(""),x=(0,i.useRef)(null),S=null===(l=y.currentStep)||void 0===l?void 0:l.component_blueprints.findIndex(e=>e.id===s.id),k=s.selected_fields.filter(e=>"Pin"===e.data_type_name||"Map"===e.data_type_name).length>0;return i.createElement("div",{id:"accordion",className:F,key:u,style:{display:void 0===(null===(o=s.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=s.options)||void 0===t?void 0:t.showOnly.length)||b.positions.filter(e=>{var l,o;return null===(l=s.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.includes(e.id)}).length>0||(null===(n=s.options)||void 0===n?void 0:n.statusOnly)===(null===m||void 0===m?void 0:m.status)?"":"none"}},i.createElement("div",{className:M()(W,C),"app-variant-has-error":w?"error":""},!(k&&g.tq)&&i.createElement("p",{className:Q},null===s||void 0===s?void 0:s.name),i.createElement("div",{ref:x,style:{maxHeight:C===z?"":"0px",display:"flex"},className:G},i.createElement(ne,{components:v,allComponents:c,component:s,handleInputChange:()=>{},handlePrefixChange:()=>{},handleCurrencyChange:()=>{},checkIfAreMandatoryErrored:!1,handleCheckbox:()=>{},isInherited:!1,indexInContextArray:S,handleLocationChange:()=>{},processTaskContext:y,companyData:r,companyUsersArray:p,selectedComponent:m,setIsOpen:_}))),w&&(null===w||void 0===w||null===(d=w.errors)||void 0===d?void 0:d.title)&&i.createElement(E.Z,{message:w.errors.title}),w&&(null===w||void 0===w?void 0:w.message)&&i.createElement(E.Z,{message:w.message}))},ae=e=>{var l,o,t,n,d,a;const[s,u]=(0,i.useState)(!1),{component:r,show:v=!1,process:c}=e;return i.createElement("div",{className:W},i.createElement("div",{className:H,style:{width:(g.tq,"100%")}},i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Created By",style:{border:"0"},isProcess:!0,visible:!0},i.createElement("input",{onClick:()=>u(!s),readOnly:!0,onChange:()=>{},autoComplete:"none",value:v?null===(l=r.created_by)||void 0===l?void 0:l.id.replace(/\D/g,"").slice(-5):"".concat(null===(o=r.created_by)||void 0===o?void 0:o.first_name," ").concat(null===(t=r.created_by)||void 0===t?void 0:t.last_name),className:X})),(null===r||void 0===r?void 0:r.assigned_to)&&i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Assigned to",style:{border:"0"},isProcess:!0,visible:s},i.createElement("input",{onChange:()=>{},autoComplete:"none",value:"".concat(null===(n=r.assigned_to)||void 0===n?void 0:n.first_name," ").concat(null===(d=r.assigned_to)||void 0===d?void 0:d.last_name),className:X,name:"CID"})),i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Created Date",style:{border:"0"},isProcess:!0,visible:!0},i.createElement("input",{style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:O()(new Date(r.created_date)).format("DD MMM YYYY h:mm a"),className:X,name:"Created Date"})),i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Transaction ID",style:{border:"0"},isProcess:!0,visible:s},i.createElement("input",{onChange:()=>{},autoComplete:"none",value:r.id,className:X,name:"CID"})),i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Transaction Title",style:{border:"0"},isProcess:!0,visible:s},i.createElement("input",{onChange:()=>{},autoComplete:"none",value:r.title,className:X,name:"CID"})),i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Module",style:{border:"0"},isProcess:!0,visible:s},i.createElement("input",{onChange:()=>{},autoComplete:"none",value:null===c||void 0===c||null===(a=c.module)||void 0===a?void 0:a.name,className:X,name:"CID"})),!(null!==r&&void 0!==r&&r.assigned_to)&&i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Process",style:{border:"0"},isProcess:!0,visible:s},i.createElement("input",{onChange:()=>{},autoComplete:"none",value:null===c||void 0===c?void 0:c.name,className:X,name:"CID"}))))},se=e=>{var l,o,t;const{component:n}=e;return i.createElement("div",{className:W,style:{display:n.payments?"":"none"}},i.createElement("div",{className:H,style:{width:(g.tq,"100%")}},i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Payments",style:{border:"0"},isProcess:!0,visible:!0},i.createElement("input",{style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:"".concat(null===(l=n.payments)||void 0===l?void 0:l.stripe_product,", ID: ").concat(null===(o=n.payments)||void 0===o?void 0:o.stripe_id.substring(0,13)),className:X})),i.createElement(h.D,{width:g.tq?"100%":"48%",fieldLabel:"Amount Paid",style:{border:"0"},isProcess:!0,visible:!0},i.createElement("input",{style:{pointerEvents:"none"},onChange:()=>{},autoComplete:"none",value:"".concat(null===(t=n.payments)||void 0===t?void 0:t.stripe_price),className:X}))))},ue=e=>{var l,o,n,d,a,s,u;const{field:r,selectedComponent:v,companyUsersArray:c,component:p}=e,m=e=>{var l,o,t,n,d,a,s,u;const{field:r,index:v,item:m}=e;if("People"===(null===r||void 0===r?void 0:r.data_type_name)&&(null===r||void 0===r||null===(l=r.options)||void 0===l||null===(o=l.position_id)||void 0===o?void 0:o.length)>0){const e=c.find(e=>(null===r||void 0===r?void 0:r.value)==="".concat(e.first_name," ").concat(e.last_name));return i.createElement("div",{style:{display:"flex",justifyContent:"center"}},e&&i.createElement("div",{className:ee},i.createElement("img",{alt:"lg",src:null===e||void 0===e?void 0:e.photo,className:le})))}var _,f,y,h,g,b,M,E,C;if("Link"===(null===r||void 0===r?void 0:r.data_type_name)||"URL"===(null===r||void 0===r?void 0:r.data_type_name))return null!==r&&void 0!==r&&null!==(_=r.value)&&void 0!==_&&_.includes("jpg")||null!==r&&void 0!==r&&null!==(f=r.value)&&void 0!==f&&f.includes("jpeg")||null!==r&&void 0!==r&&null!==(y=r.value)&&void 0!==y&&y.includes("png")?i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement("div",{className:ee},i.createElement("img",{alt:"lg",src:null===r||void 0===r?void 0:r.value,className:le}))):i.createElement("div",null,null===r||void 0===r?void 0:r.value);if("date"===r.data_type||null!==r&&void 0!==r&&null!==(t=r.options)&&void 0!==t&&t.country_code||null!==r&&void 0!==r&&null!==(n=r.options)&&void 0!==n&&n.currency_type||"Number"===r.data_type_name||"Clock"===r.data_type_name)return"bar"===(null===r||void 0===r||null===(h=r.options)||void 0===h?void 0:h.display)?i.createElement("div",{className:X,style:{paddingLeft:"0px",border:"none",height:"auto"}},i.createElement("div",{style:{height:"10px",width:"100%",backgroundColor:null===r||void 0===r||null===(g=r.options)||void 0===g?void 0:g.maxC,display:"flex",flexDirection:"row",border:"none"}},i.createElement("input",{defaultValue:"",className:X,name:r.field_name,style:{color:"transparent",border:"none",height:"10px",width:"".concat(+(null===r||void 0===r?void 0:r.value)/+r.options.max*100,"%"),backgroundColor:null!==r&&void 0!==r&&r.value?"0"===(null===r||void 0===r?void 0:r.value)?"transparent":null===r||void 0===r||null===(b=r.options)||void 0===b?void 0:b.barC:"transparent"}}))):i.createElement("div",{style:{backgroundColor:null!==r&&void 0!==r&&null!==(M=r.options)&&void 0!==M&&M.valueC?null===r||void 0===r||null===(E=r.options)||void 0===E?void 0:E.valueC:""}},"date"===(null===r||void 0===r?void 0:r.data_type)||"Clock"===(null===r||void 0===r?void 0:r.data_type_name)?O()(r.value).format(null!==r&&void 0!==r&&null!==(C=r.options)&&void 0!==C&&C.time?"DD MMMM YYYY HH:mm":"DD MMMM YYYY"):null===r||void 0===r?void 0:r.value);if("Item Formula"===(null===r||void 0===r?void 0:r.data_type_name)&&(null===r||void 0===r||null===(d=r.options)||void 0===d||null===(a=d.operator)||void 0===a?void 0:a.length)>0){var w,x;const e=(0,B.LV)(null===r||void 0===r?void 0:r.options,p.selected_fields.filter(e=>r.options.list.includes(e.field_name)&&e.options.mapToItem),[],[],m,!0);return i.createElement("div",{style:{backgroundColor:null!==r&&void 0!==r&&null!==(w=r.options)&&void 0!==w&&w.valueC?null===r||void 0===r||null===(x=r.options)||void 0===x?void 0:x.valueC:""}},e)}return i.createElement("div",{style:{backgroundColor:null!==r&&void 0!==r&&null!==(s=r.options)&&void 0!==s&&s.valueC?null===r||void 0===r||null===(u=r.options)||void 0===u?void 0:u.valueC:""}},null===r||void 0===r?void 0:r.value)},_={item_code:null,quantity:null,value:null,alt_value:null,total:null},f=Object.entries(Object.assign(_,null===r||void 0===r?void 0:r.options.map)).reduce((e,l)=>{let[o,t]=l;return null===t||(e[o]=t),e},{});let y=Object.entries(Object.assign(_,null===r||void 0===r?void 0:r.options.map)).reduce((e,l)=>{let[o,t]=l;return null===t||(e[o]=t),e},{});Object.keys(f).map(e=>{var l;"item_code"===e?y.item_code="Totals:":"quantity"===e?y[e]="".concat(P.Z((l,o)=>{var t;return null!==(t=+l+ +o[e])&&void 0!==t?t:0},0,null!==(l=null===v||void 0===v?void 0:v.component_items)&&void 0!==l?l:[])):("alt_value"===e||"value"===e||"total"===e)&&(y[e]="")});const h=null!==r&&void 0!==r&&null!==(l=r.options)&&void 0!==l&&l.group?null!==(o=null===p||void 0===p||null===(n=p.selected_fields)||void 0===n||null===(d=n.find(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.mapToItem)===(null===r||void 0===r||null===(o=r.options)||void 0===o?void 0:o.groupL)&&"Dropdown"===e.data_type_name}))||void 0===d||null===(a=d.options)||void 0===a?void 0:a.list)&&void 0!==o?o:[]:null!==r&&void 0!==r&&null!==(s=r.options)&&void 0!==s&&s.type?[null===r||void 0===r||null===(u=r.options)||void 0===u?void 0:u.type]:[void 0];return i.createElement("div",{style:{width:"100%",border:"1px dashed gray",borderRadius:"10px",padding:"16px",fontFamily:"var(--app-text-main-font)",margin:"20px 0",display:v.component_items.length>0?"":"none"}},i.createElement("p",{style:{fontSize:"20px",fontFamily:"var(--app-text-main-font)",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},r.field_name),null===h||void 0===h?void 0:h.map((e,l)=>{var o,n,d,a,s,u,c;const _=null===(o=w.Z([x.Z(S.Z("index"))])(null!==(n=null===v||void 0===v||null===(d=v.component_items)||void 0===d?void 0:d.filter(l=>{var o;return l[null===r||void 0===r||null===(o=r.options)||void 0===o?void 0:o.groupL]===e||l.type===e}))&&void 0!==n?n:[]))||void 0===o?void 0:o.map((e,l)=>{var o;e.index=l;let n={index:l};return null===p||void 0===p||null===(o=p.selected_fields)||void 0===o||o.filter(e=>{var l;return null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.mapToItem}).map(o=>{var d;const a=(0,B.sO)(e[o.options.mapToItem])?JSON.parse(null!==(d=e[o.options.mapToItem])&&void 0!==d?d:"{}")[o.field_name]:e[o.options.mapToItem];n[o.field_name]=i.createElement(m,{index:l,item:e,field:(0,t.Z)((0,t.Z)({},o),{},{visible:!0,value:null!==a&&void 0!==a?a:""})})}),n});return i.createElement(i.Fragment,null,_.length>0&&i.createElement(L.Z,{key:l,withColumns:0!==_.length,style:{width:"100%",marginBottom:"20px"},tableHostSimple:g.tq?oe:te.Z.itemsContainer_ii,layeredColumns:null===(a=w.Z([x.Z(S.Z("index"))])(null===p||void 0===p?void 0:p.selected_fields))||void 0===a?void 0:a.filter(e=>{var l;return null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.mapToItem}).map(e=>{var l,o;return null!==(l=e.options)&&void 0!==l&&l.group?{label:null===(o=e.options)||void 0===o?void 0:o.group,subColumns:[{label:e.field_name}]}:{label:e.field_name}}).slice(0,g.tq?3:8),list:_,footer:_.length>0&&null!==(s=r.options)&&void 0!==s&&s.footer?null===p||void 0===p||null===(u=p.selected_fields)||void 0===u?void 0:u.filter(e=>{var l;return null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.mapToItem}).map((e,l)=>{var o,t;return null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.footer?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return 0==(null===e||void 0===e?void 0:e.length)?0:e.reduce((e,t)=>{var i,n,d,a,s,u,r,v,c;if(null===t[null===l||void 0===l||null===(i=l.options)||void 0===i?void 0:i.mapToItem]||""===t[null===l||void 0===l||null===(n=l.options)||void 0===n?void 0:n.mapToItem])return e;const p=null!==(d=null!==o&&void 0!==o&&null!==(a=o.options)&&void 0!==a&&a.simple?JSON.parse(null!==(s=t[null===l||void 0===l||null===(u=l.options)||void 0===u?void 0:u.mapToItem])&&void 0!==s?s:"{}")[null===l||void 0===l?void 0:l.field_name]:t[null===l||void 0===l||null===(r=l.options)||void 0===r?void 0:r.mapToItem])&&void 0!==d?d:0;return"itemsum"===(null===l||void 0===l||null===(v=l.options)||void 0===v?void 0:v.footer)?e+ +(""===p?0:"".concat(p)):"itemdiff"===(null===l||void 0===l||null===(c=l.options)||void 0===c?void 0:c.footer)?e-+(""===p?0:"".concat(p)):0},0)}(null!==r&&void 0!==r&&null!==(t=r.options)&&void 0!==t&&t.type?null===v||void 0===v?void 0:v.component_items.filter(e=>{var l;return e.type===(null===r||void 0===r||null===(l=r.options)||void 0===l?void 0:l.type)}):null===v||void 0===v?void 0:v.component_items,e,r):0===l?"Totals:":""}):[]},(null===r||void 0===r||null===(c=r.options)||void 0===c?void 0:c.group)&&i.createElement("p",{style:{fontSize:"16px",fontFamily:"var(--app-text-main-font)",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},e)))}))};var re=o(51330);const ve=e=>{var l;const{component:o,isMandatoryError:t,nextButtonClicked:n,setIsMandatoryError:a}=e,[s]=(0,f.pQ)(),[u]=(0,i.useState)(""),r=(0,i.useRef)(null);(0,i.useEffect)(()=>{v()},[n]);const v=()=>{var e;null!==o&&void 0!==o&&null!==(e=o.selected_fields)&&void 0!==e&&e.some(e=>{var l;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.length)<1)})?a(!0):a(!1)},c=(e,l)=>{var o,t;0==l?s.newProduct={name:e,product_code:null===s||void 0===s||null===(o=s.newProduct)||void 0===o?void 0:o.product_code}:s.newProduct={product_code:e,name:null===s||void 0===s||null===(t=s.newProduct)||void 0===t?void 0:t.name}};return i.createElement("div",{id:"accordion",className:te.Z.section},i.createElement("div",{className:M()(te.Z.accordionContainer,!0),"app-variant-has-error":u?"error":""},i.createElement("div",{style:{display:"flex"}},i.createElement("p",{className:te.Z.title,style:{color:t&&n?"var(--app-color-error)":""}},"New Product Details")),i.createElement("div",{ref:r,style:{maxHeight:"",display:"flex",padding:"0px 0px 20px 0px"},className:te.Z.content},i.createElement(h.Z,{fieldIcon:d.MQ,fieldLabel:"Product Name",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},i.createElement("div",{className:te.Z.fieldRowContainer},i.createElement("input",{type:"text",onChange:e=>{c(e.target.value,0)},autoComplete:"none",className:te.Z.fieldTypeInput,name:"field.field_name"}))),i.createElement("div",{style:{width:"10px"}}),i.createElement(h.Z,{fieldIcon:d.MQ,fieldLabel:"Product Code",isProcess:!0,visible:!0,mandatory:!0,customIconBgColor:"white"},i.createElement("div",{className:te.Z.fieldRowContainer},i.createElement("input",{type:"text",onChange:e=>{c(e.target.value,1)},autoComplete:"none",className:te.Z.fieldTypeInput,name:"field.field_name"}))))),u&&(null===u||void 0===u||null===(l=u.errors)||void 0===l?void 0:l.title)&&i.createElement(E.Z,{message:u.errors.title}),u&&(null===u||void 0===u?void 0:u.message)&&i.createElement(E.Z,{message:u.message}))};var ce=o(41131),pe=o(40694),me=o(81330),_e=o.n(me),fe=o(63864);const ye={userCard:"GeneralCard_userCard__0SOp0",cls:"GeneralCard_cls__aX-Sn",userCardContainer:"GeneralCard_userCardContainer__wJA5U",userCardContainerTop:"GeneralCard_userCardContainerTop__UB7lh",userCardInnerContainer:"GeneralCard_userCardInnerContainer__XVh+2",avatarUrlImg:"GeneralCard_avatarUrlImg__qfa2g",userCardBottomContainer:"GeneralCard_userCardBottomContainer__0WoR6",fullName:"GeneralCard_fullName__QizQf",position:"GeneralCard_position__3X6Ea",email:"GeneralCard_email__U8cda"},he=e=>{const{cardClicked:l,title:o,subtitle:t,children:n,description:d,customClass:a=ye.userCard,customStyle:s}=e;return i.createElement("div",{className:a,onClick:l,style:s},i.createElement("div",{className:ye.userCardContainer},i.createElement("div",{className:ye.userCardBottomContainer},i.createElement("p",{className:ye.fullName},o),i.createElement("p",{className:ye.email},d),i.createElement("p",{className:ye.position},t),n)))};var ge=o(60761),be=o(29937),Me=o(4358),Ee=o(1542),Ce=o(49523),we=o(9204),xe=o(32086),Se=o(53431),ke=o(68218),Ze=o(84634),Ie=o(62169),De=o(88346),Ne=(o(67055),o(71901),o(95007)),Pe=o(87424),Te=o(27658),Oe=o(75105),qe=o(51481),Ue=o(41757),Ae=o(44408),Ye=o(23910),Be=o(46415);o(60940),o(56120),o(37704),o(72666),o(68623),o(3863),o(95361);e=o.hmd(e);var Le=o(456);const Re=(0,i.memo)(e=>{var l,o,d,a,u,v,c,p,_,f,h,b;const{step:M,isMandatoryError:E,nextButtonClicked:C,setIsMandatoryError:w,begunModule:x,companyData:S,components:k,isEditing:Z,companyUsersArray:I,setUsers:D,setPositions:N=()=>{},products:P,selectedComponent:q,goToNextStep:U,authenticatedUser:A,setIsCompleted:Y,companyPositionsArray:B,cart:L,blueprints:R,allModules:j,usersArray:F,editMode:W}=e,[z]=((0,y.WidthProvider)(y.Responsive),(0,i.useState)(null===(l=null===q||void 0===q?void 0:q.is_complete)||void 0===l||l));let V=[];const G=i.createElement(Be.mQ,{style:{width:"100%",marginTop:"50px",minHeight:"30vh"}},i.createElement(Be.td,null,null===M||void 0===M?void 0:M.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||A.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).map((e,l)=>{var o;return i.createElement(Be.OK,{key:l},i.createElement("div",{style:{padding:"10px 0",fontSize:"16px",fontWeight:"bold",fontFamily:"var(--app-text-main-font)",transform:"scaleY(1.1)",color:"var(--app-color-gray-dark)"}},null===e||void 0===e||null===(o=e.name)||void 0===o?void 0:o.toUpperCase()))})),(null===M||void 0===M||null===(o=M.component_blueprints)||void 0===o?void 0:o.length)>0?null===M||void 0===M?void 0:M.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||A.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).map((e,l)=>{const o=e.selected_fields.find(e=>"Template"===e.data_type_name&&1==e.visible),n=e.selected_fields.find(e=>"Video"===e.data_type_name&&1==e.visible);return o?i.createElement(Be.x4,{key:l},i.createElement(ce.ZP,{templateName:o.field_name,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,component:e,companyData:S,components:k,products:P,selectedComponent:q,component_blueprint:e,editMode:W,blueprints:R,allModules:j,authenticatedUser:A,companyUsersArray:I,companyPositionsArray:B,begunModule:x})):e.selected_fields.filter(e=>1==e.visible).length>0?i.createElement(Be.x4,{key:l,style:{margin:"30px 0 0 0"}},i.createElement(re.Z,{editMode:W,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,blueprints:R,component:e,companyData:S,components:k,allModules:j,products:P,authenticatedUser:A,selectedComponent:q,companyUsersArray:I,companyPositionsArray:B,begunModule:x}),(null===q||void 0===q?void 0:q.id)&&(null===n||void 0===n?void 0:n.value)&&O()(null===n||void 0===n?void 0:n.value)<=(0,T.now)()&&(0,T.now)()<O()(null===n||void 0===n?void 0:n.value).add("minutes",10)&&i.createElement(re.Z,{editMode:W,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,blueprints:R,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},n),{},{options:(0,t.Z)((0,t.Z)({},n.options),{},{start:!0})})]}),companyData:S,components:k,allModules:j,products:P,authenticatedUser:A,selectedComponent:q,companyUsersArray:I,companyPositionsArray:B,begunModule:x,shouldDisplay:!0,isEnabled:!0})):i.createElement(Be.x4,null)}):i.createElement(Be.x4,null)),X=(null===M||void 0===M||null===(d=M.component_blueprints)||void 0===d?void 0:d.length)>0?null===M||void 0===M?void 0:M.component_blueprints.map((e,l)=>{const o=e.selected_fields.find(e=>"Template"===e.data_type_name&&1==e.visible),n=e.selected_fields.find(e=>"Video"===e.data_type_name&&1==e.visible);return o?i.createElement("div",{key:l},i.createElement(ce.ZP,{templateName:o.field_name,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,component:e,companyData:S,components:k,products:P,selectedComponent:q,component_blueprint:e,editMode:W,blueprints:R,allModules:j,authenticatedUser:A,companyUsersArray:I,companyPositionsArray:B,begunModule:x})):e.selected_fields.filter(e=>1==e.visible).length>0?i.createElement("div",{key:l,style:{margin:"30px 0 0 0"}},i.createElement(re.Z,{editMode:W,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,blueprints:R,component:e,companyData:S,components:k,allModules:j,products:P,authenticatedUser:A,selectedComponent:q,companyUsersArray:I,companyPositionsArray:B,begunModule:x}),(null===q||void 0===q?void 0:q.id)&&(null===n||void 0===n?void 0:n.value)&&O()(null===n||void 0===n?void 0:n.value)<=(0,T.now)()&&(0,T.now)()<O()(null===n||void 0===n?void 0:n.value).add("minutes",10)&&i.createElement(re.Z,{editMode:W,nextButtonClicked:C,isMandatoryError:E,blueprintIndex:l,setIsMandatoryError:w,blueprints:R,component:(0,t.Z)((0,t.Z)({},e),{},{name:"Video Call",selected_fields:[(0,t.Z)((0,t.Z)({},n),{},{options:(0,t.Z)((0,t.Z)({},n.options),{},{start:!0})})]}),companyData:S,components:k,allModules:j,products:P,authenticatedUser:A,selectedComponent:q,companyUsersArray:I,companyPositionsArray:B,begunModule:x,shouldDisplay:!0,isEnabled:!0})):i.createElement(i.Fragment,null)}):i.createElement(i.Fragment,null),[J,H]=(0,i.useState)({currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:{lg:M.options.layout},editing:Z});return i.createElement("div",null,i.createElement(s.j3,{permissions:[s.po.processes.create]},i.createElement("button",{onClick:()=>{V=J.layouts.lg.map(e=>(0,t.Z)((0,t.Z)({},e),{},{static:!1})),H((0,t.Z)((0,t.Z)({},J),{},{layouts:{lg:V},editing:!J.editing}))},hidden:!J.editing},"Edit Layout"),i.createElement("button",{onClick:()=>{const e=V.map(e=>(0,t.Z)((0,t.Z)({},e),{},{static:!0}));(0,r.T5)({options:(0,t.Z)((0,t.Z)({},M.options),{},{layout:e})},M.id,!0).pipe((0,m.P)()).subscribe({next:l=>{H((0,t.Z)((0,t.Z)({},J),{},{layouts:{lg:e},editing:!J.editing}))},error:e=>{H((0,t.Z)((0,t.Z)({},J),{},{layouts:{lg:M.options.layout},editing:!J.editing}))}})},hidden:!J.editing},"Save Layout")),null!==M&&void 0!==M&&null!==(a=M.options)&&void 0!==a&&a.tabbed&&!g.tq||null!==M&&void 0!==M&&null!==(u=M.options)&&void 0!==u&&u.tabbed&&(null===M||void 0===M?void 0:M.component_blueprints.filter(e=>e.selected_fields.filter(l=>{var o,t;return 1==l.visible&&"Emails"!==l.data_type_name&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||A.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).length>0).length)<3?G:X,"product"===(null===(v=x.processModule.module)||void 0===v?void 0:v.options.outputTo)&&(null===M||void 0===M?void 0:M.is_end)&&i.createElement(ve,{nextButtonClicked:C,isMandatoryError:E,setIsMandatoryError:w,component:{}}),((null===q||void 0===q||null===(c=q.created_by)||void 0===c?void 0:c.id)===A.id||(null===(p=x.processModule)||void 0===p?void 0:p.user_id)===A.id)&&(null===(_=x.processModule.module)||void 0===_?void 0:_.options.forSpecificUsers)&&(null===M||void 0===M?void 0:M.is_end)&&i.createElement("div",{style:{border:"1px dashed var(--app-color-gray-lighter)",marginTop:"100px",borderRadius:"8px 8px 0 0"}},i.createElement("p",{className:n.title},"Shares"),(()=>{var e;return i.createElement(s.jL,{ungrouped:!0,ttitle:"Select users to share this item:",columned:!0,withAckButton:!1},i.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select users to share this item:"),i.createElement(Me.Cm,{style:{width:"50%"},id:"Users",tagEmplacement:"inlined",searchable:!1,items:F,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_users)||void 0===e?void 0:e.map(e=>F.find(l=>l.value===e.id)),className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?(D(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.value)),null!==q&&void 0!==q&&q.id&&(q.shared_users=null===e||void 0===e?void 0:e.map(e=>({id:null===e||void 0===e?void 0:e.value})))):D([])}}))})(),(()=>{var e;return i.createElement(s.jL,{ungrouped:!0,columned:!0,withAckButton:!1},i.createElement("p",{style:{fontFamily:"var(--app-text-main-font)",fontSize:"16px",fontWeight:"bold",color:"var(--app-color-gray-dark)"}},"Select positions to share this item:"),i.createElement(Me.Cm,{style:{width:"50%"},id:"Positions",tagEmplacement:"inlined",searchable:!1,items:B,groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:null===q||void 0===q||null===(e=q.shared_positions)||void 0===e?void 0:e.map(e=>B.find(l=>l.value===e.id)),className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?(N(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.value)),null!==q&&void 0!==q&&q.id&&(q.shared_positions=null===e||void 0===e?void 0:e.map(e=>({id:null===e||void 0===e?void 0:e.value})))):N([])}}))})()),(null===(f=x.processModule.module)||void 0===f?void 0:f.options.forSpecificUsers)&&(null===M||void 0===M?void 0:M.is_end)&&i.createElement("div",{style:{height:"200px"}}),(null===M||void 0===M?void 0:M.is_end)&&(void 0===(null===q||void 0===q?void 0:q.is_complete)||0==(null===q||void 0===q?void 0:q.is_complete))&&(()=>{var e,l,o;return i.createElement("div",{className:n.emptyElementsSection,style:{width:"260px",padding:"0px 0px 0px 20px"}},i.createElement(s.pd,{id:"draft",title:"Save as draft?",ungrouped:!0,withAckButton:!1,style:{margin:"20px 2.5% 10px 5px",width:"auto",display:null!==x&&void 0!==x&&null!==(e=x.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.nosave?"none":""},value:!z,toggleSelected:e=>{var l,o,t;(Y(!e),null!==q&&void 0!==q&&q.id)&&(q.status=e?"Draft":null!==x&&void 0!==x&&null!==(l=x.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(t=o.options)&&void 0!==t&&t.lock?"New":"None")}}))})(),(null===M||void 0===M||null===(h=M.pathway_steps)||void 0===h?void 0:h.length)>0&&(()=>{const e=M.pathway_steps.map(e=>({label:"".concat(e.name),value:e.id})),l=I.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}));return i.createElement("div",{className:n.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(l.length*l.length>4?70:200,"px")}},i.createElement(fe.Z,{visible:!0,mandatory:!1,items:e,onChange:e=>{U(e)},placeholder:"Continue to this step..."}))})(),(null===M||void 0===M||null===(b=M.pathway_processes)||void 0===b?void 0:b.length)>0&&(()=>{const e=M.pathway_processes.map(e=>({label:"".concat(e.name),value:e.id})),l=I.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id}));return i.createElement("div",{className:n.emptyElementsSection,style:{width:"60%",padding:"20px 20px 20px 20px",height:"".concat(l.length*l.length>4?70:200,"px")}},i.createElement(fe.Z,{visible:!0,mandatory:!1,items:e,onChange:()=>{},placeholder:"Continue to this process..."}))})(),e.children)}),je=e=>{var l,o,t,d,a,s;const{selectedComponent:u,companyPositionsArray:r,companyUsersArray:v}=e;return i.createElement("div",{style:{width:"100%"}},((null===u||void 0===u||null===(l=u.shared_users)||void 0===l?void 0:l.length)>0||(null===u||void 0===u||null===(o=u.shared_positions)||void 0===o?void 0:o.length)>0)&&i.createElement("div",{className:n.accordionContainer},i.createElement("p",{className:n.cardTitle},"Shares"),i.createElement("div",{style:{display:"flex"}},i.createElement(h.D,{width:g.tq?"100%":"45%",fieldLabel:"Positions",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===u||void 0===u||null===(t=u.shared_positions)||void 0===t?void 0:t.length)>0&&i.createElement(C.default,{withColumns:!1,className:n.sharesTable,columns:["Position"],list:null===u||void 0===u||null===(d=u.shared_positions)||void 0===d?void 0:d.map(e=>{const l=null===r||void 0===r?void 0:r.find(l=>l.value===e.id);return{Position:null===l||void 0===l?void 0:l.label}})})),i.createElement(h.D,{width:g.tq?"100%":"45%",fieldLabel:"Users",style:{border:"0"},visible:!0,mandatory:!1,customIconBgColor:"white",enabled:!1},(null===u||void 0===u||null===(a=u.shared_users)||void 0===a?void 0:a.length)>0&&i.createElement(C.default,{withColumns:!1,className:n.sharesTable,columns:["User"],list:null===u||void 0===u||null===(s=u.shared_users)||void 0===s?void 0:s.map(e=>{const l=null===v||void 0===v?void 0:v.find(l=>l.id===e.id);return{User:"".concat(null===l||void 0===l?void 0:l.first_name," ").concat(null===l||void 0===l?void 0:l.last_name)}})})))))},Fe=i.forwardRef((e,l)=>{var o,d,a,s,u,r;const{begunModule:v,allModules:c,companyData:p,selectedComponent:m,setSelectedComponent:_,companyUsersArray:f,companyPositionsArray:y,print:h,components:b=[],bypassCustom:M=!1,authenticatedUser:E,setIsOpen:C=()=>{}}=e,[w,x]=(0,i.useState)([]),S=null===v||void 0===v||null===(o=v.processModule)||void 0===o||null===(d=o.steps)||void 0===d||null===(a=d.find(e=>e.component_blueprints.filter(e=>{var l;return null===(l=e.selected_fields)||void 0===l?void 0:l.find(e=>"Template"===e.data_type_name)}).length>0))||void 0===a||null===(s=a.component_blueprints)||void 0===s||null===(u=s.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Template"===e.data_type_name&&!0===e.visible).length)>0}))||void 0===u||null===(r=u.selected_fields)||void 0===r?void 0:r.find(e=>"Template"===e.data_type_name),k=()=>{var e,l,o,n;const d=null===v||void 0===v||null===(e=v.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.find(e=>e.component_blueprints.filter(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name))}).length>0),a=null===d||void 0===d||null===(o=d.component_blueprints)||void 0===o?void 0:o.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Transaction List"===e.data_type_name&&!0===e.visible).length)>0});return i.createElement(ce.ij,{selectedComponent:m,templateName:null===S||void 0===S?void 0:S.field_name,component_blueprint:a,template:S,companyUsersArray:f,begunModule:v,companyData:p,authenticatedUser:E},a&&i.createElement(ue,{key:0,field:null===(n=a.selected_fields)||void 0===n?void 0:n.find(e=>"Transaction List"===e.data_type_name),selectedComponent:m,companyUsersArray:f,component:(0,t.Z)((0,t.Z)({},a),{},{created_date:m.created_date,values:[]})}))};return(0,i.useEffect)(()=>{var o,d,a;let s=[];if(ke.Z(Ze.Z("group"))(null!==(o=null===m||void 0===m?void 0:m.component_fields)&&void 0!==o?o:[]).map(e=>{s=[...s,{id:e.component_blueprint_id,selected_fields:De.Z(I.Z("group",e.group))(m.component_fields)}]}),(null===v||void 0===v||null===(d=v.processModule)||void 0===d||null===(a=d.completeSteps)||void 0===a?void 0:a.length)>0){var u,r,w,S;let o=[i.createElement("div",{key:0,style:{display:null!==e&&void 0!==e&&e.noHeader?"none":"",height:"auto",padding:"20px"}},h&&(null!==p&&void 0!==p&&p.logo?i.createElement("img",{className:n.imageLogoPrint,alt:"lg",onError:e=>e.target.src="https://i.quotev.com/b2gtjqawaaaa.jpg",src:null!==(u=null===p||void 0===p?void 0:p.logo)&&void 0!==u?u:"https://i.quotev.com/b2gtjqawaaaa.jpg"}):i.createElement("div",{style:{padding:"20px"}},(0,B.lh)("30px","var(--app-color-gray-dark)","bold"),i.createElement("div",{style:{fontSize:"12px",fontWeight:"normal",fontFamily:"var(--app-text-main-font)"}},null===p||void 0===p||null===(r=p.display_name)||void 0===r?void 0:r.toUpperCase())))),k()];var Z,D,N,P,T,O,q,U,A,Y,L,R,j;if(v.processModule.completeSteps.map(e=>{e.component_blueprints.filter(e=>{var l,o;return 0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asModuleList)||void 0==(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.asModuleList)}).map((l,n)=>{var d,a,u;const r=null!==(d=null===m||void 0===m||null===(a=m.component_fields)||void 0===a?void 0:a.filter(e=>e.component_blueprint_id===l.id))&&void 0!==d?d:[];null===r||void 0===r||r.find(e=>!(""===e.value||void 0===e.value||null===e.value));var _,y,h;(null===r||void 0===r?void 0:r.length)>0&&(null===(u=l.selected_fields)||void 0===u?void 0:u.filter(e=>1==e.visible).length)>0&&(o=null!==l.options?[...o,i.createElement("div",{key:o.length,style:{display:""}},i.createElement(de,{setIsOpen:C,step:e,isInherited:!1,nextButtonClicked:()=>{},isMandatoryError:!1,stepId:e.id,blueprintIndex:n,setIsMandatoryError:()=>{},component:(0,t.Z)((0,t.Z)({},l),{},{created_date:m.created_date,values:null!==(_=null===(y=s.find(e=>e.id===l.id))||void 0===y?void 0:y.selected_fields)&&void 0!==_?_:[]}),begunModule:v,allModules:c,companyData:p,components:s,allComponents:b,companyUsersArray:f,selectedComponent:m}))]:[...o,i.createElement("div",{key:o.length},i.createElement(de,{setIsOpen:C,step:e,isInherited:!1,nextButtonClicked:()=>{},isMandatoryError:!1,stepId:e.id,blueprintIndex:n,setIsMandatoryError:()=>{},component:(0,t.Z)((0,t.Z)({},l),{},{created_date:m.created_date,values:null===(h=s.find(e=>e.id===l.id))||void 0===h?void 0:h.selected_fields}),begunModule:v,allModules:c,companyData:p,components:s,allComponents:b,companyUsersArray:f,selectedComponent:m}))])})}),null!==v&&void 0!==v&&null!==(w=v.processModule)&&void 0!==w&&null!==(S=w.completeSteps)&&void 0!==S&&S.find(e=>{var l;return(null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>"Template"===e.data_type_name).length>0).length)>0&&0==M}))x(i.createElement(ce.C6,{ref:l,print:h,begunModule:v,allModules:c,companyData:p,components:b,selectedComponent:m,setSelectedComponent:_,companyUsersArray:f,companyPositionsArray:y,payments:i.createElement(se,{component:m}),creator:i.createElement(ae,{component:m,show:null===v||void 0===v||null===(Z=v.processModule)||void 0===Z||null===(D=Z.module)||void 0===D||null===(N=D.options)||void 0===N?void 0:N.anonymous,process:null===v||void 0===v?void 0:v.processModule}),shares:(null===v||void 0===v||null===(P=v.processModule)||void 0===P||null===(T=P.module)||void 0===T||null===(O=T.options)||void 0===O?void 0:O.forSpecificUsers)&&i.createElement(je,{key:o.length+3,selectedComponent:m,companyUsersArray:f,companyPositionsArray:y})},o));else x([i.createElement("div",{style:{display:g.tq?"none":"flex",width:"100%",alignContent:"space-between"}},i.createElement("div",{className:n.cardTitle,style:{fontSize:"18px",padding:"10px 0",width:"100%"}},m.status&&"None"!==m.status&&i.createElement(i.Fragment,null,i.createElement("span",{style:{fontWeight:"normal",fontSize:"16px"}},"Status : ")," ",m.status)),",",i.createElement("label",{className:n.checkboxLabelClass},"Show all fields",i.createElement("input",{type:"checkbox",defaultChecked:null===m||void 0===m?void 0:m.show,onChange:e=>{_((0,t.Z)((0,t.Z)({},m),{},{show:e.target.checked}))}}))),...o,i.createElement(se,{component:m,key:o.length+1}),(null===v||void 0===v||null===(q=v.processModule)||void 0===q||null===(U=q.module)||void 0===U||null===(A=U.options)||void 0===A?void 0:A.forSpecificUsers)&&(null===E||void 0===E?void 0:E.id)===(null===(Y=m.created_by)||void 0===Y?void 0:Y.id)&&i.createElement(je,{key:o.length+2,selectedComponent:m,companyUsersArray:f,companyPositionsArray:y}),i.createElement(ae,{component:m,key:o.length+3,show:null===v||void 0===v||null===(L=v.processModule)||void 0===L||null===(R=L.module)||void 0===R||null===(j=R.options)||void 0===j?void 0:j.anonymous,process:null===v||void 0===v?void 0:v.processModule})])}},[m,h]),i.createElement("div",{ref:l,style:{padding:h?"50px 0px 50px 0px":"20px",alignSelf:"center",backgroundColor:"white",margin:"auto",width:g.tq?"100%":(0,ce.ev)(null===S||void 0===S?void 0:S.field_name)}},w,e.children)}),We=(0,a.$j)(e=>{const{begunModule:l,allModules:o,companyData:t,components:i,rememberPath:n,lastUpdates:d,companyUsersArray:a,products:s,transactions:u,companyProcesses:r,companyPositionsArray:v,cart:c,blueprints:p,allTasks:m,axiosAbort:_}=e.flowReducer,{authenticatedUser:f}=e.authReducer;return{begunModule:l,allModules:o,companyData:t,components:i,rememberPath:n,lastUpdates:d,companyUsersArray:a,products:s,transactions:u,companyProcesses:r,authenticatedUser:f,companyPositionsArray:v,cart:c,blueprints:p,allTasks:m,axiosAbort:_}},e=>({onSetSelectedProcess:l=>e((0,p.Xu)(l))}))(function(l){var o,a,y,h,b,M,Z,P,q,U,L,R,j,F,W,z,V,G,X,J,H,Q,K,$,ee,le,oe,te,ne,de,ae,se,ue,re,ve,me,ye,Be,je,We,ze,Ve,Ge,Xe,Je,He,Qe,Ke,$e,el,ll,ol,tl,il,nl,dl,al,sl,ul,rl,vl,cl,pl,ml,_l,fl,yl,hl,gl,bl,Ml,El,Cl,wl,xl,Sl,kl,Zl,Il,Dl,Nl,Pl,Tl,Ol,ql,Ul,Al,Yl,Bl,Ll,Rl,jl,Fl,Wl,zl,Vl,Gl,Xl,Jl,Hl,Ql,Kl,$l,eo,lo,oo,to,io,no,ao,so,uo,ro,vo,co,po,mo;const{navigateTo:_o,begunModule:fo,allModules:yo,companyData:ho,components:go,isEditing:bo,lastUpdates:Mo,companyUsersArray:Eo,products:Co,onSetSelectedProcess:wo,children:xo,authenticatedUser:So,companyPositionsArray:ko,cart:Zo,blueprints:Io,paymentID:Do,companyProcesses:No,allTasks:Po,axiosAbort:To}=l,[Oo]=(0,i.useState)(1),[qo,Uo]=(0,i.useState)(!1),[Ao,Yo]=(0,i.useState)(!1),[Bo,Lo]=(0,i.useState)(""),[Ro,jo]=(0,i.useState)(!1),[Fo,Wo]=(0,f.pQ)(),[zo,Vo]=(0,i.useState)(!1),[Go,Xo]=(0,i.useState)(1==(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o?void 0:o.isUpdating)),[Jo,Ho]=(0,i.useState)(null!==(a=null===fo||void 0===fo||null===(y=fo.processModule)||void 0===y?void 0:y.selectedComponent)&&void 0!==a?a:{}),[Qo,Ko]=(0,i.useState)(null===(h=null===Jo||void 0===Jo?void 0:Jo.is_complete)||void 0===h||h),[$o,et]=(0,i.useState)([]),[lt,ot]=(0,i.useState)([]),[tt,it]=(0,i.useState)(!1),[nt,dt]=(0,i.useState)(!1),[at,st]=(0,i.useState)(!1),[ut,rt]=(0,i.useState)(!1),[vt,ct]=(0,i.useState)(!1),[pt,mt]=(0,i.useState)(!1),[_t,ft]=(0,i.useState)(!1),[yt,ht]=(0,i.useState)(!1),[gt,bt]=(0,i.useState)(!1),[Mt,Et]=(0,i.useState)(!1),[Ct,wt]=(0,i.useState)([]),[xt,St]=(0,i.useState)([]),[kt,Zt]=(0,i.useState)([]),[It,Dt]=(0,i.useState)({list:[],operator:"AND"}),[Nt,Pt]=(0,i.useState)([]),[Tt,Ot]=(0,i.useState)([]),[qt,Ut]=(0,i.useState)(!1),[At,Yt]=(0,i.useState)(!1),[Bt,Lt]=(0,i.useState)(!1),[Rt,jt]=(0,i.useState)(!1),[Ft,Wt]=(0,i.useState)("false"!==localStorage.getItem("showAds")&&(null!==(b=O()(+localStorage.getItem("showAdsDate")).format("DD MMM YYYY")!==O()((0,T.now)()).format("DD MMM YYYY"))&&void 0!==b&&b)),[zt,Vt]=(0,i.useState)(1),Gt=(0,ie.s0)(),Xt=(null===fo||void 0===fo||null===(M=fo.processModule)||void 0===M||null===(Z=M.steps)||void 0===Z?void 0:Z.length)>0?null===fo||void 0===fo||null===(P=fo.processModule)||void 0===P?void 0:P.steps[fo.processModule.stepIndex]:{},Jt=(null===fo||void 0===fo||null===(q=fo.processModule)||void 0===q||null===(U=q.steps)||void 0===U?void 0:U.length)>0?null===(L=fo.processModule.steps[fo.processModule.stepIndex])||void 0===L?void 0:L.pathway_steps:[],Ht=(null===fo||void 0===fo||null===(R=fo.processModule)||void 0===R||null===(j=R.steps)||void 0===j?void 0:j.length)>0?null===(F=fo.processModule.steps[fo.processModule.stepIndex])||void 0===F?void 0:F.pathway_processes:[];let Qt=(0,i.useRef)();(0,i.useEffect)(()=>{let e=Eo.filter(e=>0==e.departments.length).map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id,department:"General",user:e}));Eo.filter(e=>e.departments.length>0).filter(l=>{l.departments.filter(o=>{e=[...e,{label:"".concat(l.first_name," ").concat(l.last_name),value:l.id,department:null===o||void 0===o?void 0:o.name,user:l}]})}),Pt(e)},[Eo]),(0,i.useEffect)(()=>{var e,l;if((null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&!Mt){var o,t;Dt({list:[],operator:"AND"}),void 0!==(null===_o||void 0===_o?void 0:_o.key)?wt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,go,_o.value,_o.key)):wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}));let e={id:""},l=[],i=[];const n=o=>{o.component_fields.map(t=>{var n,d;o.procedure_id!==(null===Le||void 0===Le?void 0:Le.id)&&(e=No.find(e=>e.id===o.procedure_id),null!==(n=e)&&void 0!==n&&n.steps&&(l=Ce.Z(N.Z("component_blueprints"),D.Z)(null===(d=e)||void 0===d?void 0:d.steps),i=Ce.Z(N.Z("selected_fields"),D.Z)(l)));const a=i.find(e=>e.procedure_step_blueprint_field_id===t.procedure_step_blueprint_field_id);var s;a&&(t.data_type_name=a.data_type_name,t.data_type=a.data_type,t.field_name=a.field_name,t.options=a.options,t.component_blueprint_id=null===(s=l.find(e=>e.selected_fields.filter(e=>e.procedure_step_blueprint_field_id===t.procedure_step_blueprint_field_id).length>0))||void 0===s?void 0:s.id)})};we.Z(n,go.filter(e=>{var l;return(null!==(l=null===e||void 0===e?void 0:e.component_fields)&&void 0!==l?l:[]).filter(e=>void 0===(null===e||void 0===e?void 0:e.field_name)).length>0}))}},[null===fo||void 0===fo||null===(W=fo.processModule)||void 0===W?void 0:W.steps,go]),(0,i.useEffect)(()=>{if(Do){var e;const a=JSON.parse(localStorage.getItem("forPayment")),s=null===(e=a.component_fields)||void 0===e?void 0:e.find(e=>"Payments"===e.data_type_name);var l;if(s)if(2===(null===(l=a.component_fields)||void 0===l?void 0:l.filter(e=>e.field_name===s.options.paymentField||e.value===Do).length)){var o,t,i,n,d;const e=null===(o=a.component_fields)||void 0===o?void 0:o.find(e=>e.field_name===s.options.paymentField);dt(!0),(0,Te.e_)({user_id:So.id,id:a.id,total:null!==(t=+(null===e||void 0===e?void 0:e.value))&&void 0!==t?t:0,product:"CR-".concat(null!==(i=null===a||void 0===a?void 0:a.title)&&void 0!==i?i:null===fo||void 0===fo||null===(n=fo.processModule)||void 0===n||null===(d=n.module)||void 0===d?void 0:d.name," ").concat(Do),notes:"E-Payment",quantity:1}).pipe((0,m.P)()).subscribe({next:e=>{dt(!1),bt(!0),(0,u.tE)(null===a||void 0===a?void 0:a.id,"Paid").pipe((0,m.P)()).subscribe({next:e=>{localStorage.removeItem("forPayment"),fo.processModule.selectedComponent=e,Ho(e)}})}})}else dt(!1),c.h.dispatch((0,p.Xc)({show:!0,message:"Payment #".concat(Do," was received but transaction was not matched, please report this to your administrator"),color:"red",bottom:!0}))}},[Do]),(0,i.useEffect)(()=>{var e,l,o,t;(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&!Mt&&(void 0!==_o.key||""!==_o.key)&&wt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,go,_o.value))},[_o]),(0,i.useEffect)(()=>{var e,l,o,t,i;null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.selectedComponent)&&void 0!==l&&l.id&&Jo.id!==(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.selectedComponent)||void 0===t?void 0:t.id)&&Ho(null===fo||void 0===fo||null===(i=fo.processModule)||void 0===i?void 0:i.selectedComponent)},[null===fo||void 0===fo||null===(z=fo.processModule)||void 0===z?void 0:z.selectedComponent]),(0,i.useEffect)(()=>{localStorage.getItem("transaction")&&!zo&&localStorage.getItem("transaction")===Jo.id&&Lt(!0)},[Jo,zo]);const Kt=(0,i.useCallback)(()=>{let e=!1;return Xt.component_blueprints.filter(e=>{var l,o;return null===e.options||(!1===(null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)||void 0===(null===(o=e.options)||void 0===o?void 0:o.allowMultipleInputs))}).some(e=>{var l;return!0===(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Summary"!==e.data_type_name&&"Profile"!==e.data_type_name&&"ID"!==e.data_type_name&&"Info"!==e.data_type_name&&"Notes"!==e.data_type_name&&"URL"!==e.data_type_name&&"Emails"!==e.data_type_name&&"Template"!==e.data_type_name&&"Global"!==e.data_type_name&&"Chart"!==e.data_type_name&&"Value"!==e.data_type_name).some(e=>{var l;return!0===e.mandatory&&!0===e.visible&&(!e.value||(null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.length)<1)}))})&&(console.log("with manadatory errors",Xt.component_blueprints),e=!0),!0===e?(Yo(!0),!0):(Lo(""),Yo(!1),!1)},[Xt]),$t=e=>{jo(!0),Kt()&&!1===Go?ni():li(e)},ei=e=>{Fo.components=[],Fo.items=[],Fo.currentStep={},Fo.newStepComponents=[],fo.processModule.steps.filter(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>e.value=void 0))),fo.processModule.isUpdating=!1,c.h.dispatch((0,p.wM)({routes:{},pins:""})),Xo(!1),Vo(!1),jo(!0),li(e),ho.start=!1,(0,v.aK)().pipe((0,m.P)()).subscribe({next:()=>{}})},li=function(e){jo(!1),Yo(!1),Uo(!1);let l={};if(void 0===e){if(l=fo.processModule.steps[fo.processModule.stepIndex+1],void 0===l)return void c.h.dispatch((0,p.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));Wo({action:f._U.setCurrentStep,value:l}),c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:fo.processModule.stepIndex+1})))}else{if(l=fo.processModule.steps.find(l=>l.id===e),void 0==l)l=fo.processModule.steps[fo.processModule.stepIndex+1],c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:fo.processModule.stepIndex+1})));else{var o;if(void 0===fo.processModule.steps[(null===(o=l)||void 0===o?void 0:o.rank)-1])return void c.h.dispatch((0,p.Xc)({show:!0,message:"Misconfigured next step, please contact your administrator",color:"red",bottom:!0}));var i;c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{stepIndex:(null===(i=l)||void 0===i?void 0:i.rank)-1})))}Wo({action:f._U.setCurrentStep,value:l})}const n=Fo.newStepComponents.filter(e=>null===e.options||(void 0===e.allowMultipleInputs||!1===e.options.allowMultipleInputs));Wo({action:f._U.setComponents,value:[...Fo.components.filter(e=>n.every(l=>l.id!==e.id)),...xe.Z(e=>e.selected_fields.filter(e=>""===e.value).length>0,n)]}),Wo({action:f._U.setModuleNewStepComponents,value:l.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Status"===e.data_type_name||"ID"===e.data_type_name||"Value"===e.data_type_name).length>0)})},oi=()=>{Wo({action:f._U.setModuleItems,value:[]}),Wo({action:f._U.setComponents,value:[]}),Wo({action:f._U.addModuleComponents,value:[]}),Wo({action:f._U.setModuleNewStepComponents,value:[]}),ei(fo.processModule.steps[0].id)},ti=()=>{var e,l,o,i,n,d,a,s,r,v,_,f,y,h,g,b,M,E,C;if(Kt())return Lo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),void Uo(!1);const w=Fo.newStepComponents,x=[...Fo.components.filter(e=>w.every(l=>l.id!==e.id)),...xe.Z(e=>{var l;return e.selected_fields.filter(e=>""===e.value||null===e.value||!(null!==e&&void 0!==e&&e.value)).length===(null===(l=e.selected_fields)||void 0===l?void 0:l.length)},w)];let S,k,Z=[],I=[],D="",P="",T=!1,q=Go?null===Jo||void 0===Jo?void 0:Jo.status:null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.lock?"New":"None",U=[];const A=null===Jo||void 0===Jo?void 0:Jo.status,Y={};let L=Go?(null!==(i=Se.Z(Math.max,N.Z("group",ke.Z(Ze.Z("group"))(null!==(n=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==n?n:[]))))&&void 0!==i?i:-1)+1:0;x.map((e,l)=>{var o,i;let n=l;const d=null===(o=e.selected_fields.filter(e=>"Record"===e.data_type_name||"Filters"===e.data_type_name))||void 0===o?void 0:o.find(e=>+(null===e||void 0===e?void 0:e.group)>=0);d&&Go?n=d.group:Go&&(n=L,L++),e.selected_fields.filter(e=>("Record"===e.data_type_name||"Filters"===e.data_type_name)&&!0===e.visible).map((e,l)=>{var o;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){var i,d;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})],D=e.value,Y[e.field_name]=e.value;const o=null===(i=go.find(l=>l.component_fields.filter(l=>{var o;return l.component_blueprint_id===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.component_id)&&(null===l||void 0===l?void 0:l.value)===D}).length>0))||void 0===i||null===(d=i.component_fields.find(e=>"Email Recipient"===e.data_type_name))||void 0===d?void 0:d.value;o&&(S=o)}});const a=null===(i=e.selected_fields.filter(e=>!("Record"===e.data_type_name||"Filters"===e.data_type_name)))||void 0===i?void 0:i.find(e=>+(null===e||void 0===e?void 0:e.group)>=0);a&&Go?n=a.group:Go&&(n=L,L++),e.selected_fields.filter(e=>!("Record"===e.data_type_name||"Filters"===e.data_type_name||"Module"===e.data_type_name)).map((e,l)=>{var o,i,d,a;if(null!==e.value&&void 0!==e.value&&1!=(null===(o=e.options)||void 0===o?void 0:o.skip)){if(Y[e.field_name]=e.value,"ID"===(null===e||void 0===e?void 0:e.data_type_name))null!==fo&&void 0!==fo&&null!==(d=fo.processModule)&&void 0!==d&&d.isUpdating?I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})]:(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n,value:"".concat(null===e||void 0===e?void 0:e.options.id).concat(null===(null===ho||void 0===ho?void 0:ho.misc_info)?1:null!==(a=null===ho||void 0===ho?void 0:ho.misc_info[null===e||void 0===e?void 0:e.field_name])&&void 0!==a?a:1)})],Z=[...Z,"".concat(e.field_name)]);else if("Value"===(null===e||void 0===e?void 0:e.data_type_name)){var s;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e||null===(s=e.options)||void 0===s?void 0:s.value,group:n})]}else if("Email Recipient"===(null===e||void 0===e?void 0:e.data_type_name))I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:e.value.replace(/ /g,""),group:n})];else if("Product Lookup"===e.data_type_name)I=[...I];else if("Status"===e.data_type_name&&"Draft"===e.value&&1==Qo)T=!0,I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"New",group:n})],q="New";else if("Status"===e.data_type_name)I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e?void 0:e.value,group:n})],q=null===e||void 0===e?void 0:e.value;else if("Positions"===e.data_type_name&&!0===(null===e||void 0===e||null===(i=e.options)||void 0===i?void 0:i.share))I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:null===e||void 0===e?void 0:e.value,group:n})],U=[null===e||void 0===e?void 0:e.value];else if("Formula"===e.data_type_name){var u;const o=null!==fo&&void 0!==fo&&null!==(u=fo.processModule)&&void 0!==u&&u.isUpdating?(0,B.LV)(null===e||void 0===e?void 0:e.options,Jo.component_fields.filter(l=>{var o;return null===(o=e.options)||void 0===o?void 0:o.list.includes(l.field_name)}),x,Fo.items):e.value;I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:o.toString(),group:n})]}else if("output"!==e.data_type){var r,v,c,p;if("People"===e.data_type_name){var m,_,f,y,h;if(!0===(null===(m=e.options)||void 0===m?void 0:m.email)){var g,b;const l=null===(g=Nt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===g||null===(b=g.user)||void 0===b?void 0:b.email;P=l?P.concat(P.length>0?",".concat(l):l):P,e.email=void 0}if(!0===(null===(_=e.options)||void 0===_?void 0:_.assign))k=null===(y=Nt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===y||null===(h=y.user)||void 0===h?void 0:h.id,Go&&(Jo.assigned_to={id:k});if(!0===(null===(f=e.options)||void 0===f?void 0:f.share)){var M,E;const l=null===(M=Nt.find(l=>l.label===(null===e||void 0===e?void 0:e.value)))||void 0===M||null===(E=M.user)||void 0===E?void 0:E.id;l&&($o.push(l),Go&&Jo.shared_users.push({id:l}))}}"email"===(null===e||void 0===e||null===(r=e.options)||void 0===r?void 0:r.actionToPerform2)&&null!==e&&void 0!==e&&null!==(v=e.options)&&void 0!==v&&null!==(c=v.valueToMatch2)&&void 0!==c&&null!==(p=c.split(","))&&void 0!==p&&p.includes(null===e||void 0===e?void 0:e.value)&&S&&(T=!0,P=P.concat(P.length>0?",".concat(S):S)),I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,group:n})]}}else if("Status"===(null===e||void 0===e?void 0:e.data_type_name))1==Qo?(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"New",group:n})],q="New"):(I=[...I,(0,t.Z)((0,t.Z)({},e),{},{index:l,value:"Draft",group:n})],q="Draft"),Y[e.field_name]=e.value;else if("Action Button"===(null===e||void 0===e?void 0:e.data_type_name)){var C,w,D;I=[...I],Y[e.field_name]=e.value,"status"===(null===e||void 0===e||null===(C=e.options)||void 0===C?void 0:C.action)?q=e.value:"user"!==(null===(w=e.options)||void 0===w?void 0:w.action)&&"creator"!==(null===(D=e.options)||void 0===D?void 0:D.action)||(Jo.assigned_to=null===e||void 0===e?void 0:e.value)}})});let R,j,F,W="";if((null===(d=fo.processModule)||void 0===d||null===(a=d.module)||void 0===a||null===(s=a.options)||void 0===s||null===(r=s.title)||void 0===r?void 0:r.length)>0){var z,V,G,X,J,H,Q,K,$,ee,le,oe,te,ie,ne;if(null===(z=fo.processModule)||void 0===z||null===(V=z.module)||void 0===V||null===(G=V.options)||void 0===G||null===(X=G.title)||void 0===X||X.map(e=>{if("Info"!==e){const n=I.find(l=>l.field_name===e);var l,o,t,i;if("Date"===(null===n||void 0===n?void 0:n.data_type_name)||"Calendar"===(null===n||void 0===n?void 0:n.data_type_name))W=""===W?"".concat(O()(null===n||void 0===n?void 0:n.value).format("DD MMMM YYYY")):"".concat(null!==(l=W)&&void 0!==l?l:"","  ").concat(O()(null===n||void 0===n?void 0:n.value).format("DD MMMM YYYY"));else W=""===W?"".concat(null!==(o=null===n||void 0===n?void 0:n.value)&&void 0!==o?o:""):"".concat(null!==(t=W)&&void 0!==t?t:"","  ").concat(null!==(i=null===n||void 0===n?void 0:n.value)&&void 0!==i?i:"")}else{const e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});if(void 0!==e){var n,d;const l=null===(n=e.component_blueprints)||void 0===n||null===(d=n.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===d?void 0:d.find(e=>"Info"===e.data_type_name),o=go.find(e=>{var o;return(null===(o=e.component_fields.filter(e=>{var o;return e.component_blueprint_id===l.options.component_id&&(e.value===Y[l.field_name]||e.value===Y[null===(o=l.options)||void 0===o?void 0:o.key])}))||void 0===o?void 0:o.length)>0});var a,s,u,r,v,c,p;if(o)if((null===l||void 0===l||null===(a=l.options)||void 0===a||null===(s=a.list)||void 0===s?void 0:s.length)>0)W=""===W?"".concat(null!==(u=null===(r=o.component_fields.find(e=>{var o;return e.field_name===(null===l||void 0===l||null===(o=l.options)||void 0===o?void 0:o.list[0])}))||void 0===r?void 0:r.value)&&void 0!==u?u:""):"".concat(null!==(v=W)&&void 0!==v?v:"","  ").concat(null!==(c=null===(p=o.component_fields.find(e=>{var o;return e.field_name===(null===l||void 0===l||null===(o=l.options)||void 0===o?void 0:o.list[0])}))||void 0===p?void 0:p.value)&&void 0!==c?c:"")}}}),null!==(J=fo.processModule)&&void 0!==J&&null!==(H=J.module)&&void 0!==H&&null!==(Q=H.options)&&void 0!==Q&&Q.title.find(e=>"UUID"===e))W="".concat(null===(le=fo.processModule)||void 0===le||null===(oe=le.module)||void 0===oe?void 0:oe.name," #").concat(Go?Jo.id.replace(/\D/g,"").slice(-5):(0,B.mR)().replace(/\D/g,"").slice(-5));if(null!==(K=fo.processModule)&&void 0!==K&&null!==($=K.module)&&void 0!==$&&null!==(ee=$.options)&&void 0!==ee&&ee.title.find(e=>"Module Name"===e))W=" ".concat(null===(te=fo.processModule)||void 0===te||null===(ie=te.module)||void 0===ie?void 0:ie.name," - ").concat(null!==(ne=W)&&void 0!==ne?ne:"")}else{var de,ae;W="".concat(null===(de=fo.processModule)||void 0===de||null===(ae=de.module)||void 0===ae?void 0:ae.name," #").concat(Go?Jo.id.replace(/\D/g,"").slice(-5):(0,B.mR)().replace(/\D/g,"").slice(-5))}let se,ue={};if(!0===(null===(v=fo.processModule)||void 0===v||null===(_=v.module)||void 0===_||null===(f=_.options)||void 0===f?void 0:f.emailOutputs)){var re,ve;let e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Info"===e.data_type_name&&1==e.options.email))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});if(void 0!==e){var ce,pe;const l=null===(ce=e.component_blueprints)||void 0===ce||null===(pe=ce.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>{var l;return"Info"===e.data_type_name&&1==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.email)}))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===pe?void 0:pe.find(e=>{var l;return"Info"===e.data_type_name&&!0===(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.email)}),o=go.find(e=>{var o;return(null===(o=e.component_fields.filter(e=>e.component_blueprint_id===l.options.component_id&&e.value===D))||void 0===o?void 0:o.length)>0});o&&(j=l.id,R=o.id)}if(e=fo.processModule.steps.find(e=>{var l;return!0===e.is_end&&(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Emails"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0}),void 0!==e){var me;(null===(me=e.component_blueprints)||void 0===me?void 0:me.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Emails"===e.data_type_name))||void 0===l?void 0:l.length)>0})).selected_fields.filter(e=>"Emails"===e.data_type_name).filter(e=>{var l;I.find(l=>l.value===e.options.valueToMatch&&l.field_name===e.options.fieldToMatch)&&(S&&(F=e,T=!0,!0===(null===(l=e.options)||void 0===l?void 0:l.copyEmailRecip)&&(P=P.concat(P.length>0?",".concat(S):S))))})}var _e;if(P=""===P?[]:null!==(re=P.split(","))&&void 0!==re?re:[],(Tt.length>0||P.length>0)&&(P=Go?!0===T?[...Tt,...P]:[...Tt]:[...Tt,...P]),P.length>0&&(ue={emailTo:P}),j&&R&&(ue=(0,t.Z)((0,t.Z)({},ue),{},{info:j,target:R})),(null===(ve=F)||void 0===ve?void 0:ve.id.length)>0)ue=(0,t.Z)((0,t.Z)({},ue),{},{template:null===(_e=F)||void 0===_e?void 0:_e.id})}if(!0===(null===(y=fo.processModule)||void 0===y||null===(h=y.module)||void 0===h||null===(g=h.options)||void 0===g?void 0:g.rewards)&&A!==q){const e=fo.processModule.steps.find(e=>{var l;return(null===(l=e.component_blueprints.filter(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Rewards"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===l?void 0:l.length)>0});var fe,ye,he,ge,be,Me;if(void 0!==e)if(se=null===(fe=e.component_blueprints)||void 0===fe||null===(ye=fe.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Rewards"===e.data_type_name))||void 0===l?void 0:l.length)>0}).selected_fields)||void 0===ye?void 0:ye.find(e=>"Rewards"===e.data_type_name),se.options.status===q)So.options.rewards=+(null!==(he=null===So||void 0===So||null===(ge=So.options)||void 0===ge?void 0:ge.rewards)&&void 0!==he?he:0)+ +(null===(be=se)||void 0===be||null===(Me=be.options)||void 0===Me?void 0:Me.points)}var Ee,Ce,we,Ie,De,Ne,Pe,Ue,Ae,Ye,Be,Le,Re,je,Fe,We,ze,Ve,Ge,Xe,Je,He,Qe,Ke,$e,el,ll,ol,tl,il;null!==(b=fo.processModule)&&void 0!==b&&null!==(M=b.module)&&void 0!==M&&null!==(E=M.options)&&void 0!==E&&E.close&&(q=(null===(Ee=fo.processModule)||void 0===Ee||null===(Ce=Ee.module)||void 0===Ce||null===(we=Ce.options)||void 0===we||null===(Ie=we.lock)||void 0===Ie?void 0:Ie.length)>0?(null!==(De=null===(Ne=fo.processModule)||void 0===Ne||null===(Pe=Ne.module)||void 0===Pe||null===(Ue=Pe.options)||void 0===Ue?void 0:Ue.lock)&&void 0!==De?De:"").split(",")[0]:null!==(Ae=null===ho||void 0===ho||null===(Ye=ho.misc_info)||void 0===Ye?void 0:Ye.lock)&&void 0!==Ae?Ae:"Close");(null===(C=I)||void 0===C?void 0:C.length)>0?(dt(!0),Go?(Jo.options=ue,Jo.status=q,null!==Fo&&void 0!==Fo&&Fo.assigned_to&&(Jo.assigned_to={id:null===Fo||void 0===Fo?void 0:Fo.assigned_to}),(0,u.KL)((0,t.Z)((0,t.Z)({},Jo),{},{selected_fields:[...I],component_items:Fo.items}),Jo.id,null===Jo||void 0===Jo||null===(Be=Jo.shared_users)||void 0===Be?void 0:Be.map(e=>null===e||void 0===e?void 0:e.id),W,Qo,(null===(Le=fo.processModule)||void 0===Le||null===(Re=Le.module)||void 0===Re||null===(je=Re.options)||void 0===je||null===(Fe=je.shares)||void 0===Fe?void 0:Fe.length)>0?[...null!==(We=null===(ze=fo.processModule)||void 0===ze||null===(Ve=ze.module)||void 0===Ve||null===(Ge=Ve.options)||void 0===Ge?void 0:Ge.shares)&&void 0!==We?We:[],...U]:[...null!==(Xe=null===Jo||void 0===Jo||null===(Je=Jo.shared_positions)||void 0===Je?void 0:Je.map(e=>null===e||void 0===e?void 0:e.id))&&void 0!==Xe?Xe:[],...U]).subscribe({error:e=>{c.h.dispatch((0,p.Xc)({show:!0,message:"Errors found",color:"red"}))},next:e=>{var l,o,i,n,d,a,s;if(fo.processModule.selectedComponent=e.data,Ho(e.data),Fo.id=null===e||void 0===e?void 0:e.data.id,null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.single)return localStorage.setItem(null===(a=fo.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(null===e||void 0===e?void 0:e.data)),void li(null===(s=fo.processModule.steps[0])||void 0===s?void 0:s.id);const u=I.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});if(u){var r;const l=JSON.parse(null!==(r=null===u||void 0===u?void 0:u.value)&&void 0!==r?r:{task:0}),o=Po.find(e=>e.id===(null===l||void 0===l?void 0:l.task));var v,_;if(o)(0,qe.xJ)((0,t.Z)((0,t.Z)({},o),{},{assignee_id:null===e||void 0===e||null===(v=e.data)||void 0===v||null===(_=v.created_by)||void 0===_?void 0:_.id}),null===o||void 0===o?void 0:o.id).pipe((0,m.P)()).subscribe({})}const f=I.find(e=>"Payments"===e.data_type_name),y=I.find(e=>{var l;return e.field_name===(null===f||void 0===f||null===(l=f.options)||void 0===l?void 0:l.paymentField)});var h;if("Closed"!==(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(!f||null!==e&&void 0!==e&&null!==(h=e.data.payments)&&void 0!==h&&h.stripe_id||"Cash"===(null===f||void 0===f?void 0:f.value)||"Wallet"===(null===f||void 0===f?void 0:f.value)||"Points"===(null===f||void 0===f?void 0:f.value))if(f){var g,b,M,E,C,w;if(y&&"Cash"!==(null===f||void 0===f?void 0:f.value)&&((null!==(g=null===(b=fo.processModule)||void 0===b||null===(M=b.module)||void 0===M||null===(E=M.options)||void 0===E?void 0:E.lock)&&void 0!==g?g:"").split(",").includes(q)||q===(null===(C=ho.misc_info)||void 0===C?void 0:C.lock))&&So.id===(null===Jo||void 0===Jo||null===(w=Jo.assigned_to)||void 0===w?void 0:w.id)&&A!==q){var x,S;const e=+(null===y||void 0===y?void 0:y.value)-+(null===y||void 0===y?void 0:y.value)*+(null!==(x=null===ho||void 0===ho||null===(S=ho.misc_info)||void 0===S?void 0:S.rate)&&void 0!==x?x:.2);(0,Te.e_)({user_id:So.id,id:(0,B.mR)(),total:e,product:"CR-".concat(W),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var l;So.wallet=+(+(null!==(l=null===So||void 0===So?void 0:So.wallet)&&void 0!==l?l:0)+e),oi()}})}else se?(0,Oe.Vy)(So,null===So||void 0===So?void 0:So.options).pipe((0,m.P)()).subscribe({next:()=>{oi()},error:()=>c.h.dispatch((0,p.Xc)({show:!0,message:"Errors found",color:"red"}))}):oi()}else oi();else Fo.total=+(null===y||void 0===y?void 0:y.value),Fo.plan=+(null===y||void 0===y?void 0:y.value),localStorage.setItem("forPayment",JSON.stringify(e)),Yt(!0),dt(!1);else oi()},complete:()=>{dt(!1)}})):(0,u.LM)({id:x[0].id,selected_fields:[...I],component_items:Fo.items,options:ue,status:q,assigned_to:null!==(He=null===Fo||void 0===Fo?void 0:Fo.assigned_to)&&void 0!==He?He:k},"",fo.processModule.module_id,$o,W,Qo,(null===(Qe=fo.processModule)||void 0===Qe||null===(Ke=Qe.module)||void 0===Ke||null===($e=Ke.options)||void 0===$e||null===(el=$e.shares)||void 0===el?void 0:el.length)>0?[...null!==(ll=null===(ol=fo.processModule)||void 0===ol||null===(tl=ol.module)||void 0===tl||null===(il=tl.options)||void 0===il?void 0:il.shares)&&void 0!==ll?ll:[],...U]:[...lt,...U]).subscribe({next:e=>{var l,o,i,n,d,a,s;if(fo.processModule.selectedComponent=e,Ho(e),Fo.id=null===e||void 0===e?void 0:e.id,null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.single)return localStorage.setItem(null===(a=fo.processModule)||void 0===a?void 0:a.module.id,JSON.stringify(e)),li(null===(s=fo.processModule.steps[0])||void 0===s?void 0:s.id),void Xo(!0);Z.length>0&&ii(Z);const u=I.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});if(u){var r;const l=JSON.parse(null!==(r=null===u||void 0===u?void 0:u.value)&&void 0!==r?r:{task:0}),o=Po.find(e=>e.id===(null===l||void 0===l?void 0:l.task));var v;if(o)(0,qe.xJ)((0,t.Z)((0,t.Z)({},o),{},{assignee_id:null===e||void 0===e||null===(v=e.created_by)||void 0===v?void 0:v.id}),null===o||void 0===o?void 0:o.id).pipe((0,m.P)()).subscribe({})}var _,f,y,h;if("Closed"!==(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)&&"Cancelled"!==(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.status))if(I.filter(e=>!("Cash"===(null===e||void 0===e?void 0:e.value)||"Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name).length>0)localStorage.setItem("forPayment",JSON.stringify(e)),dt(!1),Yt(!0);else if(I.filter(e=>("Wallet"===(null===e||void 0===e?void 0:e.value)||"Points"===(null===e||void 0===e?void 0:e.value))&&"Payments"===e.data_type_name).length>0){var g;const l=I.find(e=>"Payments"===e.data_type_name);(0,Te.e_)({user_id:So.id,id:(0,B.mR)(),total:-Fo.total,product:"DB-".concat(W),notes:null!==(g=null===l||void 0===l?void 0:l.value)&&void 0!==g?g:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var o,i;(0,Oe.Vy)(So,(0,t.Z)((0,t.Z)({},null===So||void 0===So?void 0:So.options),{},{points:+(+(null!==(o=null===So||void 0===So||null===(i=So.options)||void 0===i?void 0:i.points)&&void 0!==o?o:0)-("Points"===(null===l||void 0===l?void 0:l.value)?+Fo.total:0))})).pipe((0,m.P)()).subscribe({next:l=>{var o,t,i,n;So.options=l.options,bt((null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t||null===(i=t.options)||void 0===i||null===(n=i.message)||void 0===n?void 0:n.length)>0&&1==e.is_complete),c.h.dispatch((0,p.RV)({})),oi()}})}})}else{var b,M,E,C;dt(!1),bt((null===fo||void 0===fo||null===(b=fo.processModule)||void 0===b||null===(M=b.module)||void 0===M||null===(E=M.options)||void 0===E||null===(C=E.message)||void 0===C?void 0:C.length)>0&&1==e.is_complete),c.h.dispatch((0,p.RV)({})),oi()}else dt(!1),bt((null===fo||void 0===fo||null===(_=fo.processModule)||void 0===_||null===(f=_.module)||void 0===f||null===(y=f.options)||void 0===y||null===(h=y.message)||void 0===h?void 0:h.length)>0&&1==e.is_complete),c.h.dispatch((0,p.RV)({})),oi()},error:e=>{var l,o,t,i;null!==e&&void 0!==e&&e.data&&(c.h.dispatch((0,p.Xc)({show:!0,message:"Errors found",color:"red"})),null!==Z&&ii(Z),bt((null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o||null===(t=o.options)||void 0===t||null===(i=t.message)||void 0===i?void 0:i.length)>0&&1==(null===e||void 0===e?void 0:e.data.is_complete)),c.h.dispatch((0,p.RV)({})),oi())},complete:()=>{dt(!1)}})):(c.h.dispatch((0,p.Xc)({show:!0,message:"There are no items to be saved",color:"red"})),window.scrollTo({top:0,behavior:"smooth"}))},ii=e=>{if((null===e||void 0===e?void 0:e.length)>0){var l;const o=null!==(l=ho.misc_info)&&void 0!==l?l:{};e.filter(e=>{var l;o[e]=+(null!==(l=o[e])&&void 0!==l?l:1)+1}),dt(!0),(0,v.x5)({misc_info:o}).pipe((0,m.P)()).subscribe({})}},ni=()=>{Lo("Fill up all the required fields"),window.scrollTo({top:0,behavior:"smooth"}),Uo(!1)},di=function(e){let l=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(l=>l.module_id===e).filter(e=>{var i,n;return t.length>0?t.includes(e.id):""===l?e:(null===(i=e.title)||void 0===i?void 0:i.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase()))||(null===(n=e.component_fields.filter(e=>{var t,i,n,d,a,s;return"Record"===e.data_type_name?null===(t=go.find(l=>{var o;return(null===(o=l.component_fields.filter(l=>l.field_name===e.options.output&&l.component_blueprint_id===e.options.component_id&&l.value===(null===e||void 0===e?void 0:e.value)))||void 0===o?void 0:o.length)>0}))||void 0===t||null===(i=t.component_fields.find(l=>{var o;return null===(o=e.options)||void 0===o?void 0:o.names.includes(l.field_name)}).value)||void 0===i?void 0:i.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase()):void 0!==o?("date"===e.data_type?null===(n=O()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===n?void 0:n.format("DD MMM YYYY").includes(l):null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.includes(l))&&e.field_name===o:"date"===e.data_type?null===(a=O()(new Date(null===e||void 0===e?void 0:e.value)))||void 0===a?void 0:a.format("DD MMM YYYY").includes(l):null===e||void 0===e||null===(s=e.value)||void 0===s?void 0:s.toUpperCase().includes(null===l||void 0===l?void 0:l.toUpperCase())}))||void 0===n?void 0:n.length)>0})},ai=function(e){var l,o;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ct,a=w.Z([k.Z(S.Z("created_date"))])(d.filter(e=>e.created_by.id===(null===So||void 0===So?void 0:So.id)?e:"Expired"!==e.status)).map(l=>{var o,t,d,a,s,u,r,v,c,p,m,_,f,y,h,b,M,E;const C={};l.component_fields.filter(e=>"output"!==e.data_type).forEach(e=>{C[e.field_name]=e.value}),e.list.map(e=>{const o=l.component_fields.find(l=>l.field_name===e);if(void 0!=o)if("People"===o.data_type_name)C[e]=o.value;else if("Positions"===o.data_type_name){var t,d;C[e]=null!==(t=null===(d=ko.find(e=>e.value===o.value))||void 0===d?void 0:d.label)&&void 0!==t?t:""}else if("Date"===o.data_type_name){var a;const l=new Date(null===o||void 0===o||null===(a=o.value)||void 0===a?void 0:a.split(",")[0]);C[e]=O()(l).format("DD MMM YYYY")}else if("Link"===o.data_type_name){var s,u,r;(null!==(s="".concat(C[e]))&&void 0!==s&&s.includes("jpg")||null!==(u="".concat(C[e]))&&void 0!==u&&u.includes("jpeg")||null!==(r="".concat(C[e]))&&void 0!==r&&r.includes("png"))&&(C[e]=i.createElement("img",{alt:"lg",src:null===o||void 0===o?void 0:o.value,className:n.imageColumn}))}else if("Filters"===o.data_type_name){var v;C[e]=g.tq?"".concat(null===o||void 0===o?void 0:o.value.slice(0,20)):"".concat(null===o||void 0===o?void 0:o.value),null===(v=go.find(e=>{var l;return(null===(l=e.component_fields.filter(e=>e.field_name===o.options.output&&e.component_blueprint_id===o.options.component_id&&e.value===(null===o||void 0===o?void 0:o.value)))||void 0===l?void 0:l.length)>0}))||void 0===v||v.component_fields.filter(e=>{C[e.field_name]=g.tq?e.value.slice(0,20):e.value})}else if("Status"===o.data_type_name){var c;if(0==l.is_complete)C[e]="Draft";else C[e]="".concat(null!==(c=null===l||void 0===l?void 0:l.status)&&void 0!==c?c:null===o||void 0===o?void 0:o.value)}else{var p;C[e]=g.tq?null===o||void 0===o?void 0:o.value.split(",")[0].slice(0,20):null===o||void 0===o||null===(p=o.value)||void 0===p?void 0:p.split(",")[0]}}),null===e||void 0===e||null===(o=e.com)||void 0===o||null===(t=o.selected_fields)||void 0===t||null===(d=t.filter(e=>"Details"===e.data_type_name))||void 0===d||d.forEach(e=>{var l,o,t,i;const n=C[null!==(l=null===(o=e.options)||void 0===o?void 0:o.field)&&void 0!==l?l:e.options.key],d=go.find(l=>l.module_id===e.options.module_id&&l.component_fields.find(l=>l.field_name===e.options.key&&l.value===n));C[e.field_name]=null===(t=e.options)||void 0===t||null===(i=t.fields.map(e=>{var l,o;return null===d||void 0===d||null===(l=d.component_fields)||void 0===l||null===(o=l.find(l=>l.field_name===e))||void 0===o?void 0:o.value}))||void 0===i?void 0:i.join(" ")}),(null===l||void 0===l||null===(a=l.component_items)||void 0===a?void 0:a.length)>0&&(C["Total Qty"]=l.component_items.reduce((e,l)=>e+ +l.quantity,0)),(null===l||void 0===l||null===(s=l.shared_positions)||void 0===s?void 0:s.length)>0&&(C.Shares=null===l||void 0===l?void 0:l.shared_positions.map(e=>{var l;return null===(l=ko.find(l=>l.value===e.id))||void 0===l?void 0:l.label}).toString());const w=new Date(l.created_date);return C.id=l.id,C.ID=l.id,C["Created By"]="".concat(null===l||void 0===l||null===(u=l.created_by)||void 0===u?void 0:u.first_name," ").concat(null===l||void 0===l||null===(r=l.created_by)||void 0===r?void 0:r.last_name),C["Created Date"]=O()(w).format("DD MMM YYYY h:mm a"),C["Assigned To"]="".concat(null!==(v=null===l||void 0===l||null===(c=l.assigned_to)||void 0===c?void 0:c.first_name)&&void 0!==v?v:""," ").concat(null!==(p=null===l||void 0===l||null===(m=l.assigned_to)||void 0===m?void 0:m.last_name)&&void 0!==p?p:""),C.Status=g.tq?null!==(_=null===l||void 0===l?void 0:l.status)&&void 0!==_?_:"-":Mt?null===l||void 0===l?void 0:l.status:i.createElement("div",{className:n.statusBox,style:{display:(null!==l&&void 0!==l&&l.status,""),backgroundColor:null!==(f=null===(y=B.MO.find(e=>e.value===(null===l||void 0===l?void 0:l.status)))||void 0===y?void 0:y.color)&&void 0!==f?f:null!==l&&void 0!==l&&l.status?"#3C32AA":" brown",height:"26px",maxWidth:(null===l||void 0===l||null===(h=l.status)||void 0===h?void 0:h.length)>12?"200px":"100px"}},0==l.is_complete?"DRAFT":null!==(b=null===l||void 0===l||null===(M=l.status)||void 0===M?void 0:M.toUpperCase())&&void 0!==b?b:"NONE"),C.Title=l.title,C.items=l.component_items,C[fo.processModule.module.name]=l.title,null===e||void 0===e||null===(E=e.reports)||void 0===E||E.filter(e=>"Formula"===e.data_type_name).map(e=>{const o=(0,B.LV)(e.options,e.options.list.map(e=>{var l;return{value:null!==(l=C[e])&&void 0!==l?l:0}}),go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}),null===l||void 0===l?void 0:l.component_items);C[e.field_name]="".concat(o)}),C});null===e||void 0===e||null===(l=e.reports)||void 0===l||l.filter(e=>"List Filter"===e.data_type_name).map(e=>{a=a.filter(l=>{var o,t;return l[null===(o=e.options)||void 0===o?void 0:o.field]===(null===(t=e.options)||void 0===t?void 0:t.value)})});const s=null===e||void 0===e||null===(o=e.reports)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name);if(s){let e=[];a.map(l=>{l.items.filter(o=>{const i=(0,t.Z)({},l);Object.keys(s.options.map).map(e=>{i[s.options.map[e]]=o[e]}),e=[...e,i]}),delete l.items}),a=e}return null!==e&&void 0!==e&&e.title&&(a=(0,ce.HR)(a,e,fo)),a},si=()=>{var e,l,o,t,n,a;return i.createElement(pe.Z,{light:!0,style:{display:null!==fo&&void 0!==fo&&null!==(e=fo.processModule)&&void 0!==e&&null!==(l=e.module)&&void 0!==l&&null!==(o=l.options)&&void 0!==o&&o.one?go.find(e=>{var l,o,t;return e.module_id===(null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)&&(null===e||void 0===e||null===(t=e.created_by)||void 0===t?void 0:t.id)===So.id})?"none":"":1!=(null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t||null===(n=t.module)||void 0===n||null===(a=n.options)||void 0===a?void 0:a.readOnly)||"manager"===So.user_type||"admin"===So.user_type?"":"none"},clicked:()=>{ei(),Ho({})},icon:i.createElement("img",{src:d.IH})})},ui=()=>[...new Set(xt.filter(e=>void 0!==e.Status).map(e=>e.Status))].map(e=>({label:e,value:e})),ri=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt,o=JSON.parse(JSON.stringify(l));e.filter((e,t)=>{"status"===e.type?o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l.Status===e.value)]:o.filter(l=>l.Status===e.value):"user"===e.type?o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l["Created By"]===e.label)]:o.filter(l=>l["Created By"]===e.label):"fields"===e.type&&(o="OR"===It.operator?[...0==t?[]:o,...l.filter(l=>l[e.filter]===e.value)]:o.filter(l=>l[e.filter]===e.value))}),St(o)},vi=()=>{var e;return i.createElement("div",{style:{display:""}},i.createElement(fe.Z,{value:null!==(e=It.operator)&&void 0!==e?e:"AND",className:n.dropdownSelectOperation,items:[{label:"AND",value:"AND"},{label:"OR",value:"OR"}],onChange:e=>{Dt((0,t.Z)((0,t.Z)({},It),{},{operator:e}))}}))},ci=()=>i.createElement("div",{style:{alignSelf:"flex-end",display:Xt.component_blueprints.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asReport)}).length>0?"flex":"none"}},i.createElement(pe.Z,{light:!0,clicked:()=>{Mt?(Dt({list:[],operator:"AND"}),wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))):wt([]),Zt([]),Et(!Mt)},style:Mt?{height:"36px"}:{}},Mt?i.createElement(A.G,{icon:Y.g82,style:{width:"25px",height:"25px"}}):i.createElement("img",{src:d.aR})),1==Mt&&i.createElement(i.Fragment,null,i.createElement(fe.Z,{className:n.dropdownSelectReport,items:Xt.component_blueprints.filter(e=>{var l,o,t;return 1==(null===(l=e.options)||void 0===l?void 0:l.asReport)&&(void 0===(null===(o=e.options)||void 0===o?void 0:o.showOnly)||0==(null===(t=e.options)||void 0===t?void 0:t.showOnly.length)||So.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0)}).map(e=>({label:null===e||void 0===e?void 0:e.name,value:e.id,blueprint:e})),visible:!0,onChange:e=>{var l,o;wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}));let t=[];w.Z([x.Z(S.Z("index"))])(Xt.component_blueprints.find(l=>l.id===e).selected_fields.filter(e=>1==e.visible)).map(e=>{t=[...t,e.field_name],"Info"===e.data_type_name?e.options.list.map(e=>t=[...t,e]):"Transaction List"===e.data_type_name&&Object.values(e.options.map).map(e=>t=[...t,e])}),Dt({list:[...new Set(t)],title:null===(l=Xt.component_blueprints.find(l=>l.id===e))||void 0===l?void 0:l.name,reports:w.Z([k.Z(S.Z("index"))])(Xt.component_blueprints.find(l=>l.id===e).selected_fields).map(e=>({field_name:e.field_name,data_type_name:e.data_type_name,options:e.options})),operator:"AND"}),St(ai({list:[...new Set(t)],title:null===(o=Xt.component_blueprints.find(l=>l.id===e))||void 0===o?void 0:o.name,reports:w.Z([k.Z(S.Z("index"))])(Xt.component_blueprints.find(l=>l.id===e).selected_fields).map(e=>({field_name:e.field_name,data_type_name:e.data_type_name,options:e.options})),operator:"AND"},go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})))},placeholder:"Reports"}))),pi=function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(l[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=fo.processModule.module)||void 0===e?void 0:e.name;return i.createElement(pe.Z,{light:!0,title:(null===It||void 0===It?void 0:It.title)&&"Export as file",clicked:()=>{var e,i,n;const d=Mt?o:1==(null===(e=fo.processModule.module)||void 0===e||null===(i=e.options)||void 0===i?void 0:i.isMaster)?[...o,"Shares","Title"]:o,a=Ne.utils.book_new(),s=Ne.utils.json_to_sheet([]);Ne.utils.sheet_add_aoa(s,[d]),Ne.utils.sheet_add_json(s,l.map(e=>Object.assign({},...d.map(l=>({[l]:e[l]})))),{origin:"A2",skipHeader:!0}),Ne.utils.book_append_sheet(a,s,"".concat(null===(n=fo.processModule.module)||void 0===n?void 0:n.name)),(0,Ne.writeFile)(a,"".concat(t).concat((0,T.now)(),".xlsx"))}},i.createElement("img",{src:d.so}))},mi=null===Jo||void 0===Jo||null===(V=Jo.component_fields)||void 0===V?void 0:V.find(e=>"Status"===e.data_type_name);let _i=[];null===fo||void 0===fo||null===(G=fo.processModule)||void 0===G||null===(X=G.steps)||void 0===X||X.filter(e=>null===e||void 0===e?void 0:e.component_blueprints.filter(e=>{var l,o;return(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)>0})).filter(e=>{e.component_blueprints.filter(e=>{var l,o;return(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)>0}).filter(e=>{e.options.showOnly.filter(e=>{_i=[..._i,e]})})});const fi=(null===fo||void 0===fo||null===(J=fo.processModule)||void 0===J||null===(H=J.steps)||void 0===H?void 0:H.length)>0?null===fo||void 0===fo||null===(Q=fo.processModule)||void 0===Q||null===(K=Q.steps)||void 0===K||null===($=K.find(e=>(null===e||void 0===e?void 0:e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Freehand"===e.data_type_name).length>0).length)>0))||void 0===$||null===(ee=$.component_blueprints.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Freehand"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===ee||null===(le=ee.options)||void 0===le?void 0:le.showOnly:void 0,yi=(null===fo||void 0===fo||null===(oe=fo.processModule)||void 0===oe||null===(te=oe.steps)||void 0===te?void 0:te.length)>0?null===fo||void 0===fo||null===(ne=fo.processModule)||void 0===ne||null===(de=ne.steps)||void 0===de||null===(ae=de.find(e=>(null===e||void 0===e?void 0:e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0).length)>0))||void 0===ae||null===(se=ae.component_blueprints.find(e=>{var l;return(null===(l=e.selected_fields.filter(e=>"Action Button"===e.data_type_name))||void 0===l?void 0:l.length)>0}))||void 0===se||null===(ue=se.options)||void 0===ue?void 0:ue.showOnly:void 0,hi=!tt&&(void 0===(null===Jo||void 0===Jo?void 0:Jo.status)&&((null===(re=_i)||void 0===re?void 0:re.filter(e=>So.positions.map(e=>e.id).indexOf(e)>-1).length)>0||(null===fi||void 0===fi?void 0:fi.filter(e=>So.positions.map(e=>e.id).indexOf(e)>-1).length)>0)||(void 0===(null===Jo||void 0===Jo?void 0:Jo.status)||"New"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Show"===(null===Jo||void 0===Jo?void 0:Jo.status)||"None"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Reopen"===(null===Jo||void 0===Jo?void 0:Jo.status)||null===(null===Jo||void 0===Jo?void 0:Jo.status))&&((null===Jo||void 0===Jo||null===(ve=Jo.created_by)||void 0===ve?void 0:ve.id)===(null===So||void 0===So?void 0:So.id)||(null===Jo||void 0===Jo||null===(me=Jo.assigned_to)||void 0===me?void 0:me.id)===(null===So||void 0===So?void 0:So.id))||void 0!==(null===Jo||void 0===Jo?void 0:Jo.status)&&!("Hide"===(null===Jo||void 0===Jo?void 0:Jo.status)||"Closed"===(null===Jo||void 0===Jo?void 0:Jo.status)||(null!==(ye=null===(Be=fo.processModule)||void 0===Be||null===(je=Be.module)||void 0===je||null===(We=je.options)||void 0===We?void 0:We.lock)&&void 0!==ye?ye:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)||(null===Jo||void 0===Jo?void 0:Jo.status)===(null===ho||void 0===ho||null===(ze=ho.misc_info)||void 0===ze?void 0:ze.lock)||"Cancelled"===(null===Jo||void 0===Jo?void 0:Jo.status))&&((null===(Ve=_i)||void 0===Ve?void 0:Ve.filter(e=>So.positions.map(e=>e.id).indexOf(e)>-1).length)>0||(null===fi||void 0===fi?void 0:fi.filter(e=>So.positions.map(e=>e.id).indexOf(e)>-1).length)>0)&&(1!=(null===fo||void 0===fo||null===(Ge=fo.processModule)||void 0===Ge||null===(Xe=Ge.module)||void 0===Xe||null===(Je=Xe.options)||void 0===Je?void 0:Je.strict)||(null===Jo||void 0===Jo||null===(He=Jo.created_by)||void 0===He?void 0:He.id)!==(null===So||void 0===So?void 0:So.id))||(null===(Qe=fo.processModule)||void 0===Qe||null===(Ke=Qe.module)||void 0===Ke||null===($e=Ke.options)||void 0===$e?void 0:$e.allEdit)||(!1===(null===Jo||void 0===Jo?void 0:Jo.is_complete)||null===(el=null===mi||void 0===mi||null===(ll=mi.options)||void 0===ll?void 0:ll.control)||void 0===el||el)&&(null===Jo||void 0===Jo||null===(ol=Jo.created_by)||void 0===ol?void 0:ol.id)===(null===So||void 0===So?void 0:So.id)&&(!(null!==mi&&void 0!==mi&&null!==(tl=mi.options)&&void 0!==tl&&tl.control||null!==fo&&void 0!==fo&&null!==(il=fo.processModule)&&void 0!==il&&null!==(nl=il.module)&&void 0!==nl&&null!==(dl=nl.options)&&void 0!==dl&&dl.close)||!((null===Jo||void 0===Jo?void 0:Jo.status)===(null===ho||void 0===ho||null===(al=ho.misc_info)||void 0===al?void 0:al.lock)||(null!==(sl=null===(ul=fo.processModule)||void 0===ul||null===(rl=ul.module)||void 0===rl||null===(vl=rl.options)||void 0===vl?void 0:vl.lock)&&void 0!==sl?sl:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)))),gi="trial_ended"!==ho.status&&"inactive"!==ho.status&&(0===(null===(cl=Jo.component_fields)||void 0===cl?void 0:cl.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action).length)||0===(null===(pl=Jo.component_fields)||void 0===pl?void 0:pl.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action&&void 0===e.value).length)&&((null===(ml=Jo.component_fields)||void 0===ml?void 0:ml.filter(e=>"Action Button"===e.data_type_name&&"user"===e.options.action&&e.value===(null===So||void 0===So?void 0:So.id)).length)>0||(null===Jo||void 0===Jo||null===(_l=Jo.assigned_to)||void 0===_l?void 0:_l.id)===(null===So||void 0===So?void 0:So.id))),bi=(g.tq?[]:[i.createElement(pe.Z,{key:0,title:!g.tq&&"Close",icon:g.tq&&i.createElement(A.G,{icon:Y.QQm,style:{ccolor:"var(--app-color-gray)",width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px"},clicked:()=>{!tt&&Vo(!1),it(!1)}})]).concat(!tt&&(null===Jo||void 0===Jo||null===(fl=Jo.component_fields)||void 0===fl?void 0:fl.length)>0&&(0,B.cQ)(null===Jo||void 0===Jo?void 0:Jo.status,yi,Jo,So,fo,ho)?null===fo||void 0===fo||null===(yl=fo.processModule)||void 0===yl||null===(hl=yl.steps)||void 0===hl||null===(gl=hl.find(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0).length>0))||void 0===gl||null===(bl=gl.component_blueprints.find(e=>e.selected_fields.filter(e=>"Action Button"===e.data_type_name).length>0))||void 0===bl?void 0:bl.selected_fields.filter(e=>"Action Button"===e.data_type_name).map((e,l)=>{var o,d,a,s;if("status"===e.options.action){var r,v,_,f,y,h,g,b;let o=(null===ho||void 0===ho||null===(r=ho.misc_info)||void 0===r||null===(v=r.status)||void 0===v?void 0:v.length)>0?null===ho||void 0===ho||null===(_=ho.misc_info)||void 0===_?void 0:_.status:B.MO;var M;if((null===ho||void 0===ho||null===(f=ho.misc_info)||void 0===f||null===(y=f.rules)||void 0===y?void 0:y.length)>0)null===ho||void 0===ho||null===(M=ho.misc_info)||void 0===M||M.rules.filter(e=>"status"===e.type).filter(l=>{l.valueCondition===e.value&&(o="0"===l.allow?o.filter(e=>l.values.includes(e.value)):o.filter(e=>!l.values.includes(e.value)))});return i.createElement("div",{key:l,style:{width:"100%",display:"user"===e.options.action&&null!==(h=Jo.component_fields)&&void 0!==h&&null!==(g=h.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==g&&g.value?"none":""}},i.createElement(fe.Z,{titleProps:{fontSize:"16px",color:"var(--app-color-gray-light)"},className:n.multiselectComponent,key:l,visible:e.visible,mandatory:e.mandatory,value:null!==(b=e.value)&&void 0!==b?b:"",items:o,error:e.errors,onChange:l=>{var o,i,n,d;if(null!==(o=fo.processModule)&&void 0!==o&&null!==(i=o.module)&&void 0!==i&&null!==(n=i.options)&&void 0!==n&&n.credits&&(l===(null===(d=ho.options)||void 0===d?void 0:d.lock)||"Closed"===l)){var a,s,r,v,_,f,y,h;const e=null===fo||void 0===fo||null===(a=fo.processModule)||void 0===a||null===(s=a.steps)||void 0===s||null===(r=s.find(e=>e.component_blueprints.filter(e=>e.selected_fields.filter(e=>"Payments"===e.data_type_name).length>0).length>0))||void 0===r||null===(v=r.component_blueprints.find(e=>e.selected_fields.filter(e=>"Payments"===e.data_type_name).length>0))||void 0===v?void 0:v.selected_fields.find(e=>"Payments"===e.data_type_name),l=null===(_=Fo.newStepComponents.concat(Fo.components).find(l=>l.selected_fields.filter(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)}).length>0))||void 0===_||null===(f=_.selected_fields)||void 0===f?void 0:f.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});let o=0;if(null===(y=fo.processModule)||void 0===y||null===(h=y.selectedComponent.payments)||void 0===h||!h.stripe_id)return Vo(!1),fo.processModule.showDetail=!1,void c.h.dispatch((0,p.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));var g,b;if(!(+(null!==(g=null===l||void 0===l?void 0:l.value)&&void 0!==g?g:0)>0))return void c.h.dispatch((0,p.Xc)({show:!0,message:"No amount found",color:"red",spinner:!1,bottom:!0}));o=+(null!==(b=null===l||void 0===l?void 0:l.value)&&void 0!==b?b:0),"Cash"!==(null===e||void 0===e?void 0:e.value)&&(0,Te.e_)({user_id:So.id,id:(0,B.mR)(),total:o,product:"CR-".concat(null===Jo||void 0===Jo?void 0:Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;So.wallet=+(+(null!==(e=null===So||void 0===So?void 0:So.wallet)&&void 0!==e?e:0)+o)}})}ho.start=!0,dt(!0),(0,u.C0)({component_id:Jo.id,index:0,group:99,value:l,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:e=>{dt(!1),Vo(!1),c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))},error:()=>{},complete:()=>{}})},fieldIcon:e.icon,fieldLabel:e.field_name,placeholder:"Select status..."}))}return i.createElement(i.Fragment,null,i.createElement(pe.Z,{light:!0,title:e.field_name,loading:nt,clicked:()=>{if("user"===e.options.action||"creator"===e.options.action){var l,o,i;const E="user"===e.options.action?So:Eo.find(e=>{var l;return e.id===(null===(l=Jo.created_by)||void 0===l?void 0:l.id)});if(null!==(l=fo.processModule)&&void 0!==l&&null!==(o=l.module)&&void 0!==o&&null!==(i=o.options)&&void 0!==i&&i.credits){var n,d,a,s,r,v,_,f;const e=null===(n=Jo.component_fields)||void 0===n?void 0:n.find(e=>"Payments"===e.data_type_name&&(null===e||void 0===e?void 0:e.value));let l=null===(d=Fo.newStepComponents.concat(Fo.components).find(l=>l.selected_fields.filter(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)}).length>0))||void 0===d||null===(a=d.selected_fields)||void 0===a?void 0:a.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});var y;if(!l)l=null===(y=Jo.component_fields)||void 0===y?void 0:y.find(l=>{var o;return l.field_name===(null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.paymentField)});let o=0;if(void 0===(null===E||void 0===E?void 0:E.wallet)||0===(null===E||void 0===E?void 0:E.wallet))return c.h.dispatch((0,p.Xc)({show:!0,message:"You need to setup funds for your wallet",color:"red",spinner:!1,bottom:!0})),fo.processModule.showDetail=!1,void Vo(!1);if(+(null!==(s=null===(r=l)||void 0===r?void 0:r.value)&&void 0!==s?s:0)>0&&"Cash"===(null===e||void 0===e?void 0:e.value)){var h,g,b,M;if((null!==(h=+(null===E||void 0===E?void 0:E.wallet))&&void 0!==h?h:0)<+(null===(g=l)||void 0===g?void 0:g.value))return c.h.dispatch((0,p.Xc)({show:!0,message:"Insufficient funds in wallet",color:"red",spinner:!1,bottom:!0})),fo.processModule.showDetail=!1,void Vo(!1);o=null!==(b=null===(M=l)||void 0===M?void 0:M.value)&&void 0!==b?b:0}else if(null===(v=fo.processModule)||void 0===v||null===(_=v.selectedComponent)||void 0===_||null===(f=_.payments)||void 0===f||!f.stripe_id)return Vo(!1),fo.processModule.showDetail=!1,void c.h.dispatch((0,p.Xc)({show:!0,message:"Check support payment docs",color:"red",spinner:!1,bottom:!0}));"Cash"===(null===e||void 0===e?void 0:e.value)&&(0,Te.e_)({user_id:So.id,id:(0,B.mR)(),total:-o,product:"DB-".concat(null===Jo||void 0===Jo?void 0:Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;return E.wallet=+(+(null!==(e=null===E||void 0===E?void 0:E.wallet)&&void 0!==e?e:0)-o)},error:()=>c.h.dispatch((0,p.Xc)({show:!0,message:"Purchase error encountered",color:"red",spinner:!1,bottom:!0}))})}dt(!0),(0,u.C0)({component_id:Jo.id,index:0,group:99,value:E.id,procedure_step_blueprint_field_id:e.procedure_step_blueprint_field_id}).subscribe({next:e=>{(0,u.dn)(Jo.id,E.id).subscribe({next:e=>{dt(!1),Vo(!1),c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))}})},error:()=>{},complete:()=>{}})}else"status"===e.options.action||"date"===e.options.action||e.options.action,dt(!1)},style:{backgroundColor:"green",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px",display:"user"===e.options.action&&null!==(o=Jo.component_fields)&&void 0!==o&&null!==(d=o.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==d&&d.value?"none":""}}),i.createElement(pe.Z,{title:"Decline",light:!0,loading:nt,clicked:()=>{var e,l;Xo(!0),dt(!0);const o=Jo.component_fields.find(e=>{var l;return"People"===e.data_type_name&&!0===(null===(l=e.options)||void 0===l?void 0:l.calendar)});(0,u.KL)((0,t.Z)((0,t.Z)({},Jo),{},{selected_fields:o?Jo.component_fields.filter(e=>e.id!==o.id):Jo.component_fields,assigned_to:{id:""}}),Jo.id,null===(e=Jo.shared_users)||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.id),Jo.title,Jo.is_complete,null===(l=Jo.shared_positions)||void 0===l?void 0:l.map(e=>null===e||void 0===e?void 0:e.id)).subscribe({error:e=>{c.h.dispatch((0,p.Xc)({show:!0,message:"Errors found",color:"red"}))},next:e=>{c.h.dispatch((0,p.aT)(Jo.id)),dt(!1),Vo(!1),c.h.dispatch((0,p.q4)((0,t.Z)((0,t.Z)({},fo.processModule),{},{showDetail:!1})))}})},style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px",display:"user"===e.options.action&&null!==(a=Jo.component_fields)&&void 0!==a&&null!==(s=a.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id))&&void 0!==s&&s.value?"none":""}}))}):[]).concat(tt?[]:[i.createElement(pe.Z,{light:!g.tq,key:3,title:!g.tq&&"Print",icon:g.tq&&i.createElement(A.G,{icon:Y.wf8,style:{width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:g.tq?"green":"lightgray",display:g.tq?"none":""},clicked:()=>{it(!0)}})]).concat(tt?[i.createElement(_e(),{key:4,trigger:()=>i.createElement("button",{style:{width:"100%",maxWidth:"220px",minWidth:"80px",display:g.tq?"none":""},className:n.singleButton},i.createElement(A.G,{icon:Y.wf8})),content:()=>Qt.current})]:[]).concat(hi&&gi?[i.createElement(pe.Z,{light:!g.tq,key:5,title:!g.tq&&"Edit",icon:g.tq&&i.createElement(A.G,{icon:Y.Xcf,style:{width:"20px",height:"20px"}}),style:{backgroundColor:g.tq?"var(--app-color-blue)":"lightgray",width:"100%",maxWidth:"220px",minWidth:"80px"},clicked:()=>{var e,l,o,t,i,n;Vo(!1),Xo(!0),fo.processModule.isUpdating=!0,(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.steps)||void 0===l?void 0:l.length)>0&&(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.steps)||void 0===t||t.filter(e=>{var l;return null===e||void 0===e||null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>e.value=void 0))}));let d=[];ke.Z(Ze.Z("group"))(null!==(i=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==i?i:[]).map(e=>{d=[...d,{id:e.component_blueprint_id,temp_id:e.id,selected_fields:De.Z(I.Z("group",e.group))(Jo.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{var l,o,t,i,n,d;return(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.asReport)||!(null!==e&&void 0!==e&&null!==(i=e.options)&&void 0!==i&&i.asReport))&&(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))}).filter(e=>{e.selected_fields.filter(e=>{var l;const o=null===(l=Jo.component_fields)||void 0===l?void 0:l.find(l=>l.field_name===e.field_name);if(void 0!=o)e.value=o.value,e.group=o.group;else if("Record"===e.data_type_name){var t;const l=null===(t=Jo.component_fields)||void 0===t?void 0:t.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value,e.value=l.group)}})})}),Fo.components=d,Fo.items=JSON.parse(JSON.stringify(null!==(n=null===Jo||void 0===Jo?void 0:Jo.component_items)&&void 0!==n?n:[])),Fo.newStepComponents=[],ho.start=!0,li()}})]:[]).concat(!hi||null===fo||void 0===fo||null===(Ml=fo.processModule)||void 0===Ml||null===(El=Ml.module)||void 0===El||null===(Cl=El.options)||void 0===Cl||!Cl.canCancel||"New"!==Jo.status||null!==(wl=Jo.assigned_to)&&void 0!==wl&&wl.id?[]:[i.createElement(pe.Z,{key:6,title:"Cancel",style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px",minWidth:"80px"},clear:!0,clicked:()=>{(0,u.tE)(null===Jo||void 0===Jo?void 0:Jo.id,"Cancelled").pipe((0,m.P)()).subscribe({next:e=>{}})}})]).concat(tt||null===fo||void 0===fo||null===(xl=fo.processModule)||void 0===xl||null===(Sl=xl.module)||void 0===Sl||null===(kl=Sl.options)||void 0===kl||!kl.canCancel||"New"!==Jo.status&&"Unassigned"!==Jo.status||null!==(Zl=Jo.assigned_to)&&void 0!==Zl&&Zl.id?[]:[i.createElement(pe.Z,{key:7,loading:nt,title:"Cancel Transaction",style:{backgroundColor:"red",color:"white",width:"100%",maxWidth:"220px"},clear:!0,clicked:()=>{dt(!0),(0,u.tE)(null===Jo||void 0===Jo?void 0:Jo.id,"Cancelled").pipe((0,m.P)()).subscribe({next:e=>{var l;if(dt(!1),null!==e&&void 0!==e&&null!==(l=e.data.payments)&&void 0!==l&&l.stripe_id){var o;const l=Math.abs(+(null===e||void 0===e||null===(o=e.data.payments)||void 0===o?void 0:o.stripe_price));(0,Te.e_)({user_id:So.id,id:(0,B.mR)(),total:l,product:"RF-".concat(Jo.title),notes:"Wallet",quantity:1}).pipe((0,m.P)()).subscribe({next:()=>{var e;So.wallet=+(+(null!==(e=null===So||void 0===So?void 0:So.wallet)&&void 0!==e?e:0)+l),dt(!1),Vo(!1)}})}else dt(!1),Vo(!1),it(!1)}})}})]).concat(tt||!0!==(null===(Il=fo.processModule.module)||void 0===Il?void 0:Il.options.copyOutputs)||(null===Jo||void 0===Jo||null===(Dl=Jo.created_by)||void 0===Dl?void 0:Dl.id)!==So.id?[]:[i.createElement(pe.Z,{key:8,light:!g.tq,title:!g.tq&&"Copy",icon:g.tq&&i.createElement(A.G,{icon:Y.kZ_,style:{width:"20px",height:"20px"}}),style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:g.tq?"orange":"lightgray",display:g.tq?"none":""},clicked:()=>{ct(!0)}})]).concat((null===Jo||void 0===Jo||null===(Nl=Jo.created_by)||void 0===Nl?void 0:Nl.id)===So.id&&(null===Jo||void 0===Jo||null===(Pl=Jo.component_items)||void 0===Pl?void 0:Pl.length)>0&&!g.tq?[function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.keys(l[0]),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(e=fo.processModule.module)||void 0===e?void 0:e.name;return i.createElement(pe.Z,{light:!g.tq,icon:i.createElement("img",{src:d.so}),style:{width:"100%",backgroundColor:"lightgray",maxWidth:"220px",minWidth:"80px"},clicked:()=>{var e,i,n;const d=null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(i=e.steps)||void 0===i?void 0:i.find(e=>e.component_blueprints.filter(e=>{var l,o;return(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.allowMultipleInputs)&&(null===(o=e.selected_fields)||void 0===o?void 0:o.find(e=>"Transaction List"===e.data_type_name))}).length>0),a=null===d||void 0===d||null===(n=d.component_blueprints)||void 0===n?void 0:n.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Transaction List"===e.data_type_name&&!0===e.visible).length)>0});if(a){var s,u,r,v;const e=null===fo||void 0===fo||null===(s=fo.processModule)||void 0===s||null===(u=s.steps)||void 0===u||null===(r=u.find(e=>e.component_blueprints.filter(e=>{var l;return null===(l=e.selected_fields)||void 0===l?void 0:l.find(e=>"Template"===e.data_type_name)}).length>0))||void 0===r||null===(v=r.component_blueprints)||void 0===v?void 0:v.find(e=>{var l;return(null===(l=e.selected_fields)||void 0===l?void 0:l.filter(e=>"Template"===e.data_type_name&&!0===e.visible).length)>0});(0,ce._G)(Jo,a,e,o,l,fo,t)}else{var c;const e=o,i=Ne.utils.book_new(),n=Ne.utils.json_to_sheet([]);Ne.utils.sheet_add_json(n,l.map(l=>Object.assign({},...e.map(e=>({[e]:l[e]})))),{origin:"A2",skipHeader:!0}),Ne.utils.book_append_sheet(i,n,"".concat(null===(c=fo.processModule.module)||void 0===c?void 0:c.name)),(0,Ne.writeFile)(i,"".concat(t).concat((0,T.now)(),".xlsx"))}}})}(Jo.component_items,["item_code","quantity","value","alt_value"])]:[]).concat(!tt&&!0===(null===So||void 0===So?void 0:So.is_admin)&&!g.tq&&(!(null!==mi&&void 0!==mi&&null!==(Tl=mi.options)&&void 0!==Tl&&Tl.control||null!==fo&&void 0!==fo&&null!==(Ol=fo.processModule)&&void 0!==Ol&&null!==(ql=Ol.module)&&void 0!==ql&&null!==(Ul=ql.options)&&void 0!==Ul&&Ul.close)||(null===Jo||void 0===Jo?void 0:Jo.status)!==(null===ho||void 0===ho||null===(Al=ho.misc_info)||void 0===Al?void 0:Al.lock)&&!(null!==(Yl=null===(Bl=fo.processModule)||void 0===Bl||null===(Ll=Bl.module)||void 0===Ll||null===(Rl=Ll.options)||void 0===Rl?void 0:Rl.lock)&&void 0!==Yl?Yl:"").split(",").includes(null===Jo||void 0===Jo?void 0:Jo.status)&&"Closed"!==(null===Jo||void 0===Jo?void 0:Jo.status))||(null===(jl=Jo.created_by)||void 0===jl?void 0:jl.id)===(null===So||void 0===So?void 0:So.id)&&0==(null===Jo||void 0===Jo?void 0:Jo.is_complete)?[i.createElement(pe.Z,{key:11,icon:g.tq&&i.createElement(A.G,{icon:Y.$aW,style:{width:"20px",height:"20px"}}),title:!g.tq&&"Delete",style:{width:"100%",maxWidth:"220px",minWidth:"80px",backgroundColor:"#F71534"},clicked:()=>{var e,l,o;if(!0===(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.module)||void 0===l||null===(o=l.options)||void 0===o?void 0:o.isMaster)){const e=go.filter(e=>e.module_id!==Jo.module_id).filter(e=>-1!=yo.filter(e=>{var l;return!0===(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.isMaster)}).map(e=>e.id).indexOf(e.module_id)),l=go.filter(e=>-1!=yo.filter(e=>{var l;return 1!=(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.isMaster)}).map(e=>e.id).indexOf(e.module_id)),o=e.filter(e=>e.component_fields.filter(e=>-1!=Jo.component_fields.map(e=>e.value).indexOf(e.value)).length>0).length>0||l.filter(e=>e.component_items.filter(e=>-1!=Jo.component_fields.map(e=>e.value).indexOf(e.item_code)).length>0).length>0||l.filter(e=>e.component_fields.filter(e=>"output"!==e.data_type&&-1!=Jo.component_fields.map(e=>e.value).indexOf(e.value)).length>0).length>0;ft(o),rt(!o)}else rt(!0)}})]:[]);return i.createElement("div",{className:n.processStepHost},i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":g.tq?"true":"false"},1==(null===Xt||void 0===Xt?void 0:Xt.rank)&&i.createElement(he,{title:null===fo||void 0===fo||null===(Fl=fo.processModule)||void 0===Fl||null===(Wl=Fl.module)||void 0===Wl?void 0:Wl.name,subtitle:g.tq?"":null===fo||void 0===fo||null===(zl=fo.processModule)||void 0===zl?void 0:zl.description,customStyle:{width:g.tq?"100%":"94%",minWidth:g.tq?"100px":"94%"},cardClicked:()=>{wo(null===fo||void 0===fo?void 0:fo.processModule),st(!at),at||(0,r.zJ)(null===fo||void 0===fo?void 0:fo.processModule.id).pipe((0,m.P)()).subscribe({next:e=>{c.h.dispatch((0,p.Xu)(e)),c.h.dispatch((0,p.an)([...No.filter(l=>l.id!==e.id),e],1)),(0,u.d7)(B.KI,B.RI).pipe((0,m.P)()).subscribe({})}})}})),at&&1==(null===Xt||void 0===Xt?void 0:Xt.rank)&&i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":g.tq?"true":"false"},i.createElement(he,{description:"Steps:",customStyle:{width:g.tq?"100%":"94%",minWidth:g.tq?"100px":"94%"}},i.createElement(be.FZ,null,i.createElement(ge.Z,null)))),xo,i.createElement("div",{className:n.centeredCardMargin,"app-variant-is-mobile":g.tq?"true":"false"},1===Oo&&void 0===(null===Xt||void 0===Xt?void 0:Xt.component_blueprints)?i.createElement("div",{className:n.centeredSpinner},i.createElement(s.$j,{size:80,type:"ThreeDots"})):(null===Xt||void 0===Xt||null===(Vl=Xt.component_blueprints)||void 0===Vl?void 0:Vl.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asModuleList)}).length)>0?null===Xt||void 0===Xt||null===(Gl=Xt.component_blueprints)||void 0===Gl?void 0:Gl.filter(e=>{var l,o,t;return 1==e.options.asModuleList&&(So.positions.filter(l=>{var o,t;return null===(o=e.options)||void 0===o||null===(t=o.showOnly)||void 0===t?void 0:t.includes(l.id)}).length>0||0==(null===(l=e.options)||void 0===l||null===(o=l.showOnly)||void 0===o?void 0:o.length)||void 0===(null===(t=e.options)||void 0===t?void 0:t.showOnly))}).map((e,l)=>{var o,a,s;return i.createElement(i.Fragment,{key:l},i.createElement(C.default,{className:g.tq?n.listContainerMob:n.listContainer,isReport:Mt,title:Mt?"Reports":null===Xt||void 0===Xt?void 0:Xt.name,columns:(null===(o=go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))||void 0===o?void 0:o.filter(e=>{var l;return 0===(null===(l=e.component_fields)||void 0===l?void 0:l.length)}).length)>0?[fo.processModule.module.name]:g.tq?null!==e&&void 0!==e&&null!==(a=e.options)&&void 0!==a&&a.key?[fo.processModule.module.name,null===e||void 0===e||null===(s=e.options)||void 0===s?void 0:s.key]:[fo.processModule.module.name,"Status"]:[...new Set(Mt?It.list:w.Z([x.Z(S.Z("index"))])(e.selected_fields.filter(e=>1==e.visible)).map(e=>{var l;return"Info"===e.data_type_name?null===(l=e.options)||void 0===l?void 0:l.list:e.field_name}).flat())].slice(0,g.tq?2:18),list:Mt?xt:ai({com:e,list:e.selected_fields.filter(e=>"Info"===e.data_type_name).map(e=>{var l,o;return null!==(l=null===e||void 0===e||null===(o=e.options)||void 0===o?void 0:o.key)&&void 0!==l?l:e.field_name}).concat(e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name))}),addClicked:()=>{ei(),Ho({})},onListItemClick:e=>{var l,o;if(Mt)return;const t=go.find(l=>l.id===e.id);if(0===(null===(l=t.component_fields)||void 0===l?void 0:l.length))return dt(!0),void(0,u.r6)(t.id).pipe((0,m.P)()).subscribe({next:e=>{Ho(e),Ko(e.is_complete),Vo(!0),it(!1),dt(!1)},error:()=>{}});var i,n,d,a;if(Ho(t),Ko(t.is_complete),it(!1),null!==t&&void 0!==t&&null!==(o=t.assigned_to)&&void 0!==o&&o.id&&!Eo.find(e=>{var l;return e.id===(null===t||void 0===t||null===(l=t.assigned_to)||void 0===l?void 0:l.id)}))(0,Oe.VG)(Eo.find(e=>{var l;return e.id===(null===(l=t.created_by)||void 0===l?void 0:l.id)})?[null===t||void 0===t||null===(i=t.assigned_to)||void 0===i?void 0:i.id]:[null===t||void 0===t||null===(n=t.assigned_to)||void 0===n?void 0:n.id,null===t||void 0===t||null===(d=t.created_by)||void 0===d?void 0:d.id]).pipe((0,m.P)()).subscribe({next:e=>{c.h.dispatch((0,p.NY)(Eo.concat(e))),Vo(!0)}});else if(fo.processModule.user_id!==So.id&&null!==(a=fo.processModule.module.options)&&void 0!==a&&a.skipDetail){var s,r,v,_,f,y;Vo(!1),Xo(!0),fo.processModule.isUpdating=!0,(null===fo||void 0===fo||null===(s=fo.processModule)||void 0===s||null===(r=s.steps)||void 0===r?void 0:r.length)>0&&(null===fo||void 0===fo||null===(v=fo.processModule)||void 0===v||null===(_=v.steps)||void 0===_||_.filter(e=>{var l;return null===e||void 0===e||null===(l=e.component_blueprints)||void 0===l?void 0:l.filter(e=>e.selected_fields.filter(e=>e.value=void 0))}));let e=[];ke.Z(Ze.Z("group"))(null!==(f=null===t||void 0===t?void 0:t.component_fields)&&void 0!==f?f:[]).map(l=>{e=[...e,{id:l.component_blueprint_id,temp_id:l.id,selected_fields:De.Z(I.Z("group",l.group))(t.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{var l,o,t,i,n,d;return(0==(null===e||void 0===e||null===(l=e.options)||void 0===l?void 0:l.asDashboard)||!(null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.asDashboard))&&(0==(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.asReport)||!(null!==e&&void 0!==e&&null!==(i=e.options)&&void 0!==i&&i.asReport))&&(0==(null===e||void 0===e||null===(n=e.options)||void 0===n?void 0:n.asModuleList)||!(null!==e&&void 0!==e&&null!==(d=e.options)&&void 0!==d&&d.asModuleList))}).filter(e=>{e.selected_fields.filter(e=>{const l=t.component_fields.find(l=>l.field_name===e.field_name);if(void 0!=l)e.value=l.value,e.group=l.group;else if("Record"===e.data_type_name){const l=t.component_fields.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value,e.value=l.group)}})})}),Fo.components=e,Fo.items=JSON.parse(JSON.stringify(null!==(y=null===t||void 0===t?void 0:t.component_items)&&void 0!==y?y:[])),Fo.newStepComponents=[],ho.start=!0,li()}else Vo(!0)},pages:fo.processModule.module.count,onPageClicked:e=>{const l=go.filter(e=>e.module_id===fo.processModule.module.id);if(12345===e){var o;l.length<(null===(o=fo.processModule.module)||void 0===o?void 0:o.count)&&(0,Ee.vC)(fo.processModule.module,B.Qc,999999,1).pipe((0,_.q)(1)).subscribe({next:e=>{var l;dt(!1),fo.processModule.module.lastUpdate=0,fo.processModule.module.count=null!==(l=null===e||void 0===e?void 0:e.total)&&void 0!==l?l:0}})}else{var t,i;let o=Math.ceil((null!==(t=fo.processModule.module)&&void 0!==t&&t.count?+(null===(i=fo.processModule.module)||void 0===i?void 0:i.count):l.length)/B.ZP);g.tq&&o>7&&(o=7);const n=Math.ceil(l.length/B.ZP),d=e;d>n&&(dt(!0),Mo.componentsByModule[fo.processModule.module.name]=0,(0,Ee.vC)(fo.processModule.module,B.Qc,d-n<=1?B.ZP:B.ZP*d,d-n<=1?d:1).pipe((0,_.q)(1)).subscribe({next:e=>{var l;dt(!1),Mo.componentsByModule[fo.processModule.module.name]=(0,T.now)(),fo.processModule.module.lastUpdate=0,fo.processModule.module.count=null!==(l=null===e||void 0===e?void 0:e.total)&&void 0!==l?l:0}}))}}},i.createElement("div",null,i.createElement("div",{style:{display:"flex"}},kt.length>0&&i.createElement(pe.Z,{title:"Show all",clicked:()=>{wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),Dt((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})),St(ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},style:{height:"30px",width:"140px"}}),kt.map((e,l)=>i.createElement(pe.Z,{className:n.customButton,icon:i.createElement("img",{src:d.C7,style:{height:"16px",width:"16px"}}),clicked:()=>{Zt(kt.filter(l=>l.value!==e.value)),ri(kt.filter(l=>l.value!==e.value),ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},key:l,style:{height:"30px",width:"inherit"}},"".concat(0==l?"":e.operator," ").concat(e.label))),kt.length>0&&i.createElement(pe.Z,{title:"Apply",style:{height:"30px",width:"160px"},clicked:()=>{ri(kt,ai((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})))},light:!0})),Mt&&i.createElement("div",{style:{display:"flex"}},vi(),ui().length>0&&i.createElement(fe.Z,{className:n.dropdownSelectComponent,items:ui(),onChange:e=>{kt.map(e=>e.label).includes(e)||Zt([...kt,{label:e,value:e,type:"status",operator:It.operator}])},placeholder:"Status"}),Mt&&i.createElement(fe.Z,{className:n.dropdownSelectComponent,items:It.list.map(e=>({label:e,value:e})),onChange:e=>{Dt((0,t.Z)((0,t.Z)({},It),{},{filter:void 0})),setTimeout(()=>Dt((0,t.Z)((0,t.Z)({},It),{},{filter:e})),10)},placeholder:"Filter by fields"}),1==Mt&&void 0!==(null===It||void 0===It?void 0:It.filter)&&i.createElement(fe.Z,{className:n.dropdownSelectComponentL,items:[...new Set(ai(It).map(e=>e[It.filter]))].map(e=>({label:e,value:e})),onChange:e=>{kt.map(e=>e.value).includes(e)||Zt([...kt,{label:"".concat(It.filter,": ").concat(e),value:e,type:"fields",filter:It.filter,operator:It.operator}])},placeholder:"Field value"}),1==Mt&&i.createElement(fe.Z,{className:n.dropdownSelectComponent,items:Eo.map(e=>({label:"".concat(e.first_name," ").concat(e.last_name),value:e.id})),onChange:e=>{if(!kt.map(e=>e.label).includes(e)){const l=Eo.find(l=>l.id===e);Zt([...kt,{label:"".concat(l.first_name," ").concat(l.last_name),value:e,type:"user",operator:It.operator}])}},placeholder:"Created by"}))),i.createElement("div",{className:n.actionsContainer},!(null!==It&&void 0!==It&&It.title)&&Mt&&i.createElement("label",{style:{padding:"20px 0px 20px 5px",fontSize:"12px"}},"OR"===It.operator?"Selecting OR will select all instances of selected value":"Selecting AND will only include instances of selected value"),Mt?(null===It||void 0===It?void 0:It.title)&&pi(xt,It.list,It.title):i.createElement("div",{className:n.searchContainer},i.createElement(A.G,{icon:Y.wn1,style:{width:"25px",height:"25px",padding:"5px"}}),i.createElement("input",{placeholder:"Search",className:n.searchInput,onChange:e=>{var l,o,t;if("deleteContentBackward"===e.nativeEvent.inputType)wt(di(null===fo||void 0===fo||null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t?void 0:t.id,go,e.target.value));else if((null===(l=e.target.value)||void 0===l?void 0:l.length)>0){var i,n;wt(di(null===fo||void 0===fo||null===(i=fo.processModule)||void 0===i||null===(n=i.module)||void 0===n?void 0:n.id,Ct,e.target.value))}else 0==e.target.value.length&&wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)}))}})),Mt&&ci(),i.createElement("div",{style:{display:Mt?"none":"flex",alignSelf:"flex-end"}},!("trial_ended"===ho.status||"inactive"===ho.status||"free"===ho.status||"on_trial"===ho.status)&&si(),"on_trial"===ho.status&&go.filter(e=>e.module_id===fo.processModule.module.id&&O()(new Date(e.created_date)).format("DDMMYYYY")===O()(new Date).format("DDMMYYYY")).length<5&&si(),"free"===ho.status&&go.filter(e=>O()(new Date(e.created_date)).format("DDMMYYYY")===O()(new Date).format("DDMMYYYY")).length<3&&si(),!g.tq&&ci(),!g.tq&&pi(ai({list:e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name)}),e.selected_fields.filter(e=>1==e.visible).map(e=>e.field_name)),i.createElement(pe.Z,{light:!0,clicked:()=>{dt(!0);const e=yo.find(e=>e.id===fo.processModule.module_id);Mo.componentsByModule[e.name]=0,(0,Ee.vC)(e,B.Qc,B.R6,1).pipe((0,_.q)(1)).subscribe({next:l=>{var o;const t=null!==l&&void 0!==l&&l.data?null===l||void 0===l?void 0:l.data:l;c.h.dispatch((0,p.mK)(Ie.Z(S.Z("created_date"),[...go.filter(e=>e.module_id!==fo.processModule.module_id),...t]),B.KI,Io.map(e=>e.fields).flat(1))),Mo.componentsByModule[e.name]=(0,T.now)(),e.lastUpdate=(0,T.now)(),e.count=null!==(o=null===l||void 0===l?void 0:l.total)&&void 0!==o?o:0,dt(!1)},complete:()=>{},error:()=>dt(!1)})},icon:i.createElement("img",{src:d.Fd}),loading:nt,message:"Fetching ".concat(fo.processModule.module.name,"...")})))))}):i.createElement("div",{className:n.listContainer,"app-variant-is-mobile":g.tq?"true":"false"},i.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},i.createElement("p",{className:n.stepTitleSmaller},null===Xt||void 0===Xt?void 0:Xt.name),i.createElement(pe.Z,{clear:!0,clicked:()=>{var l,o,t;dt(!0),null===(l=fo.processModule.module)||void 0===l||null===(o=l.options)||void 0===o||null===(t=o.supporting)||void 0===t||t.filter((l,o)=>{var t,i,n;dt(!0),(0,Ee.vC)({id:l,name:null!==(t="".concat(null===yo||void 0===yo||null===(i=yo.find(e=>e.id===l))||void 0===i?void 0:i.name).concat(o))&&void 0!==t?t:"".concat(null===(n=e)||void 0===n?void 0:n.name).concat(o)},B.Qc,B.R6,1).pipe((0,_.q)(1)).subscribe({next:e=>{var l,t,i,n;(null===(l=fo.processModule.module)||void 0===l||null===(t=l.options)||void 0===t||null===(i=t.supporting)||void 0===i?void 0:i.length)==o+1&&(dt(!1),li(null===(n=fo.processModule.steps[fo.processModule.stepIndex-1])||void 0===n?void 0:n.id))},error:()=>dt(!1)})})},icon:i.createElement("img",{src:d.Fd}),loading:nt})),i.createElement("br",null),i.createElement("label",{className:n.stepGuidanceSmaller},null===Xt||void 0===Xt?void 0:Xt.guidance),Bo&&i.createElement(E.Z,{message:Bo,onClick:()=>Lo("")}),i.createElement(Re,{nextButtonClicked:Ro,step:Xt,setIsMandatoryError:Yo,isMandatoryError:Ao,begunModule:fo,companyData:ho,blueprints:Io,components:go,products:Co,authenticatedUser:So,isEditing:bo,companyUsersArray:Eo,usersArray:Nt,setUsers:et,setPositions:ot,setIsCompleted:Ko,selectedComponent:Jo,goToNextStep:li,companyPositionsArray:ko,cart:Zo,allModules:yo,editMode:qt},i.createElement("div",{className:n.menuRightButtons}),(()=>{var e,l,o,t,a,s,u;return i.createElement("div",{className:n.menuAccordionButtons},fo.processModule.stepIndex>0&&i.createElement(pe.Z,{title:"Cancel",light:!0,clicked:()=>{Fo.components.length>0||Fo.newStepComponents.length>0?jt(!0):(fo.processModule.back_array=[],wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),li(fo.processModule.steps[0].id),Ut(!1))}}),fo.processModule.stepIndex>0&&i.createElement(pe.Z,{title:"Back",light:!0,style:{width:"80px"},clicked:()=>{var e,l,o;if(1==fo.processModule.stepIndex&&wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),1==(null===Xt||void 0===Xt||null===(e=Xt.options)||void 0===e?void 0:e.deleteOnBack)&&Xt.component_blueprints.filter(e=>e.selected_fields.filter(e=>"output"!==e.data_type).map(e=>{e.value=void 0})),(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.back_array)||void 0===o?void 0:o.length)>0){var t;const e=null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t?void 0:t.back_array.pop();e&&li(e)}else{var i;li(null===(i=fo.processModule.steps[fo.processModule.stepIndex-1])||void 0===i?void 0:i.id)}}}),!0===(null===Xt||void 0===Xt?void 0:Xt.is_end)?i.createElement(pe.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:Go?"Update":Qo&&null!==(e=null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o||null===(t=o.options)||void 0===t?void 0:t.save)&&void 0!==e?e:"Save",loading:nt,style:{marginLeft:"0px",display:null!==fo&&void 0!==fo&&null!==(a=fo.processModule)&&void 0!==a&&null!==(s=a.module)&&void 0!==s&&null!==(u=s.options)&&void 0!==u&&u.nosave?"none":Fo.components.length>0||Fo.newStepComponents.length>0?"":"none"},clicked:()=>{var e,l,o,t,i,n;return qt?Lo("Saving is not allowed in Edit Mode"):1==(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e||null===(l=e.module)||void 0===l||null===(o=l.options)||void 0===o?void 0:o.emailOutputs)&&1==(null===fo||void 0===fo||null===(t=fo.processModule)||void 0===t||null===(i=t.module)||void 0===i||null===(n=i.options)||void 0===n?void 0:n.selectiveEmail)&&Qo?mt(!0):ti()}}):i.createElement(pe.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:"Next",style:{width:"80px"},clicked:()=>{var e,l,o,t,i,n,d,a,s;Array.isArray(null===fo||void 0===fo||null===(e=fo.processModule)||void 0===e?void 0:e.back_array)||(fo.processModule.back_array=[]),null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||l.back_array.push(null===Fo||void 0===Fo||null===(o=Fo.currentStep)||void 0===o?void 0:o.id);const u=null===(t=Xt.component_blueprints.find(e=>e.selected_fields.filter(e=>{var l,o;return"Dropdown"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)&&"decision"===(null===(o=e.options)||void 0===o?void 0:o.type)}).length>0))||void 0===t||null===(i=t.selected_fields)||void 0===i?void 0:i.find(e=>{var l;return"Dropdown"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)}),r=null===(n=Xt.component_blueprints.find(e=>e.selected_fields.filter(e=>{var l;return"Value Button"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)}).length>0))||void 0===n||null===(d=n.selected_fields)||void 0===d?void 0:d.filter(e=>{var l;return"Value Button"===e.data_type_name&&(null===(l=e.options)||void 0===l?void 0:l.jump1)});var v,m,_,f,y;if(null!==u&&void 0!==u&&null!==(a=u.options)&&void 0!==a&&a.jump1&&null!==u&&void 0!==u&&null!==(s=u.options)&&void 0!==s&&s.jump2)if(0==(null===u||void 0===u||null===(v=u.options)||void 0===v?void 0:v.list.indexOf(null===u||void 0===u?void 0:u.value)))$t(null===(_=No.find(e=>{var l;return e.id===(null===u||void 0===u||null===(l=u.options)||void 0===l?void 0:l.process)}))||void 0===_||null===(f=_.steps)||void 0===f||null===(y=f.find(e=>e.id===(null===u||void 0===u?void 0:u.options.jump1)))||void 0===y?void 0:y.id);else if(1==(null===u||void 0===u||null===(m=u.options)||void 0===m?void 0:m.list.indexOf(null===u||void 0===u?void 0:u.value))){var h,g,b;$t(null===(h=No.find(e=>{var l;return e.id===(null===u||void 0===u||null===(l=u.options)||void 0===l?void 0:l.process)}))||void 0===h||null===(g=h.steps)||void 0===g||null===(b=g.find(e=>e.id===(null===u||void 0===u?void 0:u.options.jump2)))||void 0===b?void 0:b.id)}else{var M;null===fo||void 0===fo||null===(M=fo.processModule)||void 0===M||M.back_array.pop(),c.h.dispatch((0,p.Xc)({show:!0,message:"Please select a value for ".concat(null===u||void 0===u?void 0:u.field_name),color:"red",bottom:!1}))}else if((null===r||void 0===r?void 0:r.length)>0){const e=r.filter(e=>void 0!==e.value);var E,C,w,x,S;if(1==e.length)$t(null===(E=No.find(l=>{var o,t;return l.id===(null===(o=e[0])||void 0===o||null===(t=o.options)||void 0===t?void 0:t.process)}))||void 0===E||null===(C=E.steps)||void 0===C||null===(w=C.find(l=>{var o;return l.id===(null===(o=e[0])||void 0===o?void 0:o.options.jump1)}))||void 0===w?void 0:w.id);else null===fo||void 0===fo||null===(x=fo.processModule)||void 0===x||null===(S=x.back_array)||void 0===S||S.pop(),c.h.dispatch((0,p.Xc)({show:!0,message:"A selection is required",color:"red",bottom:!1})),window.scrollTo({top:0,behavior:"smooth"})}else if((null===Xt||void 0===Xt?void 0:Xt.next_steps.length)>1||Jt.length>1||Ht.length>1)Uo(!qo);else if(1===Xt.next_steps.length){var k;$t(null===Xt||void 0===Xt||null===(k=Xt.next_steps[0])||void 0===k?void 0:k.id)}else{var Z;$t(null===(Z=fo.processModule.steps[fo.processModule.steps.findIndex(e=>e.id===Xt.id)+1])||void 0===Z?void 0:Z.id)}}}),qo&&i.createElement("div",{className:n.goToNextStep},null===Xt||void 0===Xt?void 0:Xt.next_steps.map((e,l)=>i.createElement("div",{key:l,onClick:()=>$t(e.id),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.c6})),i.createElement("p",null,null===e||void 0===e?void 0:e.name))),null===Jt||void 0===Jt?void 0:Jt.map((e,l)=>i.createElement("div",{key:l,onClick:()=>$t(e.id),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.th})),i.createElement("p",null,null===e||void 0===e?void 0:e.name))),null===Ht||void 0===Ht?void 0:Ht.map((e,l)=>i.createElement("div",{key:l,onClick:()=>(e=>{c.h.dispatch((0,p.pU)(e)),Uo(!1)})(e),className:n.nextStepsContainer},i.createElement("div",{className:n.nextStepImageContainer},i.createElement("img",{alt:"",src:d.IR})),i.createElement("p",null,null===e||void 0===e?void 0:e.name)))))})())),(null===fo||void 0===fo||null===(Xl=fo.processModule)||void 0===Xl||null===(Jl=Xl.module)||void 0===Jl||null===(Hl=Jl.options)||void 0===Hl?void 0:Hl.ads)&&Ft&&0==(null===Xt||void 0===Xt||null===(Ql=Xt.component_blueprints)||void 0===Ql?void 0:Ql.filter(e=>{var l;return 1==(null===(l=e.options)||void 0===l?void 0:l.asModuleList)}).length)&&i.createElement("div",{style:{textAlign:"center"}},(e=>{if(e){const l=w.Z([k.Z(S.Z("created_date"))])(go.filter(l=>l.module_id===e.id)).filter(e=>{var l;return(null===(l=e.component_fields)||void 0===l?void 0:l.filter(e=>{var l,o,t,i,n;return"Status"===e.data_type_name&&!((null!==(l=null===(o=fo.processModule)||void 0===o||null===(t=o.module)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.lock)&&void 0!==l?l:"").split(",").includes(e.value)||"Closed"===e.value||"Cancelled"===e.value||"Hide"===e.value||e.value===(null===(n=ho.misc_info)||void 0===n?void 0:n.lock))}).length)>0}).map((e,l)=>{var o,t,d,a;const s=e.component_fields.find(e=>{var l,o,t;return"Link"===e.data_type_name&&((null!==(l=null===e||void 0===e?void 0:e.value)&&void 0!==l?l:"").includes("jpg")||(null!==(o=null===e||void 0===e?void 0:e.value)&&void 0!==o?o:"").includes("png")||(null!==(t=null===e||void 0===e?void 0:e.value)&&void 0!==t?t:"").includes("pdf"))});return i.createElement("div",{key:l,className:n.imageCard,onClick:()=>{}},s&&(null!==(o="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==o&&o.includes("jpg")||null!==(t="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==t&&t.includes("jpeg")||null!==(d="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==d&&d.includes("png")||null!==(a="".concat(null===s||void 0===s?void 0:s.value))&&void 0!==a&&a.includes("pdf"))&&null!==s&&void 0!==s&&s.value.includes("pdf")?i.createElement("embed",{src:"".concat(null===s||void 0===s?void 0:s.value,"#toolbar=0&navpanes=0&scrollbar=0&zoom=100%"),width:"1000px",height:"1000px"}):i.createElement("img",{alt:"lg",src:null===s||void 0===s?void 0:s.value,style:{objectFit:"contain",height:"100vh",borderRadius:"5px"}}))});return(null===l||void 0===l?void 0:l.length)>0&&i.createElement(s.U7,{isOpen:Ft,onClose:()=>{localStorage.setItem("showAdsDate",(0,T.now)()),Wt(!1)},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:"60%",minWidth:"600px",backgroundColor:"var(--app-color-gray-lightest)"}},i.createElement("div",{className:n.center,style:{display:(null===l||void 0===l?void 0:l.length)>0?"":"none",flexDirection:"column"}},(null===l||void 0===l?void 0:l.length)>1?i.createElement(Ye.tq,{slidesPerView:"auto",centeredSlides:!0,spaceBetween:200,initialSlide:1,pagination:{clickable:!0,dynamicBullets:!0},autoplay:{delay:1e4,disableOnInteraction:!0},modules:[Ae.pt,Ae.tl],className:"mySwiper"},(null===l||void 0===l?void 0:l.length)>0&&l.map((e,l)=>i.createElement(Ye.o5,{key:l,className:n.swiperslide},e))):l),i.createElement(s.pd,{title:"Do not show popup again?",style:{margin:"0px 20% 20px 20%",width:"auto",backgroundColor:"var(--app-color-gray-lightest)",padding:"10px 50px 10px 50px"},value:!Ft,toggleSelected:e=>{localStorage.setItem("showAdsDate",(0,T.now)()),localStorage.setItem("showAds",!e),Wt(!1)}}))}return i.createElement(i.Fragment,null)})(yo.find(e=>{var l,o,t;return e.id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o||null===(t=o.options)||void 0===t?void 0:t.ads)}))),Rt&&i.createElement(Ue.Z,{openModal:Rt,setOpenModal:jt,dialogHandler:()=>{fo.processModule.back_array=[],wt(go.filter(e=>{var l,o;return e.module_id===(null===fo||void 0===fo||null===(l=fo.processModule)||void 0===l||null===(o=l.module)||void 0===o?void 0:o.id)})),li(fo.processModule.steps[0].id),Ut(!1),jt(!1)},title:"You have unsaved items. Are you sure you want to cancel?",proceedTitle:"Yes",cancelTitle:"No, return back",loading:nt}),Bt&&fo.processModule.stepIndex>0&&i.createElement(s.U7,{isOpen:Bt,onClose:()=>Lt(!1),backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"40%"}},i.createElement("div",{style:{padding:"30px"}},i.createElement("p",{className:n.deleteText},"There were unsaved data for ".concat(Jo.title,". Do you want to restore them?")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(pe.Z,{title:"Yes, restore",clicked:()=>{c.h.dispatch((0,p.Xc)({show:!0,message:"Reverting to saved data from the cache. Press Save to permanently save these records. Cancel to revert back",color:"red",spinner:!1,bottom:!0})),Fo.items=JSON.parse(localStorage.getItem("items")),Fo.newStepComponents=JSON.parse(localStorage.getItem("newStepComponents")),localStorage.removeItem("transaction"),Lt(!1)}}),i.createElement(pe.Z,{title:"No, use the current data as is",light:!0,clicked:()=>{localStorage.removeItem("transaction"),Lt(!1)}})))),ut&&i.createElement(s.U7,{isOpen:u.v7,onClose:()=>{},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Are you sure you want to delete ".concat(Jo.title,"?")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(pe.Z,{title:"Yes, delete",style:{backgroundColor:"red"},clicked:()=>{ht(!0),(0,u.v7)(Jo.id).pipe((0,m.P)()).subscribe({next:()=>{ht(!1),Vo(!1),rt(!1);Jo.component_fields.filter(e=>("Image"===e.data_type_name||"Upload"===e.data_type_name)&&e.value).forEach(e=>{const l=null===e||void 0===e?void 0:e.value.indexOf("/files/"),o=null===e||void 0===e?void 0:e.value.substring(l+1);(0,u.cv)(o).subscribe({})})},complete:()=>{},error:()=>{ht(!1),rt(!1)}})},loading:yt}),i.createElement(pe.Z,{title:"No",light:!0,clicked:()=>rt(!1)})))),vt&&i.createElement(s.U7,{isOpen:vt,onClose:()=>{},backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Are you sure you want to copy ".concat(Jo.title,"? This will create a new copy")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(pe.Z,{title:"Yes, copy",clicked:()=>{var e;Vo(!1),ct(!1),ei();let l=[];ke.Z(Ze.Z("group"))(null!==(e=null===Jo||void 0===Jo?void 0:Jo.component_fields)&&void 0!==e?e:[]).map(e=>{l=[...l,{id:e.component_blueprint_id,temp_id:e.id,selected_fields:De.Z(I.Z("group",e.group))(Jo.component_fields)}]}),fo.processModule.steps.filter(e=>{e.component_blueprints.filter(e=>{e.selected_fields.filter(e=>{var l;const o=null===(l=Jo.component_fields)||void 0===l?void 0:l.find(l=>l.procedure_step_blueprint_field_id===e.procedure_step_blueprint_field_id);if(void 0!=o)"ID"===e.data_type_name||"Status"===e.data_type_name?e.value=void 0:e.value=o.value;else if("Record"===e.data_type_name){var t;const l=null===(t=Jo.component_fields)||void 0===t?void 0:t.find(l=>l.field_name===e.options.name);void 0!=l&&(e.value=l.value)}})})}),Wo({action:f._U.addModuleComponents,value:l}),Wo({action:f._U.setModuleItems,value:Jo.component_items}),Xo(!1),fo.processModule.isUpdating=!1,Ho({})}}),i.createElement(pe.Z,{title:"No",light:!0,clicked:()=>ct(!1)})))),_t&&i.createElement(s.U7,{isOpen:_t,onClose:()=>{},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"20%"}},i.createElement("div",null,i.createElement("p",{className:n.deleteText},"Cannot delete ".concat(Jo.title,". Some transactions and master data are using this item")),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(pe.Z,{title:"Close",light:!0,clicked:()=>ft(!1)}))))),At&&i.createElement(s.U7,{isOpen:At,onClose:()=>{},backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"80%"}},i.createElement(Pe.default,{hasCloseIcon:!0,label:null===fo||void 0===fo||null===(Kl=fo.processModule)||void 0===Kl||null===($l=Kl.module)||void 0===$l?void 0:$l.name,withBack:!1,paymentPath:"begin-module",onClose:()=>Yt(!1),companyData:ho,subscriptionInfo:{user_id:So.id,ref:Fo.id,plan_price:null!==(eo=null===Fo||void 0===Fo?void 0:Fo.plan)&&void 0!==eo?eo:0,currency:null!==(lo=null===Fo||void 0===Fo?void 0:Fo.currency)&&void 0!==lo?lo:"PHP",plan:"CC-".concat(Fo.id),total:null!==(oo=+(null===Fo||void 0===Fo?void 0:Fo.total))&&void 0!==oo?oo:0,billable_users:[So],duration:0,dlabel:Fo.id},onError:e=>{Lo(e),Yo(!0),Yt(!1),c.h.dispatch((0,p.Xc)({show:!0,message:"Transaction was created but the selected payment mode encountered an issue. Please select another payment option. You may also manually attach your proof of payment",color:"red",bottom:!0})),c.h.dispatch((0,p.RV)({})),oi()}})),pt&&i.createElement(s.U7,{isOpen:pt,onClose:()=>mt(!1),backdropColor:!0,blured:!0,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"15%"}},i.createElement("div",null,i.createElement(s.jL,{ungrouped:!0,title:"nonmanager"===So.user_type?"Type an email address to send copy of this transaction (optional)":"Select users to email this transaction (Optional)",columned:!0,withAckButton:!1},"nonmanager"===So.user_type?i.createElement("input",{placeholder:"Use comma, no space, for multiple email addresses",className:n.emailInput,onChange:e=>{new RegExp(/^([a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)(([, ]+[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])\.([a-z0-9]([a-z0-9-]*[a-z0-9]))*)?)*$/).test(e.target.value)&&Ot(e.target.value.split(","))}}):i.createElement(Me.Cm,{id:"Users",tagEmplacement:"inlined",searchable:!1,items:Nt.filter(e=>{var l;return e.department===(null===(l=So.departments[0])||void 0===l?void 0:l.name)}),groupedBy:"department",groupname:"department",triggerType:"chevron",initialSelectedValues:[],className:n.peoplePositionsSelect,inputClassName:n.peoplePositionsSelectInput,molclassname:n.peoplePositionsSelectMenuOverlay,moliclassname:n.peoplePositionsSelectMenuOverlayItem,onChange:e=>{e.length>0?Ot(null===e||void 0===e?void 0:e.map(e=>null===e||void 0===e?void 0:e.user.email)):Ot([])}})),i.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.createElement(pe.Z,{title:"Back",light:!0,clicked:()=>mt(!1)}),i.createElement(pe.Z,{disabled:!1===(null===ho||void 0===ho?void 0:ho.start),title:Go?"Update":Qo&&null!==(to=null===fo||void 0===fo||null===(io=fo.processModule)||void 0===io||null===(no=io.module)||void 0===no||null===(ao=no.options)||void 0===ao?void 0:ao.save)&&void 0!==to?to:"Save",loading:nt,style:{marginLeft:"0px"},clicked:()=>{mt(!1),ti()}})))),zo&&0==(null===fo||void 0===fo||null===(so=fo.processModule)||void 0===so?void 0:so.stepIndex)&&i.createElement(s.U7,{isOpen:zo,onClose:()=>Vo(!1),hasCloseIcon:!!g.tq,backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:"100%",height:"auto",minWidth:g.tq?"100%":"1000px",backgroundColor:g.tq?"":"transparent"}},i.createElement("div",{"app-variant-is-mobile":g.tq?"true":"false",style:{display:"flex",justifyContent:"center",flexDirection:"column"}},i.createElement(Fe,{ref:Qt,begunModule:fo,allModules:yo,companyData:ho,components:go,selectedComponent:Jo,companyUsersArray:Eo,print:tt,step:d.Nb,companyPositionsArray:ko,authenticatedUser:So,setIsOpen:Vo,setSelectedComponent:Ho},(null===Jo||void 0===Jo||null===(uo=Jo.component_fields)||void 0===uo?void 0:uo.length)>0&&i.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",padding:tt?"0 30%":"0 15%"}},bi)))),gt&&i.createElement(s.U7,{isOpen:gt,hasCloseIcon:!0,onClose:()=>Do?Gt("/"):bt(!1),backdropColor:!0,blured:!1,scrollable:!0,shadowedContainerStyle:{width:g.tq?"100%":"30%",height:"auto"}},i.createElement("div",{style:{textAlign:"center",padding:"0 20px"}},i.createElement("p",{className:n.modalTitle},null===(ro=fo.processModule.module)||void 0===ro?void 0:ro.name),i.createElement("p",{className:n.modalSubTitle},null!==(vo=null===fo||void 0===fo||null===(co=fo.processModule)||void 0===co||null===(po=co.module)||void 0===po||null===(mo=po.options)||void 0===mo?void 0:mo.message)&&void 0!==vo?vo:"Transaction saved"))))})}}]);
//# sourceMappingURL=1400.7787460e.chunk.js.map